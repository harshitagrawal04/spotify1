"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{104:(e,t,i)=>{i.d(t,{k:()=>u});var n=i(30758),a=i(97500),s=i.n(a),r=i(73849),l=i(3206),o=i(65674),c=i(86070);const u=(0,n.memo)((function({breakpoint:e,className:t,showSeparator:i=!1,isActive:n=!1,...a}){return(0,c.jsx)(r.v,{"data-entity-row":!0,className:s()(t,o.A.entityRow,{[o.A.separator]:i,[o.A.active]:n}),hoverBackgroundColor:"backgroundTintedHighlight",activeBackgroundColor:"backgroundTintedBase",layout:e===l.e.SMALL?"regular":"wide",hoverAnimationDuration:"0ms",horizontalGap:e===l.e.SMALL?"12px":"16px",paddingBlockStart:"12px",paddingBlockEnd:"12px",...a})}))},1148:(e,t,i)=>{i.d(t,{a:()=>c});var n=i(3528),a=i(31773),s=i(12299),r=i(77817),l=i(30758);const o=["play-history-contents"];function c(){const e=(0,r.q)(),t=(0,n.jE)();return function(e,t){const i=(0,r.q)();(0,l.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(s.X.UPDATE,(e=>t.setQueryData(o,e.data))),(0,a.I)({queryKey:o,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}},1895:(e,t,i)=>{i.d(t,{w:()=>b});var n=i(30758),a=i(97500),s=i.n(a),r=i(76706),l=i(27893),o=i(9286),c=i(743);const u="AAdBM1nhG73supMfnYX7",d="W3E0IT3_STcazjTeyOJa",p="mdMUqcSHFw1lZIcYEblu",m="cZCuJDjrGA2QMXja_Sua",g="zduvaX0Ioxqd5ypeWoAf";var v=i(86070);const x=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,o.y)(t);return(0,v.jsxs)("div",{className:s()(u),children:[(0,v.jsx)("div",{className:s()(d,{[n??p]:a}),children:e}),i]})},b=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},o)=>{const d=(0,n.useRef)(null);(0,l.g)(d);const p=(0,n.useMemo)((()=>({scrollNodeRef:d})),[d]),b=(0,v.jsx)(c.bi.Provider,{value:p,children:(0,v.jsx)(r.a,{className:m,scrollNodeRef:d,children:(0,v.jsx)("div",{ref:o,className:s()(u,g,t),children:e})})});return i?(0,v.jsx)(x,{fixedHeader:i,scrollNodeRef:d,scrolledClassName:a,children:b}):b}))},3206:(e,t,i)=>{i.d(t,{$:()=>r,e:()=>s});var n=i(52748),a=i(33782);const s={SMALL:"small",LARGE:"large"},r=()=>(0,a.y)()===n.E.SMALL?"small":"large"},4966:(e,t,i)=>{i.d(t,{U:()=>r});var n=i(86459),a=i(65674),s=i(86070);const r=({children:e,lineClamp:t=2,...i})=>(0,s.jsx)(n.d,{lineClamp:t,as:"div",dir:"auto",className:a.A.title,...i,children:e})},5070:(e,t,i)=>{i.d(t,{c:()=>l});var n=i(30758),a=i(38398),s=i(21153),r=i(43996);function l(e,t){const i=(0,s.d)(),l=(0,r.J)(t),o=(0,a.a)();(0,n.useEffect)((()=>i.getBroadcastingEvents().addListener(e,(e=>{o()&&l(e)}))),[i,l,e,o])}},5252:(e,t,i)=>{i.d(t,{_:()=>f,s:()=>y});var n=i(30758),a=i(97500),s=i.n(a),r=i(62411),l=i(74520),o=i(82101),c=i(19315),u=i(4881),d=i(64232),p=i(39736);const m="ffFwfKcPDbmAPLXzxzKq",g="jD_TVjbjclUwewP7P9e8",v="nZaXB942idDuiFv4bKNk",x="Fwe5dGEAgs_VFp4SPrzv",b="gchSBzolAjaPDHD1q0rA";var h=i(86070);const y=(0,n.createContext)(null),f=({label:e,style:t,focusTransferId:i,children:a,className:f,nodeRef:j})=>{const S=(0,n.useRef)(null),w=j??S,C=(0,u.S)(),N=(0,c.h)(),E=(0,r.d4)((e=>e.ui?.fullscreenMode?.isOpen??!1)),R=(0,d.XB)(),k=C===o.z.NOW_PLAYING_VIEW;return(0,l.X)(i??null,w),(0,h.jsx)(y.Provider,{value:w,children:(0,h.jsx)("aside",{"aria-label":e,className:s()(m,f,{[v]:k,[b]:E,[x]:N,[g]:R!==p.Z.Disabled&&R!==p.Z.NowPlayingView}),style:t,id:"Desktop_PanelContainer_Id",ref:w,tabIndex:-1,children:a})})}},9132:(e,t,i)=>{i.d(t,{e:()=>c});var n=i(3206),a=i(68538),s=i(46412),r=i(78115),l=i(1263),o=i(86070);const c=({images:e,breakpoint:t,type:i,name:c,...u})=>{const d=(0,r._)(),p=i===l.c.ARTIST||i===l.c.USER?a.u.CIRCLE:a.u.ROUNDED_CORNERS,m=t===n.e.SMALL?s.Qe.SIZE_64:s.Qe.SIZE_112;return(0,o.jsx)(a.b,{fadeIn:!0,images:d(e,s.BZ[m]),shape:p,size:m,iconSize:t===n.e.SMALL?"medium":"xlarge",type:i,title:c,loadingMode:"eager",...u})}},13886:(e,t,i)=>{i.d(t,{P:()=>n});const n=()=>!1},22152:(e,t,i)=>{i.d(t,{S:()=>o});var n=i(31773),a=i(95799),s=i(98717),r=i(37439),l=i(83223);function o(e){const t=(0,l.t)();return(0,n.I)({queryKey:["author",e],queryFn:async()=>t.fetch([e??""],[s.UH.IDENTITY_TRAIT,s.UH.VISUAL_IDENTITY_TRAIT,s.UH.AVAILABLE_RELEASES]).then((([e])=>function({uri:e,extensions:{[s.UH.IDENTITY_TRAIT]:t,[s.UH.VISUAL_IDENTITY_TRAIT]:i,[s.UH.AVAILABLE_RELEASES]:n}}){return t?{uri:e,name:t.name,description:t.description,images:((i?.sixteenByNineCoverImage?.instances??i?.squareCoverImage?.instances)?.map((({size:e,flatFile:t})=>({url:t?.cdnUrl??"",label:c[e]}))).filter((e=>!!e.url))??[]).slice(0,1),availableBooksUris:n?.availableReleases.map((e=>e.uri))??[],dynamicColors:(0,a.V)(i?.squareCoverImage?.extractedColorSet)}:null}(e))),staleTime:0,gcTime:36e5,enabled:!!e})}const c={[r.hJ.IMAGE_SIZE_UNSPECIFIED]:"standard",[r.hJ.IMAGE_SIZE_SMALL]:"small",[r.hJ.IMAGE_SIZE_DEFAULT]:"standard",[r.hJ.IMAGE_SIZE_LARGE]:"large",[r.hJ.IMAGE_SIZE_XLARGE]:"xlarge",[r.hJ.IMAGE_SIZE_XXLARGE]:"xlarge",[r.hJ.UNRECOGNIZED]:"standard"}},24292:(e,t,i)=>{i.d(t,{R:()=>m});var n=i(30758),a=i(7189),s=i(86113);function r(e,t,i=!1){if(!e)return void console.error("No list element found. Canceling moving focus");if(!(0,s.fk)(e))return;const n=e.querySelector('[tabindex="0"]');t===a.O.UP&&(0,s.MS)(n,l(e,n,a.O.UP,i)),t===a.O.DOWN&&(0,s.MS)(n,l(e,n,a.O.DOWN,i)),t===a.O.RIGHT&&(0,s.MS)(n,o(n,a.O.RIGHT,i)),t===a.O.LEFT&&(0,s.MS)(n,o(n,a.O.LEFT,i)),t===a.O.HOME&&(0,s.MS)(n,c(a.O.HOME,i)??n),t===a.O.END&&(0,s.MS)(n,c(a.O.END,i)??n)}function l(e,t,i,n=!1){const r=t.closest('li[role="row"]');if(!r)return t;let l=r;const c=Array.from(e.querySelectorAll('li[role="row"]')),u=Array.from(r.querySelectorAll(s.nu)),d=c.indexOf(r);if(d<0)return t;const p=(n&&t!==u[0]||!n&&t!==r)&&!(t instanceof HTMLLIElement);if(i===a.O.UP){if(document.activeElement===e){l=c[c.length-1];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.LEFT,n);let i=d-1;if(-1===i)return t;l=c[i],i-=1}else if(i===a.O.DOWN){if(document.activeElement===e){l=c[0];return(n?l.querySelector(s.nu):l)??t}if(p)return o(t,a.O.RIGHT,n);let i=d+1;if(i===c.length)return t;l=c[i],i+=1}return(n?l.querySelector(s.nu):l)??t}function o(e,t,i=!1){const n=e.closest('li[role="row"]');if(!n)return e;let r=e;const l=Array.from(n.querySelectorAll(s.nu)),o=l.indexOf(e);let c=0;if(t===a.O.RIGHT&&o-1!==l.length)c=o+1;else{if(t===a.O.LEFT&&-1===o)return n;if(t===a.O.LEFT&&0!==o)c=o-1;else if(t===a.O.LEFT&&0===o){return(i?n.querySelector(s.nu):n)??n}}return r=l.at(c),r??e}function c(e,t=!1){const{currentFocus:i,listEl:n}=function(){const e=document.activeElement,t=e?.closest("ul");return((0,a.I)(e)||e instanceof HTMLLIElement)&&t?{currentFocus:e,listEl:t}:{currentFocus:null,listEl:null}}();if(null===i||null===n)return null;const r=i.closest('li[role="row"]');if(!r)return i;const l=Array.from(n.querySelectorAll('li[role="row"]')),o=Array.from(r.querySelectorAll(s.nu));if(l.indexOf(r)<0)return i;const c=t&&i===o[0]||!t&&i===r;if(e===a.O.HOME){if(c){return(t?l[0].querySelector(s.nu):l[0])??i}return(t?o[1]:o[0])??i}if(e===a.O.END){if(c){return(t?l[l.length-1].querySelector(s.nu):l[l.length-1])??i}return o[o.length-1]??i}return i}var u=i(73160),d=i(86906),p=i(86070);const m=(0,n.forwardRef)((({onKeyDown:e,children:t,firstInteractiveIsWrapper:i=!1,...l},o)=>{const c=(0,d.N)(o);(0,u.R)(c);const m=(0,n.useCallback)((t=>{c.current?.contains(t.target)&&("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Home"!==t.key&&"End"!==t.key||t.preventDefault(),"ArrowUp"!==t.key&&"ArrowDown"!==t.key||document.documentElement.classList.remove("no-focus-outline"),"ArrowUp"===t.key&&r(c.current,a.O.UP,i),"ArrowDown"===t.key&&r(c.current,a.O.DOWN,i),"ArrowRight"===t.key&&r(c.current,a.O.RIGHT,i),"ArrowLeft"===t.key&&r(c.current,a.O.LEFT,i),"Home"===t.key&&r(c.current,a.O.HOME,i),"End"===t.key&&r(c.current,a.O.END,i),e?.(t))}),[i,c,e]),g=(0,n.useCallback)((e=>{if(!c.current)return;const t=e.target,i=c.current.querySelector('[tabindex="0"]');t.closest('li[role="row"]')&&t!==i&&(0,s.MS)(i,t,{preventScroll:!0})}),[c]);return(0,p.jsx)("ul",{role:"treegrid",ref:c,onKeyDown:m,onFocus:g,tabIndex:0,...l,children:t})}))},44006:(e,t,i)=>{i.d(t,{h:()=>C});var n=i(97500),a=i.n(n),s=i(8335),r=i(46232),l=i(11440),o=i(47290),c=i(53115),u=i(25695),d=i(30275),p=i(63673),m=i(45315),g=i(17998),v=i(37639),x=i(12689),b=i(3161),h=i(1263);const y="URfgKDbFQpKuN8ZjGdui",f="e3hKZQOHyxgax_X0Rb1E",j="j9I5h3Z4o0fKNgI1fIjb",S="SwS3WdCPfdr1uOOksVEB";var w=i(86070);const C=({context:e,item:t,index:i,canSwitchVisuals:n=!1,isMinimized:C=!1})=>{const{spec:N,logger:E}=(0,b.r)(r.J,{}),{draggable:R,onDragStart:k}=(0,g.P)(),{ref:I,inView:L}=(0,s.Wx)({threshold:.5,initialInView:!0});return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(o.h,{menu:(0,w.jsx)(u.W,{context:e,item:t,canSwitchVisuals:n}),children:(0,w.jsx)("div",{draggable:R&&((0,x.v)(t)||(0,v.p)(t)),onDragStart:e=>{k(e,{itemUris:[t.uri],dragLabelText:(0,m.r)(t)})},ref:I,className:a()(y,{[f]:C}),children:(0,w.jsx)(p.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,w.jsx)(d.e,{context:t.type===h.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{E.logInteraction(N.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===h.c.TRACK?t.album.uri:t.uri}))},adEventReason:l.c.COVER_ART,children:(0,w.jsx)(c.b,{className:a()(j,{[S]:L}),images:t.images??[],type:t.type,maxSize:C?56:384,desiredLabel:C?"small":"xlarge"})})})})})})}},45315:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(65703)},49943:(e,t,i)=>{i.d(t,{H:()=>o});var n=i(92696),a=i(44004),s=i(79252),r=i(12503),l=i(86070);const o=()=>(0,l.jsxs)("div",{className:r.A.emptyContainer,children:[(0,l.jsx)(n.q,{size:"xxlarge","aria-hidden":"true"}),(0,l.jsxs)("div",{className:r.A.titleContainer,children:[(0,l.jsx)(a.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:s.Ru.get("history.empty-title")}),(0,l.jsx)("p",{children:s.Ru.get("history.empty-description")})]})]})},52276:(e,t,i)=>{i.d(t,{O:()=>s,j:()=>a});var n=i(30758);let a=function(e){return e[e.Errored=0]="Errored",e}({});const s=(0,n.createContext)({state:null,capturePlaybackError:()=>{}})},54059:(e,t,i)=>{i.d(t,{L:()=>l});var n=i(30758),a=i(24848),s=i(92505),r=i(16440);function l({episodeUri:e,start:t,stop:i}){const{togglePlay:l,triggerPlay:o,isPlaying:c,isActive:u}=(0,a.P)({uri:e},{featureIdentifier:"episode"}),d=(0,s.o)((e=>(0,r.s)(e)??0)),p=u&&function(e,t,i){return i>=e&&i<t}(t,i,d),m=c&&p;return{onClick:(0,n.useCallback)((e=>{p?l({seekTo:t,loggingParams:e}):o({seekTo:t,loggingParams:e})}),[p,t,l,o]),isPlaying:m,isActive:p}}},58749:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(31773),a=i(50597);function s(){const e=(0,a.t)();return(0,n.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}},61211:(e,t,i)=>{i.d(t,{$:()=>a});var n=i(30758);const a=()=>{const[e,t]=(0,n.useState)(document.hasFocus());return(0,n.useEffect)((()=>{function e(){t(!0)}function i(){t(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",i),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",i)}}),[]),e}},62275:(e,t,i)=>{i.d(t,{p:()=>b});var n=i(30758),a=i(44004),s=i(43409),r=i(66973),l=i(79252),o=i(35953),c=i(71516),u=i(42851),d=i(76137);const p="pIxPdfuNasUDLbEDmuK_",m="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const b=({localStorageKey:e,onDismiss:t})=>{const[i,b]=(0,d.x)(e,!1),{logStartJam:h}=(0,u.O)(),{enqueueSnackbar:y}=(0,o.d)(),f=(0,n.useCallback)((()=>{b(!0),t&&t(),y(l.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[y,t,b]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:p,children:[(0,x.jsxs)("div",{className:m,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":l.Ru.get("close"),onClick:f,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:h})})]})}},63673:(e,t,i)=>{i.d(t,{R:()=>n.R});var n=i(88992)},64175:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(63586)},65674:(e,t,i)=>{i.d(t,{A:()=>n});const n={entityRow:"ci11tAmTK1LnxThQkXPy",actions:"_2sJPwAAp1wY1Ftke6iFe",visibleAction:"yuNzasMLs7hvemHI4d8Q",active:"dNymWGRudMrTI6ot9FBg",title:"luWcW9hkbLdFxRQB0yGb",body:"abYR6tZoE7BdzThmWTb0",footer:"GOcKQxqNMhGzbGiAXBig",separator:"yFQjuDAhri_egM1pwn70",badges:"tykXaR_9v2wPQNrdPkK6"}},66059:(e,t,i)=>{i.d(t,{PanelSection:()=>xg});var n=i(30758),a=i(94079),s=i(33100),r=i(18587),l=i(44004),o=(i(81572),i(13598)),c=i(88019),u=i(97500),d=i.n(u);let p=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),m=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var g=i(64232),v=i(39736),x=i(65882);const b=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.ManualSelection,p.AirpodsSelection],h=e=>{const t=(0,n.useRef)(!1),i=(0,x.z)(),a=(0,g.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,l=a,b.includes(r)&&(l===v.Z.PuffinActivation||l===v.Z.PuffinActivationOverlay));var r,l;!s||n||t.current?!s&&n&&t.current&&(i.resume({featureIdentifier:"birdhouse"}),t.current=!1):(i.pause({featureIdentifier:"birdhouse"}),t.current=!0)}),[a,e,i])};var y=i(86070);const f={[p.Overview]:{[m.GetStarted]:p.ActivationIntro,[m.OnError]:p.Error,[m.SelectManually]:p.ManualSelection,[m.Settings]:p.AudioQualitySettings,[m.OnboardLossless]:p.DiscoverLossless,[m.Details]:p.AudioQualityDetails},[p.ActivationIntro]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.ActivationDetection,[m.SelectManually]:p.ManualSelection,[m.Activate]:p.Overview},[p.ActivationDetection]:{[m.SelectManually]:p.ManualSelection,[m.Airpods]:p.AirpodsSelection,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.ActivationSignifiers},[p.ActivationSignifiers]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Activate]:p.Overview},[p.ManualSelection]:{[m.Continue]:p.ActivationSignifiers,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.NotFound]:p.IncompatibleHeadphones},[p.AirpodsSelection]:{[m.Continue]:p.ActivationSignifiers,[m.Close]:p.Overview,[m.OnError]:p.Error,[m.NotFound]:p.Error},[p.DiscoverLossless]:{[m.Continue]:p.Overview},[p.AudioQualitySettings]:{},[p.AudioQualityDetails]:{},[p.Error]:{},[p.IncompatibleHeadphones]:{[m.Close]:p.Overview,[m.OnError]:p.Error,[m.Continue]:p.Overview}},j=(0,n.createContext)({currentView:p.Overview,viewTransitions:f,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),S=({children:e})=>{const t=(0,g.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===v.Z.PuffinActivation||e===v.Z.PuffinActivationOverlay?p.ActivationDetection:p.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===p.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:l,options:o}=i.at(-1);h(l);const c=(0,n.useMemo)((()=>({currentView:l,viewOptions:o,setCurrentView:s,toPreviousView:r,viewTransitions:f})),[l,s,r,o]);return(0,y.jsx)(j.Provider,{value:c,children:e})};var w=i(1895),C=i(94875),N=i(52748),E=i(33782),R=i(62363);const k="Xq5xnpTOsoPxFR95BkTU",I="N7OMJte9T4Lv7DDX16ky",L="NJATxQbY2o4sl0BHxU3T",A=({children:e,className:t,...i})=>{const a=(0,n.useRef)(null),{currentView:s}=(0,n.useContext)(j),r=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.DiscoverLossless,p.ManualSelection,p.AirpodsSelection,p.IncompatibleHeadphones].includes(s),{breakpoint:l}=(0,R.c)({[N.E.SMALL]:0,[N.E.MEDIUM]:448,[N.E.LARGE]:780},a);return(0,y.jsxs)("div",{className:d()({[L]:r}),children:[(0,y.jsx)(C.a,{panel:v.Z.Puffin,className:d()(I,t),...i}),(0,y.jsx)(w.w,{ref:a,children:(0,y.jsx)(E.o.Provider,{value:l,children:e})})]})},T="EqLKhgGIINyN_LINFjl1",D="OyIY0v1_h3UWgLlxyPHL",O=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(j);return(0,y.jsx)(A,{onBack:()=>{t()},children:(0,y.jsxs)("div",{className:T,children:[(0,y.jsx)(o.b,{size:"xlarge",semanticColor:"textBase"}),(0,y.jsxs)("div",{className:D,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(p.Overview)},children:"Retry"})]})})},_=({resetError:e})=>(0,y.jsx)(O,{resetError:e});var B=i(37134),F=i(62411),U=i(79252),P=i(48391),M=i(56957),H=i(26729),V=i(70961),z=i(71726),q=i(13478);const Y=()=>{const e=(0,F.d4)((e=>e.platform.isDesktop)),t=(0,M.b)(),i=(0,P.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,V.v)((e=>{const t=(0,H.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:t.connectionStatus===z.zP.CONNECTED}}),q.a),l=(0,n.useMemo)((()=>e?U.Ru.get("web-player.connect.device-picker.this-computer"):U.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),o=(0,n.useMemo)((()=>{if(t)return e?U.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):U.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);if(s&&a&&r)return{deviceName:s,playingFrom:s};if(t?.transportType===P.Yg.AIRPLAY||t?.transportType===P.Yg.BLUETOOTH&&t?.terminalType===P.FI.SPEAKERS)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o};if(i){if(t?.transportType===P.Yg.BUILT_IN||t?.transportType===P.Yg.USB)return{deviceName:U.Ru.get("web-player.puffin.wired-connection"),playingFrom:l};if(t?.name&&t?.terminalType===P.FI.HEADPHONES)return{deviceName:t?.name,playingFrom:l,formattedDeviceName:o}}return{deviceName:l,playingFrom:l}},G=()=>{const{deviceName:e}=Y();return(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:e})};var Q=i(13886),Z=i(73849),K=i(84161),W=i(50597),J=i(66912);const X=({onClick:e})=>{const{playingFrom:t}=Y(),i=(0,W.t)(),[{data:n}]=(0,J.K)(i.quality.streamingQuality);return void 0===n?null:(0,y.jsx)(Z.v,{id:"qualitySetting",variant:"naked",title:U.Ru.get("desktop.settings.streamingQuality"),leading:(0,y.jsx)(K.s,{size:"small"}),subtitle:t,onClick:e,padding:"0px 12px"})};var $=i(20776),ee=i(74520),te=i(20271),ie=i(66108);const ne=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:l}=(0,n.useContext)(j),o=(0,g._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,y.jsx)(te.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?o(ie.$S.PUFFIN_BUTTON_CLICK):l(p.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var ae=i(72599),se=i(37913);const re=()=>{const e=(0,se.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}};var le=i(15845);const oe=({spec:e})=>{const t=(0,le.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=re(),{deviceFilterState:s}=(0,ae.j)();(0,ee.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:l}=ne({title:U.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:U.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,ee.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Z.v,{id:"resetHeadphonesButton",ref:i,variant:"naked",title:U.Ru.get("web-player.puffin.reset-headphones.menu-item"),leading:(0,y.jsx)($.x,{size:"small"}),onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},padding:"0px 12px"}),l]}):null};var ce=i(48240);const ue=({isPlayingRemotely:e,spec:t})=>{const i=(0,le.s)(),{setCurrentView:a,viewTransitions:s}=(0,n.useContext)(j),r=s[p.Overview],l=(0,Q.P)(),o=(0,ce.j)();return(0,y.jsxs)("div",{children:[o&&(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(X,{onClick:()=>{i.logInteraction(t.qualitySettingsButtonFactory().hitUiReveal()),a(r.settings)}})}),!e&&!l&&(0,y.jsx)(oe,{spec:t})]})},de=()=>null;var pe=i(83793),me=i(43409);const ge="k4f1o0jOMnxv6OS8dC7p",ve="PYLIWbzDyJA6Mbh2EQQg",xe="r3oTh3jKov0cW3m5qF1N",be=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const c=(0,n.useRef)(null);return(0,ee.X)(o,c),(0,y.jsx)(Z.v,{variant:"naked",size:"lg",id:"getStarted",className:ge,title:e,subtitle:t,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsxs)("div",{className:ve,children:[(0,y.jsx)(pe.n,{size:"small",onClick:a,ref:c,children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,y.jsx)(me.H,{className:xe,size:"small",onClick:r,children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:s})})]})})};var he=i(3285),ye=i(17971),fe=i(41423);const je=e=>{switch(e){case fe.Yn.LOSSLESS_24:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:U.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case fe.Yn.LOSSLESS:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:U.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case fe.Yn.VERY_HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case fe.Yn.HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case fe.Yn.NORMAL:return{title:U.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case fe.Yn.LOW:return{title:U.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:U.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[U.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case fe.Yn.UNKNOWN:default:return{title:U.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}},Se="SsVVyvM7DIniTIOjJFuM",we="dHDe0DUG4UkEeM8p5PEa",Ce="T49oF8shvnsadykMrogA",Ne=({quality:e,onClick:t})=>{const i=je(e),n=[fe.Yn.VERY_HIGH,fe.Yn.HIGH,fe.Yn.NORMAL,fe.Yn.LOW];e===fe.Yn.LOSSLESS_24?n.unshift(fe.Yn.LOSSLESS_24):n.unshift(fe.Yn.LOSSLESS);const a=e===fe.Yn.UNKNOWN?"textBase":"textBrightAccent";return(0,y.jsxs)(he.a,{as:"button",variant:"tinted",className:Se,onClick:t,children:[(0,y.jsx)(Z.v,{id:"quality",size:"lg",pretitle:U.Ru.get("web-player.pigeon.overview-card.title"),titleGap:ye.v4,title:(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:a,children:i.titleFull||i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,y.jsx)("div",{children:n.map(((t,i)=>{const n=je(t),a=t===e,s=a?"textBrightAccent":"textSubdued";return(0,y.jsx)(Z.v,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,y.jsx)("div",{className:d()(we,{[Ce]:a})}),title:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:s,children:n.title}),trailing:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:s,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var Ee=i(86459),Re=i(98459),ke=i(14895);const Ie="DkXvfK4ARoLCRa6fJghA",Le=({quality:e,onClick:t})=>{const i=je(e);return(0,y.jsx)(Z.v,{id:"qualityV2",variant:"tinted",verticalGap:"2px",paddingInlineStart:"16px",paddingInlineEnd:"16px",pretitle:(0,ke.v)("File quality in"),title:null,footer:(0,y.jsx)(Z.v,{id:"qualityV2Settings",paddingBlockStart:"0px",paddingBlockEnd:"0px",paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked",size:"md",title:(0,y.jsx)(Ee.d,{lineClamp:2,variant:"titleSmall",children:(0,y.jsxs)("span",{className:Ie,children:[(0,y.jsx)(Re.A,{size:"medium"}),(0,y.jsx)(l.E,{variant:"titleSmall",children:i.titleFull||i.title})]})}),subtitle:(0,y.jsx)(y.Fragment,{children:i.bitrateDetails?.map(((e,t)=>(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:e},`bitrate-details-${t}`)))}),trailing:(0,y.jsx)(me.H,{size:"small",iconOnly:K.s,onClick:t,label:U.Ru.get("keyboard.shortcuts.description.goToPreferences")})})})};var Ae=i(76137);const Te=()=>(0,Ae.x)("onboarding-dismissed:lossless",!1);var De=i(33924),Oe=i(25445);const _e=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(j),s=a[p.Overview],r=(0,ce.j)(),l=(0,Oe.A)(),o=(0,De.g)(),c=(0,Q.P)(),[u]=Te();return r?(0,y.jsxs)(y.Fragment,{children:[!u&&(0,y.jsx)(be,{title:U.Ru.get("web-player.pigeon.get-started.title"),subtitle:U.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:U.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),c?(0,y.jsx)(Le,{quality:l,onClick:()=>{o("/preferences?highlight=audio-quality")}}):(0,y.jsx)(Ne,{quality:l,onClick:()=>{t.logInteraction(e.audioQualityCardFactory().hitUiReveal()),i(s.details)}})]}):null},Be=({isError:e})=>e?(0,y.jsx)(Z.v,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,y.jsx)(o.b,{semanticColor:"textSubdued",size:"small"}),title:U.Ru.get("web-player.puffin.error-troubleshooting")}):null;var Fe=i(14076);const Ue="jvVll3Ia4Nrq9Fsd78Fo",Pe="d_HhOkLKxYpYKpP2gQy7",Me="fLp9X9keK84drMHcmOFW",He=({currentDeviceState:e,spec:t})=>{const i=(0,le.s)(),a=(0,n.useCallback)((()=>{i.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,i,t]),s=null!==e.toggleTuneHeadphones,{specificRestricted:r,processingCapabilitiesRestricted:l}=e.contentRestrictions,o=(0,n.useMemo)((()=>r||l?U.Ru.get("web-player.puffin.enhancement-unavailable.content-restriction"):(s||U.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),U.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"))),[s,l,r]);return(0,y.jsx)("div",{className:Ue,children:(0,y.jsx)(Z.v,{variant:"naked",size:"md",id:"headphones",className:Pe,disabled:r||l||!s,title:(0,y.jsx)(Ee.d,{className:Me,children:U.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:o,trailing:(0,y.jsx)(Fe.l,{id:"headphoneTunes",onSelected:a,disabled:r||l,value:e.currentState.specificEnabled,condensed:!0})})})},Ve="bLEXMWOER6nmfeLfBRIN",ze=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(j),s=a[p.Overview],{deviceFilterState:r}=(0,ae.j)(),o=r.isOnboarded;return(0,y.jsx)(Z.v,{id:"listeningWith",variant:"tinted",pretitle:U.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ve,trailing:(0,y.jsx)(pe.n,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},children:(0,y.jsx)(l.E,{variant:"bodySmallBold",children:U.Ru.get("web-player.puffin.listening-with.change-model")})}),footer:o&&(0,y.jsx)(He,{currentDeviceState:r,spec:e}),title:(0,y.jsx)(Ee.d,{lineClamp:2,children:r.headphoneDevice?.deviceName??U.Ru.get("web-player.puffin.listening-with.placeholder-model")})})};var qe=i(29457),Ye=i(38036);const Ge="r2vYR6suFxgB5_dQhF_5",Qe="u1TzXrhJQWI79pWRWFVG",Ze=({spec:e})=>{const t=(0,le.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=re(),{deviceFilterState:s}=(0,ae.j)();(0,ee.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:o}=ne({title:U.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:U.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,ee.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,y.jsxs)("div",{className:Ge,children:[(0,y.jsx)("div",{className:Qe,children:(0,y.jsx)(me.H,{onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},iconLeading:$.x,size:"small",children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",children:(0,ke.v)("Remove headphones")})})}),o]}):null},Ke="zGQ0s1caxUyi77kMOS_z",We="Ea60f3xHEWIFAM3mTuq2",Je=({spec:e})=>{const t=(0,le.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(j),s=a[p.Overview],{deviceFilterState:r}=(0,ae.j)(),o=r.isOnboarded,c=r.currentState.externalizationEnabled||r.currentState.specificEnabled;return(0,y.jsx)(Z.v,{id:"listeningWith",variant:"tinted",horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ke,pretitle:(0,ke.v)("Selected model"),title:(0,y.jsx)(Ee.d,{lineClamp:2,children:(0,y.jsxs)("div",{className:We,children:[c?(0,y.jsx)(qe.C,{size:"medium"}):(0,y.jsx)(Ye.r,{size:"medium"}),(0,y.jsx)(l.E,{variant:"titleSmall",children:r.headphoneDevice?.deviceName??U.Ru.get("web-player.puffin.listening-with.placeholder-model")})]})}),trailing:(0,y.jsx)(me.H,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},iconOnly:K.s}),footer:o&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(He,{currentDeviceState:r,spec:e}),(0,y.jsx)(Ze,{spec:e})]})})},Xe=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(j),a=i[p.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isError:l,isLoading:o}=(0,ae.j)(),c=(0,le.s)(),{triggerDialog:u,dialog:d,isHiddenByUser:m}=(()=>{const{deviceFilterState:e}=(0,ae.j)(),t=e.audioDevice?.id,[i,a]=(0,Ae.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...ne({title:U.Ru.get("web-player.puffin.dismiss-get-started.title"),description:U.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:U.Ru.get("hifi.yes"),cancelButtonText:U.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),g=(0,Q.P)(),v=s.isOnboarded,x=r&&!v&&!m,b=(0,n.useCallback)((()=>{c.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[c,e,s.audioDevice,t,a.getStarted,a.selectManually]);return r?l||o?(0,y.jsx)(Be,{isError:l}):(0,y.jsxs)(y.Fragment,{children:[d,v&&(g?(0,y.jsx)(Je,{spec:e}):(0,y.jsx)(ze,{spec:e})),x&&(0,y.jsx)(be,{title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:b,dismissButtonLabel:U.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:u,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]}):null};var $e=i(89040),et=i(3161);const tt="TJAbLKl8aSWZqWk4EFkk",it=ie.$S.DEVICE_PICKER_BUTTON_CLICK,nt=()=>{const e=(0,H.l)(),{panelSend:t}=(0,g.AI)(v.Z.DevicePicker,v.Z.DevicePickerOverlay),i=(0,Q.P)(),a=(0,ce.j)(),s=(0,$e.v)(),{spec:r,logger:l}=(0,et.r)(B.R,{}),o=!e&&s,c=(0,n.useCallback)((()=>{l.logInteraction(r.backButtonFactory().hitUiReveal()),t(it)}),[l,t,r]);return(0,y.jsx)(A,{onBack:c,onClose:()=>{l.logInteraction(r.closeButtonFactory().hitUiHide())},children:(0,y.jsxs)("div",{className:tt,children:[(0,y.jsx)(G,{}),i&&(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(de,{})}),a&&(0,y.jsx)(_e,{spec:r}),o&&(0,y.jsx)(Xe,{spec:r}),(0,y.jsx)(ue,{isPlayingRemotely:e,spec:r})]})})};var at=i(5252),st=i(85288),rt=i(58206);let lt=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function ot(e){return e.type===lt.ERROR}function ct(e){return e.type===lt.INFO}var ut=i(99697);const dt="UPAv6TbmqM79jDLYgiad",pt=({card:{type:e,id:t,title:i,text:n}})=>(0,y.jsx)(Z.v,{id:t,className:dt,variant:"tinted",leading:e===lt.ERROR?(0,y.jsx)(st.Z,{size:"small",semanticColor:"textWarning"}):null,title:(0,y.jsx)(Ee.d,{variant:"bodyMedium",children:i}),body:"string"==typeof n?(0,y.jsx)(ut.y,{LinkComponent:rt.N,source:n,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):n});var mt=i(2715),gt=i(90780);const vt="GdqxZ88oz8MtwHaBnwgb",xt="Q4TWj1C8EEkH_beo9jI8",bt="slKZiyNh_zlnTSEo8VG7",ht="ichtbB4QY2SKusRio97a",yt="xTMuOBwhiZlpUZtnm0M6";let ft=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const jt=({metric:e,label:t,severity:i})=>(0,y.jsxs)("div",{className:d()(vt,{[ht]:i===ft.UNKNOWN}),children:[(()=>{switch(i){case ft.PASSING:return(0,y.jsx)(mt.k,{size:"large",className:xt,semanticColor:"textBase"});case ft.NEEDS_ATTENTION:return(0,y.jsx)(st.Z,{size:"large",className:bt,semanticColor:"textWarning"});case ft.UNKNOWN:return(0,y.jsx)(gt.N,{size:"large",className:bt,semanticColor:"textBase"});default:return null}})(),(0,y.jsxs)("div",{className:yt,children:[(0,y.jsx)(l.E,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:e}),(0,y.jsx)(l.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:t})]})]});let St=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),wt=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Listen_Offline="Listen_Offline",e.Update_Setting="Update_Setting",e}({}),Ct=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),Nt=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const Et=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:wt.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:Nt.Poor,trackLosslessAvailable:!0},result:wt.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!1,deviceCompatible:!0,internetBandwidth:Nt.Poor,trackLosslessAvailable:!0},result:wt.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[fe.ZT.OFFLINED_FILE],trackLosslessAvailable:!0},result:wt.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:wt.Lossless_Unavailable},{criteria:{online:!0,isSetStreamingQualityLessThanLossless:!0},result:wt.Update_Setting}];const Rt=[{criteria:{bitrateLevel:[fe.Yn.LOSSLESS],strategy:[fe.ZT.BEST_MATCHING,fe.ZT.BACKEND_ADVISED,fe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:Nt.Good},{criteria:{bitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],targetBitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],strategy:[fe.ZT.BEST_MATCHING,fe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:Nt.Good},{criteria:{bitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],targetBitrateLevel:[fe.Yn.LOSSLESS],strategy:[fe.ZT.BEST_MATCHING,fe.ZT.BACKEND_ADVISED,fe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:Nt.Poor},{criteria:{bitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],targetBitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],strategy:[fe.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:Nt.Poor},{criteria:{bitrateLevel:[fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],targetBitrateLevel:[fe.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:Nt.Unavailable},{criteria:{autoAdjust:!1},result:Nt.Unknown},{criteria:{deviceSupported:!1},result:Nt.Unknown}],kt=[{criteria:{bitrateLevel:[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[fe.Yn.UNKNOWN,fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],strategy:[fe.ZT.BEST_MATCHING,fe.ZT.BACKEND_ADVISED,fe.ZT.CACHED_FILE],targetBitrateLevel:[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[fe.Yn.UNKNOWN,fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],strategy:[fe.ZT.OFFLINED_FILE],targetBitrateLevel:[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[fe.ZT.BEST_MATCHING,fe.ZT.BACKEND_ADVISED,fe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[fe.Yn.UNKNOWN,fe.Yn.LOW,fe.Yn.NORMAL,fe.Yn.HIGH,fe.Yn.VERY_HIGH],targetBitrateLevel:[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24]},result:!0}],It=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===St.bitrateLevel){if(!n.includes(e[St.bitrateLevel]))return!1}else if(i===St.targetBitrateLevel){if(!n.includes(e[St.targetBitrateLevel]))return!1}else if(i===St.strategy){if(!n.includes(e[St.strategy]))return!1}else{if(!n===e[i])return!1}return!0},Lt=e=>[fe.Yn.LOSSLESS,fe.Yn.LOSSLESS_24].includes(e);var At=i(42310),Tt=i(81882),Dt=i(92505);const Ot={losslessStatus:fe.p4.NONE,bitrateLevel:fe.Yn.UNKNOWN,targetBitrateLevel:fe.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:fe.ZT.UNKNOWN};function _t(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s}=(0,Dt.o)((e=>({...Ot,...e?.playbackQuality??null})),q.a),r=(0,H.l)(),l=(0,W.t)(),[{data:o}]=(0,J.K)(l.quality.streamingQuality),[{data:c}]=(0,J.K)(l.quality.remoteQuality),[{data:u}]=(0,J.K)(l.quality.autoAdjustQuality),d=(0,V.v)((e=>e.activeDevice)),p=(0,n.useMemo)((()=>null!==d&&d.losslessSupport?d.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[d]).deviceSupported,m=d?.isLocal||!1;let g;g=m?s===fe.ZT.CACHED_FILE||s===fe.ZT.OFFLINED_FILE?Ct.Downloads:Ct.Internet:Ct.Spotify_Connect;const v={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s,isLocal:m,deviceSupported:p,autoAdjust:!!u},x=(e=>{for(const t of kt)if(It(e,t))return t.result;return!(!Lt(e[St.bitrateLevel])&&!Lt(e[St.targetBitrateLevel]))})(v),b=(e=>{for(const t of Rt)if(It(e,t))return t.result;return e[St.strategy]===fe.ZT.BACKEND_ADVISED?Nt.Poor:Nt.Good})(v),h=(0,Tt.n)(),y=Lt(i)&&a,f=Lt(t),j=Lt(i),S=r?c?.streamingQuality:o,w=function({online:e,streamingLossless:t,targetingLossless:i,strategy:n,trackLosslessAvailable:a,autoAdjust:s,internetBandwidth:r,losslessCompatibleDevice:l,isLocal:o,isSetStreamingQualityLessThanLossless:c}){const u=[wt.Listen_Offline,wt.Connect_Explanation,wt.Bluetooth_Degrades_Lossless];for(const d of Et){const{criteria:p,result:m}=d;p.online===e&&(void 0!==p.autoAdjust&&p.autoAdjust!==s||void 0!==p.streamingLossless&&p.streamingLossless!==t||void 0!==p.targetingLossless&&p.targetingLossless!==i||void 0!==p.deviceCompatible&&p.deviceCompatible!==l||void 0!==p.bitrateStrategy&&!1===o||(void 0===p.bitrateStrategy||void 0!==n&&p.bitrateStrategy.includes(n))&&(void 0!==p.internetBandwidth&&p.internetBandwidth!==r||void 0!==p.trackLosslessAvailable&&p.trackLosslessAvailable!==a||void 0!==p.isSetStreamingQualityLessThanLossless&&p.isSetStreamingQualityLessThanLossless!==c||u.push(m)))}return u}({online:h,streamingLossless:f,targetingLossless:j,strategy:s,trackLosslessAvailable:y,autoAdjust:u,internetBandwidth:b,losslessCompatibleDevice:p,isLocal:m,isSetStreamingQualityLessThanLossless:!!S&&S<At.a1.LOSSLESS&&S>At.a1.AUTOMATIC});return{losslessStatus:e,bitrateLevel:t,flags:w,internetBandwidth:b,playingVia:{channelIsLossless:x,channel:g},losslessCompatibleDevice:p}}const Bt=()=>{const{losslessCompatibleDevice:e,playingVia:t,internetBandwidth:i}=_t();return(0,y.jsxs)("div",{children:[(0,y.jsx)(jt,{metric:U.Ru.get("web-player.pigeon.audio-quality.lossless-compatible-device"),label:e?U.Ru.get("hifi.yes"):U.Ru.get("hifi.no"),severity:e?ft.PASSING:ft.NEEDS_ATTENTION}),(0,y.jsx)(jt,{metric:U.Ru.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case Ct.Downloads:return U.Ru.get("local-files.source.downloads");case Ct.Internet:return U.Ru.get("hifi.networkConnection");case Ct.Spotify_Connect:return U.Ru.get("spotify-connect");default:return""}})(),severity:t.channelIsLossless?ft.PASSING:ft.NEEDS_ATTENTION}),(0,y.jsx)(jt,{metric:U.Ru.get("hifi.internetBandwidth"),label:(()=>{switch(i){case Nt.Good:return U.Ru.get("hifi.good");case Nt.Poor:return U.Ru.get("hifi.poor");case Nt.Unknown:default:return U.Ru.get("hifi.unknown")}})(),severity:(()=>{switch(i){case Nt.Good:return ft.PASSING;case Nt.Poor:return ft.NEEDS_ATTENTION;case Nt.Unknown:default:return ft.UNKNOWN}})()})]})};var Ft=i(82139);const Ut={[wt.Listen_Offline]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:U.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[wt.Connect_Explanation]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.connect-explanation.title"),message:(0,y.jsx)(l.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.help-cards.connect-explanation.body",(0,y.jsx)(Ft.g,{size:"xsmall",alignmentBaseline:"baseline"}))})}),[wt.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:U.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:U.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[wt.Opt_Out_Of_Downgrade]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:U.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body")}),[wt.Poor_Bandwidth_Interferes]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:U.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[wt.Default_To_Very_High]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:U.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[wt.Need_To_Redownload]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:U.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[wt.Lossless_Unavailable]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:U.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")}),[wt.Update_Setting]:()=>({type:"error",title:U.Ru.get("web-player.pigeon.help-cards.update-settings.title"),message:U.Ru.get("web-player.pigeon.help-cards.update-settings.body")})},Pt="BFsg6KnXzCo_ZKKekrFC",Mt="OIOUgecXCtVCX_DzOsR4",Ht="qcU9Wt2Ly1y44H_lC327",Vt=()=>{const{toPreviousView:e}=(0,n.useContext)(j),t=(0,Oe.A)(),i=je(t),a=(()=>{const{flags:e}=_t(),t=[];return e.forEach((e=>{if(Ut[e]){const{type:i,message:n,title:a}=Ut[e]();"info"===i?t.push({id:e,text:n,title:a,type:lt.INFO}):t.push({id:e,text:n,title:a??"",type:lt.ERROR})}})),t})(),s=a.some(ot),r=a.filter(s?ot:ct);return(0,y.jsx)(A,{onBack:e,children:(0,y.jsxs)("div",{className:Pt,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.overview-card.title")}),(0,y.jsx)(l.E,{variant:"titleMedium",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),(0,y.jsx)("div",{className:Mt,children:i.bitrateDetails?.map(((e,t)=>(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,y.jsx)("div",{className:Ht,children:(0,y.jsx)(Bt,{})}),r.map((e=>(0,y.jsx)(pt,{card:e},e.id)))]})})};var zt=i(64985);const qt=({subtitles:e})=>(0,y.jsx)(y.Fragment,{children:e.map(((e,t)=>(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))}),Yt="ZExuZhVAKsqOBfFdR6Js",Gt="G5KBejq8q3GSZxhHs9be",Qt="WG0sT27gl2zSvisQcgHS",Zt="iUbPCgoUSkOoOVEo5wnr",Kt="NCUCNjFgGqpox8ttJKch",Wt=({title:e,isLossless:t})=>(0,y.jsxs)("div",{className:Gt,children:[(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:e}),t&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:"•"}),(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:U.Ru.get("web-player.pigeon.audio-quality.lossless.highest")})]})]});var Jt=i(58749);const Xt=({onClick:e,quality:t,playQuality:i,maxQuality:n})=>{const{title:a,subtitles:s}=(e=>{switch(e){case At.a1.LOSSLESS:return{title:U.Ru.get("web-player.pigeon.audio-quality.lossless"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),U.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case At.a1.VERY_HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.very-high.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case At.a1.HIGH:return{title:U.Ru.get("web-player.pigeon.audio-quality.high.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case At.a1.MEDIUM:return{title:U.Ru.get("web-player.pigeon.audio-quality.normal.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case At.a1.LOW:return{title:U.Ru.get("web-player.pigeon.audio-quality.low.label"),subtitles:[U.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};default:return{title:U.Ru.get("web-player.pigeon.audio-quality.unknown.label"),subtitles:null}}})(t);if(null===a||null===s)return null;const r=i===t,l=t===At.a1.LOSSLESS,o=null===n||t<=n;return(0,y.jsx)(Z.v,{id:"title",variant:"naked",verticalGap:"2px","aria-disabled":!o,onClick:e,onClickHint:U.Ru.get("web-player.pigeon.quality-settings.option-hint",a),title:(0,y.jsx)(Wt,{title:a,isLossless:l}),subtitle:(0,y.jsx)(qt,{subtitles:s}),trailing:r?(0,y.jsx)(zt.i,{semanticColor:"textBrightAccent"}):void 0})},$t=()=>{const{toPreviousView:e}=(0,n.useContext)(j),t=(0,H.l)(),{playingFrom:i}=Y(),a=(0,W.t)(),[{data:s},{mutate:r}]=(0,J.K)(a.quality.streamingQuality),[{data:o},{mutate:c}]=(0,J.K)(a.quality.autoAdjustQuality),[{data:u},{mutate:d}]=(0,J.K)(a.quality.remoteQuality),p=(0,Jt.x)();if(void 0===p||void 0===o||void 0===s)return null;let m=s,g=r,v=null;return t&&u&&(m=u.streamingQuality,v=u.maxSupportedQuality,g=e=>d({...u,streamingQuality:e})),(0,y.jsxs)(A,{onBack:e,children:[(0,y.jsxs)("div",{className:Kt,children:[(0,y.jsx)(l.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.title")}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:i})]}),(0,y.jsx)("div",{className:Yt,children:p.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,y.jsx)(Xt,{quality:e.quality,playQuality:m,maxQuality:v,onClick:()=>g(e.quality)},t)))}),(0,y.jsx)(l.E,{children:U.Ru.get("web-player.pigeon.quality-settings.disclaimer")}),(0,y.jsxs)("div",{className:Qt,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.listening-preferences")}),(0,y.jsx)(Z.v,{className:Zt,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality")}),trailing:(0,y.jsx)(Fe.l,{id:"desktop.settings.automatic-downgrade",value:o,onSelected:c,condensed:!0})}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-1")}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-2")})]})]})};var ei=i(86071),ti=i(11683);const ii="GYa976HrK40QHF7ZZvwM",ni="MHROZzo24FoePahYMEFJ",ai="qQ5CfbxUDYyLgy_O6Gah",si=({nrSteps:e,currentStep:t,onClick:i})=>(0,y.jsx)("div",{className:ii,children:Array.from({length:e}).map(((e,n)=>(0,y.jsx)("button",{"aria-label":(0,ke.v)(`Go to Step ${n+1}`),className:d()(ni,{[ai]:t===n}),onClick:()=>i(n)},n)))});var ri=i(24818),li=i(15333),oi=i(19103),ci=i(78115);const ui="Vpnd2l8y0SgEYWxGIRzB",di="cUTxS9VrHd466oEAGs7_",pi="JvZLieWRZZQjIU2ElJ2Y",mi="ub90kjJH_P8M2r1QL_jL",gi="U3xgLhEWHrv2mb_ZSesP",vi="ZiS7XuaKSNH6O814jzTW",xi="W8RJgFmuCgvRsxpnXMWG",bi="pAYPkrJQFNaLczxADAGc",hi="nBOyGCpnbwg691MCewBj",yi="hr6LueujvRuzxi6lBlVZ",fi="zwfOn0Sx4qfhn2imHyQ9",ji="UcHPiDY6dLRbaeY65j16",Si="KsS00iz9PKUXYN0PHhno",wi="h66wSXbM4f8lkj4EppJQ",Ci=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,ci.dZ)();return(0,y.jsx)(oi._,{className:gi,src:n(e,t),loading:"eager",alt:i})};var Ni=i(98270);const Ei=({path:e,loop:t=!0})=>(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(Ni.o,{loop:t,autoplay:!0,path:e,className:mi,style:{width:"auto",height:"100%"}})});var Ri=i(89323);function ki({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,Ri.i)({ref:i}),(0,y.jsx)(l.E,{variant:t,semanticColor:"textBase",className:hi,tabIndex:-1,ref:i,children:e})}const Ii={[N.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[N.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[N.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},Li="AOGvMtDLQNbo94n8r8mu",Ai="gf6sr0Z5UAyf7ULRfSFA",Ti=({icon:e,text:t,highlighted:i,condensed:n=!1,className:a})=>(0,y.jsxs)("div",{className:d()(Li,a),children:[(0,y.jsx)(e,{size:n?"xsmall":"small",semanticColor:"textBase",className:d()({[Ai]:i})}),(0,y.jsx)(l.E,{variant:n?"marginalBold":"bodySmallBold",semanticColor:"textBase",className:d()({[Ai]:i}),children:t})]});var Di=i(30298);const Oi=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:u,bodyText:p,imageUrl:m,lottiePath:g,loopAnimation:v=!0,subtitleIcon:x,buttonText:b,tertiaryButtonText:h}=e,f=(0,E.y)(),{titleVariant:j,subtitleVariant:S,bodyVariant:w,containerGap:C,headerGap:R,assetGap:k,subtitleGap:I,titleGap:L,buttonGap:A,assetMaxHeight:T}=(0,n.useMemo)((()=>{let e=N.E.MEDIUM;switch(f){case N.E.SMALL:e=N.E.SMALL;break;case N.E.MEDIUM:e=N.E.MEDIUM;break;case N.E.LARGE:e=N.E.LARGE}return Ii[e]}),[f]),D=(0,n.useRef)(null),O=(0,Di.j)();return(0,y.jsx)(ri.A,{mode:"out-in",children:(0,y.jsx)(a.A,{timeout:O?0:800,classNames:{enter:fi,enterActive:ji,exit:Si,exitActive:wi},nodeRef:D,children:(0,y.jsx)("div",{className:ui,style:{"--onboarding-container-gap":`${C}px`,"--onboarding-asset-gap":`${k}px`,"--onboarding-subtitle-gap":`${I}px`,"--onboarding-title-gap":`${L}px`,"--onboarding-button-gap":`${A}px`,"--onboarding-asset-max-height":`${T}px`,"--onboarding-header-gap":`${R}px`},ref:D,children:(0,y.jsxs)("div",{className:d()(di,{[vi]:"horizontal"===s}),children:[(0,y.jsxs)("div",{className:pi,children:[m?(0,y.jsx)(Ci,{imageUrl:m,max:T}):null,g?(0,y.jsx)(Ei,{path:g,loop:v}):null]}),(0,y.jsxs)("div",{className:xi,children:[(0,y.jsx)(Ti,{icon:x,text:u,condensed:f!==N.E.LARGE,highlighted:!0,className:bi,variant:S}),(0,y.jsx)(ki,{variant:j,children:o}),(0,y.jsx)(l.E,{variant:w,children:p}),(0,y.jsx)("div",{className:yi,children:r?(0,y.jsx)(li.m,{}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.$,{colorSet:"invertedLight",size:f===N.E.LARGE?"medium":"small",onClick:t,children:b}),i&&h?(0,y.jsx)(me.H,{size:f===N.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};const _i=({variant:e})=>(0,y.jsx)(l.E,{variant:e,semanticColor:"textBase",children:"Spotify"}),Bi=()=>[{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"},{bodyTitle:U.Ru.get("web-player.pigeon.introduction.step-4.title"),bodySubtitle:"Lossless",bodyText:U.Ru.get("web-player.pigeon.introduction.step-4.subtitle"),subtitleIcon:ei.Q,buttonText:U.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092562f3465b95599cdb50e47604e"}],Fi=()=>{const[e,t]=Te(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(j),{spec:r,logger:l}=(0,et.r)(ti.m,{}),o=s[p.DiscoverLossless],{onNext:c,onBack:u,currentStep:d,goTo:m}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),l=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),o=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:l,reachedEnd:a,goTo:o}}(Bi().length),g=(0,n.useCallback)((()=>{l.logInteraction(r.closeButtonFactory().hitUiHide()),i(o.continue)}),[l,i,r,o.continue]);return(0,y.jsxs)(A,{titleSlot:(0,y.jsx)(_i,{variant:"bodySmallBold"}),onBack:()=>{l.logInteraction(r.backButtonFactory().hitUiHide()),d>0?u():a()},onClose:g,preventDefaultClose:!0,children:[(0,y.jsx)(Oi,{onboardingContent:Bi()[d],onNext:()=>{3===d?(l.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(o.continue)):c()}}),(0,y.jsx)(si,{nrSteps:Bi().length,currentStep:d,onClick:m})]})};var Ui=i(74805),Pi=i(69897);const Mi=e=>({bodyTitle:U.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:qe.C,buttonText:U.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:U.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),Hi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(j),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,ae.j)(),r=t[p.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(p.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const l=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,y.jsx)(Oi,{onboardingContent:Mi(i),onNext:()=>{e(l?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},Vi=()=>{const{deviceFilterState:e,isLoading:t}=(0,ae.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(j),s=a[p.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),l={bodyTitle:U.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Pi.b)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:qe.C,buttonText:U.Ru.get("web-player.puffin.activation-1.button")};return(0,y.jsx)(Oi,{onboardingContent:l,onNext:r,showLoader:t||!e.audioDevice})};var zi=i(45127),qi=i(49725);const Yi=e=>{const{deviceFilterState:t}=(0,ae.j)(),{setCurrentDevice:i}=re(),a=(0,zi.vh)(),{setCurrentView:s}=(0,n.useContext)(j),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(p.Error)}((e,t)=>{e.send((0,qi.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===P.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Gi=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(j),{spec:i,logger:a}=(0,et.r)(Ui.i,{}),s=t[p.ActivationSignifiers],{handleClick:r}=Yi((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,y.jsx)(Oi,{onboardingContent:{bodyTitle:U.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:U.Ru.get("web-player.puffin.signifier-text"),bodyText:U.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:qe.C,buttonText:U.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Qi="FcycLYpZEbmuEClARSPP",Zi="NSoA0u_DehEmTu_M20Qn",Ki="fGnSEIwIPGid9ALC9ANP",Wi="ZknipG1So_RdKeJ911k3",Ji=({number:e,message:t})=>(0,y.jsxs)("div",{className:Ki,children:[(0,y.jsx)("div",{className:Wi,children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Xi=()=>{const{setCurrentView:e}=(0,n.useContext)(j);return(0,y.jsxs)("div",{className:Qi,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,y.jsxs)("div",{className:Zi,children:[(0,y.jsx)(Ji,{number:1,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,y.jsx)(Ji,{number:2,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,y.jsx)(Ji,{number:3,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,y.jsx)(Ji,{number:4,message:U.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,y.jsx)(me.H,{semanticColor:"textSubdued",onClick:()=>{e(p.Overview)},children:"Still not working"})]})},$i=()=>{const{removeCurrentDevice:e}=re();return ne({title:U.Ru.get("web-player.puffin.activation-dialog.title"),description:U.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:U.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:U.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,ee.I)("SETUP_HEADPHONES_BUTTON")}})},en=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,ae.j)(),{spec:i,logger:a}=(0,et.r)(Ui.i,{}),{triggerDialog:s,dialog:r}=$i(),l=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),o=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,y.jsx)(A,{titleSlot:(0,y.jsx)(_i,{variant:"bodySmallBold"}),onClose:l,onBack:o,preventDefaultClose:!0,children:t?(0,y.jsxs)(y.Fragment,{children:[r,"intro"===e&&(0,y.jsx)(Vi,{}),"detection"===e&&(0,y.jsx)(Hi,{}),"signifiers"===e&&(0,y.jsx)(Gi,{})]}):(0,y.jsx)(Xi,{})})};var tn=i(84160),nn=i(93495),an=i(84037),sn=i(72056),rn=i(69684);const ln=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?U.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(U.Ru.getSeparator())):e.brand;return(0,y.jsx)(rn.c,{children:(0,y.jsx)(Z.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,y.jsx)(Ee.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,y.jsx)(sn.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},on="fjltNoIqUMIY7LfgtvCH",cn="WNi2uq00PuqJnOvv6b6a",un="W3HfPxIGTvmPJNItOM5A",dn="T3zyYZ33nGeJfw6NgwwV",pn="fr_QT3qQxce_KdFUhktQ",mn="wMsnDxvKohBJOUguxi8p",gn="O842FkxrdjAlid2byB9c",vn="E6yKOmbA9ekxMnRhJDnA",xn="sm96uN6u5WGLjNfbT6kF",bn="bWJ8TFqqyCV4TqeScz7D",hn="SRl_K6g2YOd8qrpIFij7",yn=({search:e})=>(0,y.jsxs)("div",{className:vn,children:[(0,y.jsx)(l.E,{semanticColor:"textBase",variant:"titleSmall",className:xn,children:U.Ru.get("web-player.puffin.manual-selection.empty.title",(0,y.jsx)("span",{className:bn,children:(0,y.jsx)("span",{className:hn,children:e})}))}),(0,y.jsx)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),fn={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},jn=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(j),s=t?a[p.AirpodsSelection]:a[p.ManualSelection],{filter:r,setFilter:l}=(0,n.useContext)(nn.g),{setCurrentDevice:o}=re(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;o(n,!0),i(e?.id===fn.id?s.notFound:s.continue),l("")}),[t,o,i,s.notFound,s.continue,l]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,y.jsxs)("div",{className:mn,children:[(0,y.jsx)(an.$,{children:u.map((e=>(0,y.jsx)(ln,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,y.jsx)(yn,{search:r}),(0,y.jsx)("div",{className:pn,children:(0,y.jsx)(pe.n,{size:"small",onClick:()=>{c(fn)},children:U.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var Sn=i(31773);const wn=()=>{const e=(0,se.N)(),{data:t,isLoading:i,isError:n}=(0,Sn.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},Cn=()=>{const{toPreviousView:e}=(0,n.useContext)(j),{data:t}=wn(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,y.jsx)(A,{onBack:()=>{e()},children:(0,y.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,y.jsxs)("div",{className:cn,children:[(0,y.jsx)("div",{className:un}),(0,y.jsxs)("div",{className:dn,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,y.jsx)(l.E,{variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,y.jsx)(tn.S,{placeholder:U.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,y.jsx)("div",{className:on,children:(0,y.jsx)(jn,{devices:i,isAirpodsList:!0})}):(0,y.jsx)("div",{className:gn,children:(0,y.jsx)(li.m,{})})]})})},Nn=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(j),i=t[p.IncompatibleHeadphones],{handleClick:a}=Yi((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(j);return(0,y.jsx)(A,{onBack:()=>{s()},titleSlot:(0,y.jsx)(_i,{variant:"bodySmallBold"}),children:(0,y.jsx)(Oi,{onboardingContent:{bodyTitle:(0,ke.v)("These headphones are not compatible with Optimize yet."),bodySubtitle:(0,ke.v)("Optimize"),bodyText:(0,ke.v)("Only some devices work with Optimize. We're expanding our compatible devices to support a wider range of headphones."),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:qe.C,buttonText:(0,ke.v)("Close")},onNext:a})})},En=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(j),{data:i}=wn(),{triggerDialog:a,dialog:s}=$i();return(0,y.jsxs)(A,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,y.jsx)(_i,{variant:"bodySmallBold"}),children:[s,(0,y.jsxs)(nn.s,{uri:"spotify:internal:bettersound",children:[(0,y.jsxs)("div",{className:cn,children:[(0,y.jsx)("div",{className:un}),(0,y.jsxs)("div",{className:dn,children:[(0,y.jsx)(l.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:U.Ru.get("web-player.puffin.manual-selection.title")}),(0,y.jsx)(l.E,{variant:"bodySmall",children:U.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,y.jsx)(tn.S,{placeholder:U.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,y.jsx)("div",{className:on,children:(0,y.jsx)(jn,{devices:i})}):(0,y.jsx)("div",{className:gn,children:(0,y.jsx)(li.m,{})})]})]})};var Rn=i(43943);const kn=()=>{const{currentView:e}=(0,n.useContext)(j);switch(e){case p.ActivationIntro:return(0,y.jsx)(en,{type:"intro"});case p.ActivationDetection:return(0,y.jsx)(en,{type:"detection"});case p.ActivationSignifiers:return(0,y.jsx)(en,{type:"signifiers"});case p.Error:return(0,y.jsx)(O,{});case p.ManualSelection:return(0,y.jsx)(En,{});case p.AirpodsSelection:return(0,y.jsx)(Cn,{});case p.Overview:return(0,y.jsx)(nt,{});case p.AudioQualitySettings:return(0,y.jsx)($t,{});case p.AudioQualityDetails:return(0,y.jsx)(Vt,{});case p.DiscoverLossless:return(0,y.jsx)(Fi,{});case p.IncompatibleHeadphones:return(0,y.jsx)(Nn,{});default:return(0,Rn.k)(e),null}},In=()=>{const{currentView:e}=(0,n.useContext)(j),t=(0,g._Y)(),i=(0,g.XB)(),a=[v.Z.Puffin,v.Z.PuffinActivation,v.Z.PuffinOverlay,v.Z.PuffinActivationOverlay].some((e=>e===i)),s=[p.ActivationIntro,p.ActivationDetection,p.ActivationSignifiers,p.ManualSelection,p.IncompatibleHeadphones].includes(e);return(0,n.useEffect)((()=>{a&&t(s?ie.$S.PUFFIN_START_ACTIVATION:ie.$S.PUFFIN_FINISH_ACTIVATION)}),[t,s,a]),(0,y.jsxs)("div",{className:k,children:[(0,y.jsx)(kn,{}),false]})},Ln=()=>(0,y.jsx)(at._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,y.jsx)(r.s,{Fallback:_,children:(0,y.jsx)(S,{children:(0,y.jsx)(In,{})})})});var An=i(3528),Tn=i(7446);function Dn(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function On(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:Dn([...t,e])}function _n(e,t){return t.filter((t=>t.user.uri!==e))}var Bn=i(45005);var Fn=i(96672),Un=i(33446);function Pn(){const e=(0,Tn.C)(),t=(0,An.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>{const i=Array.isArray(e)?e.at(0):e;return i?function(e,t){return Dn(t.map((t=>t.user.uri===e.user.uri?e:t)))}(i,t):t}))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}=function(e){const t=(0,Tn.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,Bn.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),l=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:l}}(a),o=(0,n.useRef)();(0,n.useEffect)((()=>()=>o.current?.cancel()),[]);const c=(0,Sn.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{o.current=l(a,e,t)})).then((e=>Dn(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,Un.N)(Fn.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==Fn.JK.FOLLOW_USER){if(n.data.operation===Fn.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>_n(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n])).at(0);a&&(t.setQueryData(i,((e=[])=>On(a,e))),s(n))}})),c}const Mn=(0,n.lazy)((()=>i.e(7564).then(i.bind(i,92344))));function Hn(){const{data:e,error:t,isLoading:i}=Pn();return!(0,Tt.n)()||i||t?null:(0,y.jsx)(Mn,{friends:e??[]})}var Vn=i(82101),zn=i(4881);const qn="device-picker-section-heading",Yn="device-picker-troubleshooting-list";var Gn=i(34645);const Qn="uqXaqvqZq1oSLhXLYRo9",Zn="YuPZ1nUe5BAH7HJworb6",Kn="wWalUsrOkGgHa0u8o86Q",Wn="yNttGX9uUxTih93MKEWB",Jn="kD25df_SN_uDB8lhZgQB",Xn="szp7gPJjKd4T69SzCEpF",$n="E912cqRfb05FrRPFKDZ_",ea="D7sZlTAybIM02cRvh4sV",ta="xdAVCtEIoo_8z_Ubj7tU",ia=({foundDevices:e})=>{const t=(0,s.NC)(Gn.Q5);let i;return i=e?t?(0,ke.v)("Speakers & Jams"):U.Ru.get("web-player.connect.device-picker.select-another-device"):U.Ru.get("web-player.connect.device-picker.no-devices-found"),(0,y.jsx)("span",{className:Wn,id:qn,"data-testid":qn,children:(0,y.jsx)(l.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:i})})};var na=i(66114),aa=i(66105),sa=i(40638),ra=i(81347),la=i(30913),oa=i(94477),ca=i(47290),ua=i(86871),da=i(28823),pa=i(90298),ma=i(64787),ga=i(64947),va=i(51742),xa=i(84206),ba=i(23310),ha=i(62316),ya=i(96678),fa=i(53507);var ja=i(51283);const Sa="mFr6W9mwg0p_c7eJlhc_",wa="lpPBKkIGJcyWu59iOpsS",Ca=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,fa.N)(ya.r),s=(0,le.s)(),{spec:r}=(0,et.r)(va.d,{}),l=(0,ja.t)(r),o=r.forgetDeviceButtonFactory(),c=(0,ja.t)(o),u=r.deviceIncarnationContainerFactory(),d=(0,ja.t)(u);return i||n?(0,y.jsx)("span",{ref:l,className:wa,children:(0,y.jsxs)(xa.W,{children:[i&&(0,y.jsx)(ha.D,{role:"menuitem",leadingIcon:(0,y.jsx)(ga.V,{size:"small"}),onClick:()=>{s.logInteraction(o.hitLogoutFromRemoteDevice({remoteDeviceId:t})),a.logout(e)},elementRef:c,children:U.Ru.get("web-player.connect.context-menu.log-out-of-device")}),n&&(0,y.jsxs)("div",{ref:d,children:[(0,y.jsx)(ba.y,{children:U.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:r,text:l}=(e=>{switch(e){case"connect":return{icon:(0,y.jsx)(la.E,{size:"small"}),text:U.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,y.jsx)(ma.m,{size:"small"}),text:U.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,y.jsx)(ha.D,{role:"menuitemradio",leadingIcon:r,onClick:()=>{let r;switch(i){case"cast":r=u.googleCastButtonFactory();break;case"connect":r=u.spotifyConnectButtonFactory()}n.preferred!==i?(r&&s.logInteraction(r.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),a.setPreferredIncarnation(e,i)):r&&s.logInteraction(r.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:zt.i,children:l},i)}))]})]})}):null};var Na=i(16859);const Ea=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:l,onShow:o,spec:c})=>{const[u,p]=(0,n.useState)(!1),m=c.contextMenuButtonFactory({identifier:i}),g=(0,le.s)(),v=(0,ja.t)(m);return(0,y.jsx)(pa.b,{renderInline:!0,menu:(0,y.jsx)(Na.r,{spec:m,children:(0,y.jsx)(Ca,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{p(!0),o?.()},onHide:()=>{p(!1),l?.()},offset:[0,-8],children:(0,y.jsx)(da.e,{ref:v,size:da.M.xs,label:U.Ru.get("more.label.context",e),className:d()(Sa,r),onClick:e=>{e.stopPropagation(),g.logInteraction(u?m.hitUiHide():m.hitUiReveal())}})})},Ra=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),ka=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useMemo)((()=>({rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i})),[t]);return(0,y.jsx)(Ra.Provider,{value:a,children:e})},Ia=e=>e instanceof na.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof na.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof na.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof na.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof na.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,La=e=>e instanceof na.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var Aa=i(15346),Ta=i(46103);const Da="AWblt0YATqa_XQaPUDMc",Oa="sX7AwqoSzMeT9qhlEViU",_a="jIlVu16bmijzUKG6u5VW",Ba="ZkuPLR9bss2N7f7thixx",Fa="QSZFk1XCj76mVplNmiV1",Ua="O0wmxPM0kfA59paiHqR9",Pa=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:s,subtitle:r,canLogout:l,isDisabled:o,incarnation:c,jamSession:u,onClick:p,spec:m},v){const x=(0,g._Y)(),b=(0,Aa.HJ)(c),h=l||b,{rowWithMenuOpenIdentifier:f,setRowWithMenuOpenIdentifier:j}=(0,n.useContext)(Ra),S=(0,ja.t)(La(m)&&u?.token?m.inPersonListeningSessionFactory({identifier:u.sessionId??u.token}):void 0,!!u?.token),w=(0,sa.YQ)((()=>{p(),x(ie.$S.PANEL_CLOSE_CLICK)}),1e3,{leading:!0,trailing:!1}),C=(0,n.useCallback)((e=>{"Enter"===e.key&&w()}),[w]),N=(0,y.jsx)(Ca,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:b?c:void 0}),E=u?.participants.find((e=>e.id===u.sessionOwnerId))?.displayName,R=u?.jamType===Ta.H.NEARBY_JAM?(0,y.jsx)(ra.C,{"data-testid":"sub-nearby-jam-icon",semanticColor:"textBrightAccent",size:"small"}):(0,y.jsx)(la.E,{"data-testid":"sub-jam-icon",semanticColor:"textBrightAccent",size:"small"}),k=E&&!u.isSessionOwner?(0,y.jsxs)("div",{className:Oa,ref:S,children:[R,(0,y.jsx)(oa.j,{semanticColor:"textBrightAccent",lineClamp:1,children:U.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:E})})]}):(0,y.jsxs)("div",{className:Oa,children:[a&&(0,y.jsx)(a,{className:_a,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),r&&(0,y.jsx)(oa.j,{semanticColor:"textSubdued",lineClamp:1,children:r})]});return(0,y.jsx)(ca.h,{menu:N,children:(0,y.jsx)(rn.c,{onKeyDown:C,onClick:w,className:d()(Ba,{[Ua]:f===e}),children:(0,y.jsx)(Z.v,{id:e,ref:v,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(i,{semanticColor:o?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:U.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,y.jsx)("span",{className:Da,children:(0,y.jsx)(ua.Zp,{label:s,renderInline:!0,children:(0,y.jsx)(Ee.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:o?"textSubdued":"textBase",dir:"auto",children:s})})}),subtitle:k,trailing:h&&Ia(m)&&(0,y.jsx)(Ea,{title:s,deviceId:e,connectStateDeviceId:t,allowForgetDevice:l,incarnation:b?c:void 0,spec:m,className:d()(Fa),onShow:()=>{j(e)},onHide:()=>{j(null)}})})})})})),Ma=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:l,canLogout:o,spec:c})=>{const u=(0,Aa.tf)(a,r),{helpText:d}=(0,Aa.uY)(l,(0,Aa.p2)(a,s)),p=c.disabledDeviceFactory({identifier:i,position:e,reason:l??"null"}),m=(0,ja.t)(p),g=(0,F.wA)();return(0,y.jsx)(Pa,{deviceId:t,connectStateDeviceId:i,ref:m,isDisabled:!0,disabledReason:l,Icon:u,title:n,subtitle:d,canLogout:o,onClick:()=>{l===z.bU.RESTRICTED&&g((0,aa.yx)(t))},spec:p})};var Ha=i(23133);const Va=({isDisabled:e=!1,spec:t})=>{const i=(0,F.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,ja.t)(n),s=(0,Aa.$A)(z.bq.CAST_AUDIO,"disconnected"),r=(0,le.s)();return(0,y.jsx)(Pa,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:U.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,Ha.Ym)())},isDisabled:e,spec:n})};var za=i(88975);const qa=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const s=(0,le.s)(),r=a.localDeviceFactory(),l=(0,Aa.tf)(z.bq.COMPUTER,!1),o=(0,za.D)();return(0,y.jsx)(Pa,{deviceId:e,connectStateDeviceId:t,Icon:l,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=s.logInteraction(r.hitPullPlaybackToLocalDevice());o.transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:r})},Ya=()=>{const[e,t]=(0,Ae.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}};var Ga=i(57160),Qa=i(10477),Za=i(23644),Ka=i(83886),Wa=i(21153),Ja=i(5070);const Xa=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:u,spec:d})=>{const p=(0,le.s)(),m=d.remoteDeviceFactory({identifier:i,position:e}),g=(0,Aa.tf)(a,r);let v,x;(0,Aa.Mp)(a)&&(v=(0,Aa.$A)(a,"disconnected"),x=U.Ru.get("web-player.connect.device-picker.google-cast"));const b=(0,F.wA)(),{registerTransferAttempt:h}=Ya(),f=(0,za.D)(),j=(0,ja.t)(m),S=(0,s.NC)(Gn.Yr),w=(0,Qa.Ad)((e=>{const t=(0,Wa.d)(),i=(0,An.jE)(),n=(0,s.NC)(Gn.$4,{loadingValue:!1}),{data:a}=(0,Sn.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,Sn.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Za.hT,enabled:!!a});return(0,Ja.c)(Ka.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(i));let C;C=S?u??null:w;return(0,y.jsx)(Pa,{deviceId:t,connectStateDeviceId:i,ref:j,Icon:g,TechIcon:v,title:n,subtitle:x,supportsHiFi:l,canLogout:o,incarnation:c,jamSession:C,onClick:()=>{if(C?.token&&!C.isSessionOwner){La(m)&&p.logInteraction(m.inPersonListeningSessionFactory({identifier:C.sessionId??C.token}).hitUiReveal());let e=Ga.EL.JOIN_LISTENING_SESSION;C.jamType===Ta.H.NEARBY_JAM&&(e=Ga.EL.JOIN_NEARBY_JAM),b((0,aa.A9)(e,C.token,void 0,{id:t,name:n,type:a,isGroup:r}))}else{const{interactionId:e,pageInstanceId:n}=p.logInteraction(m.hitConnectToRemoteDevice({remoteDeviceId:i}));f.transferPlayback(t,{interactionId:e,pageInstanceId:n}),h(i)}},spec:m})},$a=()=>(0,Dt.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0)),es=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,s.NC)(Gn.Yr),r=$a(),l=n.containerViewFactory().deviceListFactory(),o=(0,ja.t)(l),c=(e,t)=>{const i=U.Ru.get("web-player.connect.device-picker.this-computer");if(e.isDisabled)return(0,y.jsx)(Ma,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?z.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:!e.isLocalNetwork&&e.supportsLogout,spec:l},e.id);if(e.isLocal&&(e=>e instanceof na.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof na.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(l))return(0,y.jsx)(qa,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.supportsHiFi,spec:l},e.id);let n=null;return a&&(0,Qa.HV)(e)?n=e.nearbyJamSession:(0,Qa.C7)(e)&&(n=e.jamSession),(0,y.jsx)(Xa,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.supportsHiFi,canLogout:!e.isLocalNetwork&&e.supportsLogout,incarnation:e.incarnation,jamSession:n,spec:l},e.id)};return(0,y.jsxs)(an.$,{circular:!1,ref:o,"aria-labelledby":`${qn} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>c(e,t))),t&&(0,y.jsx)(Va,{isDisabled:r,spec:n})]})},ts="local-network-heading",is="other-networks-heading",ns=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>{const n=(0,s.NC)(Gn.Q5),a=e.length>0?U.Ru.get("web-player.connect.device-picker.on-this-network"):U.Ru.get("web-player.connect.device-picker.no-devices-local-network"),r=!n||n&&e.length<=0;return(0,y.jsxs)(y.Fragment,{children:[r&&(0,y.jsx)(l.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:Jn,id:ts,children:a}),e.length>0&&(0,y.jsx)(es,{devices:e,networkHeadingID:ts,spec:i}),t.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.E,{as:"h3",variant:n?"bodyMedium":"bodySmall",semanticColor:"textSubdued",className:d()(Jn,Xn),id:is,children:U.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,y.jsx)(es,{devices:t,networkHeadingID:is,spec:i})]})]})};var as=i(76680);const ss=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,y.jsx)("a",{className:d()(Ba),href:e,target:"_blank",ref:n,onClick:i,children:(0,y.jsx)(Z.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,y.jsx)(as.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),rs=({spec:e})=>{const t="https://www.spotify.com/connect?utm_campaign=connect&utm_medium=app&utm_source=desktop",i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,ja.t)(i),a=(0,le.s)();return(0,y.jsx)(ss,{url:t,linkText:U.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},ls="https://support.spotify.com/article/spotify-connect/",os=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,ja.t)(t),n=(0,le.s)();return(0,y.jsx)(ss,{url:ls,linkText:U.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:ls}))}})};var cs=i(83534);const us=[cs.h.en,cs.h.enGB],ds=()=>{const e=U.Ru.getLocaleForTranslation();return us.includes(e)};const ps=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{$a();const i=ds(),n=e,{recentTransfersMap:a}=Ya(),s=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.sortingId]?i.push({device:a,timestamp:t[a.sortingId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const l=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return l}(n,a),{spec:r}=(0,et.r)(na.p,{}),l=s.filter((e=>e.isLocalNetwork)),o=s.filter((e=>!e.isLocalNetwork));return(0,y.jsxs)("div",{className:d()(Qn,Zn),children:[(0,y.jsx)("div",{children:o.length>0?(0,y.jsx)(ns,{localNetworkDevices:l,otherNetworksDevices:o,spec:r}):(0,y.jsx)(es,{devices:s,areWebPlayerCastDevicesAvailable:t,spec:r})}),(0,y.jsxs)("div",{className:d()($n),children:[(0,y.jsx)(os,{spec:r}),i&&(0,y.jsx)(rs,{spec:r})]})]})};var ms=i(95874),gs=i(54366),vs=i(12585);const xs=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i},n){return(0,y.jsx)(rn.c,{className:Ba,children:(0,y.jsx)(Z.v,{id:t,ref:n,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(e,{semanticColor:"textSubdued"}),title:(0,y.jsx)("span",{className:Da,children:(0,y.jsx)(ua.Zp,{label:t,renderInline:!0,children:(0,y.jsx)(Ee.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",children:t})})}),subtitle:(0,y.jsx)("div",{className:Oa,children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})})})})}));var bs=i(33415);const hs="Bjx5Gw7p3JoiF4qI6eMQ",ys=()=>{const{deviceFilterState:e,isMaybeHeadphoneDevice:t}=(0,ae.j)(),i=(0,ce.j)(),n=(0,$e.v)(),a=(0,Oe.A)(),s=e.currentState.externalizationEnabled||e.currentState.specificEnabled,r=a===fe.Yn.LOSSLESS||a===fe.Yn.LOSSLESS_24;return(0,y.jsxs)("div",{className:hs,children:[n&&s&&t&&(0,y.jsx)(qe.C,{size:"small",semanticColor:"textBrightAccent"}),(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:i&&r&&"Lossless"})]})},fs="A3PPnVKE5LH9mT5URPB2",js="cU0IpwDfJzDgQaY4MSXA",Ss="dlS4nc0WL68C7_8zwfiS",ws="pdLJBD_CNQ_r5Ad4mZZk",Cs="FpmhhFL8lCsiyh3X0fjK",Ns="scv87ulfUcibJW8QhCeH",Es="oCa5Np4laJc3s5P2uUqw",Rs=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=Y();return(0,y.jsx)("div",{className:Es,children:(0,y.jsx)(ua.Zp,{label:i??t,children:(0,y.jsx)(oa.j,{lineClamp:1,onClick:e,children:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var ks=i(53224);const Is=({size:e="medium",className:t})=>{const i=(0,Di.j)(),n=(0,ks.k)(e);return(0,y.jsx)(y.Fragment,{children:i?(0,y.jsx)(Re.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,y.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Pi.b)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var Ls=i(94677);const As=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,Ls.g)();let s;if(n)s=(0,y.jsx)(Is,{});else{const n=(0,Aa.tf)(e,t,i?a:null);s=(0,y.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,y.jsxs)("div",{className:ws,children:[(0,y.jsx)("div",{className:Cs,children:s}),(0,y.jsx)(Ee.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:U.Ru.get("web-player.connect.device-picker.current-device")})]})};var Ts=i(88639),Ds=i(19158),Os=i(14422),_s=i(84277);const Bs=()=>{const{currentDevice:e}=(0,_s.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,r=(0,Os.W)(),l=!n&&a,o=l,{spec:c}=(0,et.r)(na.p,{}),u=(0,s.NC)(Gn.Q5),d=(0,$e.v)(),p=(0,ce.j)(),{deviceName:m,formattedDeviceName:g}=Y(),v=r?Ts.g:sn.V,x=u?Ds.x:v,b=u?"textSubdued":"textBase";return(0,y.jsx)("div",{className:Ns,children:d||p?(0,y.jsx)(x,{"aria-label":U.Ru.get("more.label.context",g??m),size:"small",autoMirror:!1,semanticColor:b}):o&&(0,y.jsx)(Ea,{title:g??m,deviceId:t,connectStateDeviceId:i,allowForgetDevice:l,spec:c.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Fs=i(27766),Us=i(29879),Ps=i(35953),Ms=i(84621);const Hs=()=>{const e=(0,Wa.d)(),{enqueueSnackbar:t}=(0,Ps.d)(),{spec:i,logger:a}=(0,et.r)(bs.g,{}),[s,r]=(0,n.useState)(Ms.ez.BROADCAST_STATUS_UNKNOWN),l=s===Ms.ez.BROADCAST_STATUS_UNKNOWN||s===Ms.ez.BROADCAST_UNAVAILABLE,o=s===Ms.ez.BROADCAST_ON;(0,Ja.c)(Ka.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??Ms.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?Ms.ez.BROADCAST_ON:Ms.ez.BROADCAST_OFF)),[e]),u=(0,Us.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?Ms.ez.BROADCAST_ON:Ms.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??Ms.ez.BROADCAST_STATUS_UNKNOWN),t(U.Ru.get("error.generic"))}});return{isHidden:l,toggleIsSwitchedOn:o,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}},Vs="k5CAXCZwazRLdTWi5mpN",zs="f2Wgf5OqTaBlTRRKZe9X",qs=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Hs();return e?null:(0,y.jsxs)("div",{className:Vs,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:zs,children:U.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,y.jsx)(Fe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Ys=i(22458),Gs=i(71516),Qs=i(99920),Zs=i(77908),Ks=i(66225);const Ws="device-picker-header",Js=({isPlaying:e})=>{const{currentDevice:t}=(0,_s.l)(),{id:i,connectStateId:a,type:r,isLocal:l,isLocalNetwork:o,isGroup:c,incarnation:u,supportsLogout:p}=t,m=(0,$e.v)(),g=(0,ce.j)(),{togglePuffin:v}=(0,Fs.c)(),{currentSession:x}=(0,Ks.D)(),b=(0,Qs.y)(),h=(0,s.NC)(Gn.$4),f=Boolean(x?.active),j=!f&&b,S=(0,Aa.HJ)(u),w=!o&&p,C=w||S,{spec:N,logger:E}=(0,et.r)(bs.g,{}),{uri:R}=(0,Zs.f)(),k=(0,n.useCallback)((()=>{E.logInteraction(N.createJamButtonFactory().hitUiNavigate({destination:R??""}))}),[E,N,R]),I=(0,y.jsx)(Ca,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:w,incarnation:S?u:void 0}),L=m||g,A=(0,y.jsx)(Z.v,{className:d()(js,{[Ss]:L}),id:Ws,variant:"naked",title:(0,y.jsx)(As,{deviceType:r,isGroup:c,isLocalDevice:l,isPlaying:e}),subtitle:(0,y.jsxs)("div",{className:Es,children:[(0,y.jsx)(Rs,{onClick:L?v:void 0}),L&&(0,y.jsx)(ys,{})]}),trailing:(0,y.jsx)(Bs,{}),"aria-labelledby":Ws,onClick:L?v:void 0,onClickHint:U.Ru.get("web-player.connect.device-picker.current-device"),body:b&&(0,y.jsxs)(y.Fragment,{children:[h&&(0,y.jsx)(qs,{}),(0,y.jsx)("hr",{className:fs})]}),footer:(0,y.jsxs)(y.Fragment,{children:[j&&(0,y.jsx)(Gs.$,{onClick:k}),f&&h&&(0,y.jsx)(Ys.K,{})]})});return C?(0,y.jsx)(ca.h,{menu:I,children:A}):A},Xs=({isDesktop:e})=>{const t=ds(),{spec:i}=(0,et.r)(na.p,{}),n=i.containerViewFactory().noDevicesViewFactory(),a=(0,ja.t)(n);return(0,y.jsxs)("div",{ref:a,className:d()(ea,Zn,Qn),"data-testid":Yn,children:[(0,y.jsxs)("ul",{"aria-labelledby":`${Ws} ${qn}`,className:ta,children:[(0,y.jsx)(xs,{Icon:ms.T,title:U.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:U.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,y.jsx)(xs,{Icon:Ft.g,title:U.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:U.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,y.jsx)(xs,{Icon:gs.H,title:U.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:U.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,y.jsx)(xs,{Icon:vs.i,title:U.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:U.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle")})]}),(0,y.jsxs)("div",{"aria-describedby":Yn,children:[(0,y.jsx)(os,{spec:i}),t&&(0,y.jsx)(rs,{spec:i})]})]})},$s=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t;return(0,y.jsxs)("div",{className:d()(Kn,Zn),children:[(0,y.jsx)(ia,{foundDevices:a}),a?(0,y.jsx)(ka,{children:(0,y.jsx)(ps,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,y.jsx)(Xs,{isDesktop:!0})]})},er=()=>{const{currentDevice:e}=(0,_s.l)(),{formattedDeviceName:t}=Y(),i=(()=>{const e=(0,Oe.A)(),t=(0,ce.j)();return(0,n.useMemo)((()=>{const i=e===fe.Yn.LOSSLESS||e===fe.Yn.LOSSLESS_24;return t&&i?U.Ru.get("web-player.pigeon.audio-quality.lossless"):null}),[e,t])})(),a=U.Ru.get("web-player.connect.device-picker.this-computer");let s;(0,Aa.Mp)(e.type)&&(s=U.Ru.get("web-player.connect.device-picker.google-cast"));const r=[(t??null)&&a,s??null,i].filter(Boolean).join(" • ");return(0,y.jsx)(oa.j,{semanticColor:"textSubdued",lineClamp:1,children:r})};var tr=i(79464),ir=i(30767),nr=i(36499);const ar="cuG1_yCuW2Mnw3H6IUYD",sr=()=>{const{currentDevice:e}=(0,_s.l)(),{type:t,isLocal:i,isGroup:n}=e,{isPlaying:a}=(0,nr.GK)(),s=(0,Ls.g)(),r=(0,$e.v)(),l=(0,ce.j)(),{togglePuffin:o}=(0,Fs.c)(),{deviceName:c}=Y(),u=r||l,d=(0,ir.K)(),p=a?Is:r&&d?qe.C:(0,tr.tf)(t,n,i?s:null);return(0,y.jsx)(Z.v,{id:"device-picker-header",variant:"naked",size:"md",className:ar,title:c,"data-testid":"device-picker-row-sidepanel",media:(0,y.jsx)(p,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"}),onClick:u?o:void 0,trailing:(0,y.jsx)(Bs,{}),subtitle:(0,y.jsx)(er,{})})},rr="G6For7gcz2GTgCkOeJKc",lr=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=Hs();return e?null:(0,y.jsxs)("div",{className:rr,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textBase",as:"label",htmlFor:"jam.broadcasting",children:U.Ru.get("web-player.connect.device-picker.auto-invite-jam-toggle")}),(0,y.jsx)(Fe.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var or=i(35994);const cr="fkBkl4cpmR6fFGNpsPZx",ur="Wv3hgdJTMsji4hS4an1O",dr="uqNT_uoUuNHbne2OA1u0",pr=({openQueue:e})=>{const t=(0,Ks.D)(),{uri:i}=(0,Zs.f)(),{spec:a,logger:s}=(0,et.r)(bs.g,{}),r=(0,n.useCallback)((()=>{s.logInteraction(a.createJamButtonFactory().hitUiNavigate({destination:i??""}))}),[s,a,i]);return(0,y.jsxs)("div",{className:cr,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:ur,children:U.Ru.get("web-player.connect.device-picker.start-jam-description")}),(0,y.jsx)(pe.n,{onClick:()=>{r(),t.createSession(),e()},iconLeading:or.V,size:"small",className:dr,children:U.Ru.get("web-player.connect.device-picker.start-jam")})]})};var mr=i(34506);const gr="rk32VTG0b6NU0RicbiOH",vr=()=>{const e=(0,Ks.D)(),{openQueue:t}=(0,mr.R)(),i=e.currentSession?.active?(0,y.jsx)(Ys.K,{}):(0,y.jsx)(pr,{openQueue:t});return(0,y.jsxs)("div",{className:d()(gr),"aria-label":U.Ru.get("web-player.connect.device-picker.current-device"),role:"group",children:[(0,y.jsx)(sr,{}),(0,y.jsx)(lr,{}),i]})};var xr=i(66973);const br="Y5BWxTfO9OmenxMup_H7",hr="s0kxKAi2bTiuoEJhkYph",yr="Cdlb8uLk1VIkwKmGBViF",fr=({Icon:e,title:t,subtitle:i,buttonText:a,onClick:s,onDismiss:r})=>{const{spec:o}=(0,et.r)(na.p,{}),c=o.containerViewFactory().messageBoxViewFactory({identifier:t}),u=(0,le.s)(),d=(0,n.useCallback)((()=>{u.logInteraction(c.dismissMessageBoxFactory().hitUiHide()),r()}),[u,c,r]),p=(0,n.useCallback)((()=>{u.logInteraction(c.recommendedActionButtonFactory().hitUiHide()),s()}),[u,c,s]),m=(0,y.jsxs)("div",{className:yr,children:[e&&(0,y.jsx)(e,{semanticColor:"textSubdued",size:"small"}),(0,y.jsx)(l.E,{variant:"bodyMediumBold",color:"baseText",children:t})]});return(0,y.jsx)(Z.v,{id:"messageBox",variant:"elevated",size:"lg",className:br,title:m,subtitle:i,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsx)(pe.n,{size:"small",onClick:p,children:a}),trailing:(0,y.jsx)(me.H,{className:hr,semanticColor:"textBase",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":U.Ru.get("close")})})},jr=e=>{if("object"==typeof e&&"custom"in e)return e.custom;switch(e){case"required":return 1e3;case"high":return 500;case"normal":return 300;case"low":return 100;default:return 0}},Sr=()=>{const{deviceFilterState:e}=(0,ae.j)(),t=(0,n.useMemo)((()=>e.audioDevice?.id),[e.audioDevice?.id]),[i,a]=(0,Ae.x)("onboarding-dismissed:puffin",{}),s=(0,n.useCallback)((()=>{t&&a({...i,[t]:(i[t]??0)+1})}),[t,i,a]);return{isDeviceDismissed:(0,n.useMemo)((()=>!!t&&i[t]>=3),[t,i]),incrementDismissCountForDevice:s}},wr=()=>[(()=>{const e=(0,g._Y)(),{incrementDismissCountForDevice:t,isDeviceDismissed:i}=Sr(),{deviceFilterState:n,isMaybeHeadphoneDevice:a}=(0,ae.j)(),s=n.isOnboarded,r=a&&!s&&!i;return{id:"puffinDevicePickerUpsell",title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),buttonText:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:()=>{e(ie.$S.PUFFIN_START_ACTIVATION)},onDismiss:()=>{t()},shouldShow:r,priority:"normal"}})()],Cr=e=>{const t=e.filter((e=>e.shouldShow)).sort(((e,t)=>{return i=e.priority,n=t.priority,jr(i)<jr(n)?1:-1;var i,n}));return t[0]?t[0]:null};var Nr=i(83660),Er=i(7954);const Rr=()=>{const{currentDevice:e}=(0,_s.l)(),t=wr(),i=Cr(t),[a,s]=(0,n.useState)(e.isLocal&&null!==i);if((0,Er.W)(Nr.P.UPDATE,(()=>s(e.isLocal&&null!==i))),null===i||!a)return null;return(0,y.jsx)(fr,{...i,onDismiss:()=>{i.onDismiss(),s(!1)}})};var kr=i(59953);const Ir="hmVfxvHNFzG0vUNl80tU",Lr="TuVVAkUzyLv_yCLzKTqW",Ar=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,ae.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:l}=Sr(),o=(0,n.useMemo)((()=>a&&!s&&!l),[l,a,s]),c=(0,g._Y)(),u=(0,n.useCallback)((()=>c(ie.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return o&&e?(0,y.jsx)(Z.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:Ir,title:U.Ru.get("web-player.puffin.get-started.title"),subtitle:U.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,y.jsx)(pe.n,{size:"small",onClick:u,children:U.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,y.jsx)(me.H,{className:Lr,semanticColor:"textSubdued",iconOnly:xr.M,size:"small",onClick:d,condensedAll:!0,"aria-label":U.Ru.get("close")})}):null};var Tr=i(48861),Dr=i(18154),Or=i(62737);function _r(){return(0,fa.N)(Or.v)}const Br=()=>{const e=_r(),{devices:t,currentDevice:i}=(0,_s.l)(),a=(()=>{const e=_r(),[t,i]=(0,n.useState)([]),a=(0,n.useCallback)((()=>{e.getJamDevices().then((e=>i(e)))}),[e]);return(0,Ja.c)(Ka.P.SCAN_UPDATE,(()=>a())),(0,n.useEffect)((()=>a()),[a]),t})(),[s,r]=(0,n.useState)(t.map((e=>(0,Qa.gS)(e)))),l=(0,sa.dh)((()=>{const n=e.combineJamsWithEntities(t,a,i.connectStateId);r(n)}),100,{leading:!1,trailing:!0});return(0,n.useEffect)((()=>l()),[t,a,i,l]),s},Fr="h0XG5HZ9x0lYV7JNwhoA",Ur="JHlPg4iOkqbXmXjXwVdo",Pr="jEsh5c0FZojBDcUF990w",Mr=()=>{const e=(0,Dr.O)(),t=(0,$e.v)(),i=(0,H.l)(),a=(0,kr.C)(),r=(0,s.NC)(Gn.Yr),l=(0,s.NC)(Gn.Q5),{devices:o}=(0,_s.l)(),c=Br(),{isPlaying:u}=(0,nr.GK)(),[p]=(0,g.sV)(),m=(0,n.useRef)(a),x=(0,n.useRef)(p.context.devicePicker?.interactionId);m.current=a,x.current=p.context.devicePicker?.interactionId;const b=(0,F.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),h=(0,Tr.Or)(b);return(0,n.useEffect)((()=>()=>{m.current(x.current)}),[x]),(0,n.useEffect)((()=>{e.startActiveDiscovery()}),[e]),(0,y.jsx)(at._,{label:U.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,y.jsx)(w.w,{className:d()(Fr,{[Ur]:l}),fixedHeader:(0,y.jsx)(C.a,{title:l?(0,ke.v)("Connect"):U.Ru.get("playback-control.connect-picker"),panel:v.Z.DevicePicker}),children:(0,y.jsxs)("div",{role:"group",className:Pr,children:[l?(0,y.jsx)(vr,{}):(0,y.jsx)(Js,{isPlaying:u}),l?(0,y.jsx)(Rr,{}):t&&!i&&(0,y.jsx)(Ar,{}),(0,y.jsx)($s,{devices:r?c:o.map((e=>(0,Qa.gS)(e))),areWebPlayerCastDevicesAvailable:h})]})})})},Hr=()=>null;var Vr=i(53177),zr=i(41205),qr=i(43894),Yr=i(46232),Gr=i(95147),Qr=i(42551);const Zr=(0,Qr.Mz)([e=>e.ads],(e=>e.embeddedAd)),Kr=(0,Qr.Mz)(Zr,(e=>e?.ad)),Wr=(0,Qr.Mz)(Zr,(e=>e?.isOpen||!1)),Jr=(0,Qr.Mz)(Zr,(e=>e?.canShowAd||!1)),Xr=(0,Qr.Mz)(Zr,(e=>e?.lastTimeInView));var $r=i(61211),el=i(23898),tl=i(12689);const il=e=>{const t=(0,el.Z)(e);return!(!t||e&&!(0,tl.v)(e))&&t?.uid!==e?.uid};var nl=i(17145);const al=()=>{const e=(0,F.wA)(),t=(0,$r.$)(),i=(0,F.d4)((e=>e.ui.videoPlayer.uiFlags.npv)),a=(0,s.NC)(nl.Ym5,{loadingValue:!1}),r=(0,s.NC)(nl._TI),l=(0,Dt.o)((e=>e?.item),((e,t)=>e?.uid===t?.uid)),o=(0,F.d4)(Jr),c=!!(0,F.d4)(Kr),u=(0,F.d4)(Xr),d=(({canShowEmbeddedAd:e,nvpIsActive:t,trackChanged:i,featureEnabled:a,storeHasAd:s,isFocused:r,enoughTimePassedSinceLastRender:l})=>(0,n.useMemo)((()=>!!e&&t&&i&&a&&r&&!s&&l),[e,t,i,a,s,r,l]))({canShowEmbeddedAd:o,nvpIsActive:i,trackChanged:il(l),featureEnabled:a,storeHasAd:c,isFocused:t,enoughTimePassedSinceLastRender:!u||Date.now()-u>1e3*r});return(0,n.useEffect)((()=>{d&&e((0,Gr.PY)())}),[d,e,l]),null};var sl=i(52276);const rl=({children:e})=>{const[t,i]=(0,n.useState)(null),a=(0,n.useCallback)((()=>{i(sl.j.Errored)}),[]),s=(0,n.useMemo)((()=>({state:t,capturePlaybackError:a})),[t,a]);return(0,y.jsx)(sl.O.Provider,{value:s,children:e})},ll=(0,n.lazy)((()=>Promise.all([i.e(9496),i.e(54),i.e(2496)]).then(i.bind(i,31952)))),ol=e=>(0,y.jsx)(rl,{children:(0,y.jsx)(ll,{...e})});var cl=i(24313),ul=i(25695),dl=i(81421);const pl=()=>(0,y.jsx)(y.Fragment,{});var ml=i(74622),gl=i(22152),vl=i(12213),xl=i(48541),bl=i(25783),hl=i(79175),yl=i(33947),fl=i(25228),jl=i(19792);const Sl="ykU0u_RLxGVmkHVI7if7",wl="KpPP2M5NXZAY5NwqT1uf",Cl=({uri:e})=>{const{spec:t,logger:i}=(0,et.r)(ml.t,{}),n=(0,F.wA)(),{data:a}=(0,gl.S)(e),[s,r]=(0,jl.A)(e);if(!a)return null;const{description:l,name:o,images:c}=a,u=(0,fl.t)({avatarImages:c,preferFullBleed:!1});return(0,y.jsxs)(yl.M,{name:o,openModal:()=>{const e=t.authorAboutModalButtonFactory().hitUiReveal();i.logInteraction(e),n((0,aa.Te)({bio:a.description,images:a.images.slice(0,1),name:a.name}))},children:[(0,y.jsx)(bl.R,{cardVariant:u,avatarImageSources:c,header:U.Ru.get("web-player.now-playing-view.author-about.title"),name:o}),(0,y.jsxs)("div",{className:Sl,children:[(0,y.jsxs)("div",{className:wl,children:[(0,y.jsx)(hl.c,{name:o,uri:e,onLinkClick:()=>i.logInteraction(t.authorNameFactory().hitUiNavigate({destination:e}))}),(0,y.jsx)(xl.T,{toggleFollow:n=>{n.preventDefault(),n.stopPropagation();const a=s?t.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e}):t.followButtonFactory().hitFollow({itemToBeFollowed:e});i.logInteraction(a),r(!s)},isInLibrary:s})]}),(0,y.jsx)(vl._,{text:l})]})]})},Nl=({item:e})=>{const t=e.book.authors.at(0)?.uri;return t?(0,y.jsx)(Cl,{uri:t}):null};var El=i(26879),Rl=i(85547),kl=i(21768),Il=i(47588),Ll=i(87997),Al=i(1328),Tl=i(47986),Dl=i(60996),Ol=i(81573),_l=i(95941),Bl=i(35748),Fl=i(49260),Ul=i(1263);var Pl=i(54059),Ml=i(53936),Hl=i(96231);const Vl="_QEMUk5U16U3CQn0wvbD",zl="mbkl2P60JUhDqc9qGvp9",ql="Xh6dG3pzi2SS7v4cvZzG",Yl="sOdoW26RUwggLToa7xDt",Gl="B_TcBcc1BM2yLgvXbh66",Ql="tRnhyUQiKOxA3z8mUD_U",Zl="_shxqlkLuB52H1iCh_OQ",Kl="hAwePVlxumRNpdOSpwyV";const Wl=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:l}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:Tl.L,label:U.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(U.Ru.getSeparator())||"";return{Icon:Dl.v,label:U.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),o=(0,n.useCallback)((()=>{i()}),[i]);return(0,y.jsxs)("div",{className:d()(Zl,e),children:[a?(0,y.jsx)(Ml.J,{className:Ql,animated:!0}):(0,y.jsx)("span",{className:Ql,children:(0,y.jsx)(l,{iconSize:16,"aria-hidden":"true"})}),(0,y.jsx)(Bl.x,{className:Gl,iconClassName:Kl,onClick:o,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),Jl=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,et.r)(Ol.f,{}),r=(0,sa.YQ)((()=>{const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),Hl.d,{leading:!0,trailing:!1});return(0,y.jsx)("div",{className:Yl,onDoubleClick:r,children:e})},Xl=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,et.r)(Ol.f,{}),{isActive:r,isPlaying:l,onClick:o}=(0,Pl.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:Ul.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:Ul.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:Ul.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{o({}),r&&l?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!l?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,l,s,o,d]);return(0,y.jsxs)(Jl,{onTriggerPlay:o,episodeUri:t,children:[(0,y.jsx)(Wl,{segment:e,isActive:r,isPlaying:l,onClickPlay:()=>{p()}}),(0,y.jsx)(Fl.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},$l=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,et.r)(Ol.f,{}),{isActive:r,isPlaying:o,onClick:c}=(0,Pl.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:Ul.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:Ul.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{c({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,c,d]);return(0,y.jsxs)(Jl,{onTriggerPlay:c,episodeUri:t,children:[(0,y.jsx)(Wl,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,y.jsx)(_l.z,{title:u.name,children:(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var eo=i(46524),to=i(81126);function io(e){return!!(0,to.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,Bn.gHQ)(t)}(e)}var no=i(8061);const ao=(0,Vr.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,to.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),l=(0,n.useRef)(0),o=(0,n.useCallback)((()=>{const e=l.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return l.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,y.jsxs)(eo.w,{className:Vl,children:[(0,y.jsx)(eo.X,{className:zl,children:U.Ru.get("music_and_talk.in_this_episode")}),(0,y.jsx)("div",{className:ql,children:(0,y.jsx)(no._,{onReachBottom:o,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,y.jsx)(Xl,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,y.jsx)($l,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var so=i(52451),ro=i(21726),lo=i(91975),oo=i(20554);const co="f6_Fu_ei4TIJWR0wzvTk",uo="TLmzadNIdvV8sYzTuXRg",po="MT9De6UrCVQ8Qo6o3ikA",mo=n.memo((()=>{const{cssStyles:e}=(0,oo.Yc)();return(0,y.jsx)("div",{className:co,style:{"--section-background-base":e?.["--section-background-base"]},"aria-hidden":!0,children:(0,y.jsxs)("div",{className:uo,children:[(0,y.jsx)(lo.Y,{as:"div",variant:"bodyMediumBold",className:po,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,y.jsx)(lo.Y,{as:"div",variant:"bodySmall",className:po,charCount:e,isLoading:!0},t)))]})})}));var go=i(32291),vo=i(42091),xo=i(95344),bo=i(75277);const ho=(0,n.lazy)((async()=>{const{TopCommentsCard:e}=await Promise.resolve().then(i.bind(i,15319));return{default:e}}));var yo=i(1108),fo=i(39132);const jo=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,s.NC)(nl.cgF),r=(0,s.NC)(nl.xEc),l=(0,yo.d)(),o=(0,fo.d)(e.uri)?.episodeOrChapter,c=io(e),u={uri:e.uri,numberOfChapters:Al.Kp},{data:d,isLoading:p,error:m}=(0,vo.X)({queryKey:["queryNpvEpisode",u],staleTime:Al.Ff,gcTime:Al.CD,variables:u});if(p&&e.uri&&!m)return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(mo,{}),(0,y.jsx)(mo,{})]});const g=(0,Rl.SB)(d?.episodeUnionV2),v=(0,Rl.lz)(d?.episodeUnionV2);if(!e.uri||!g||p||m)return null;const x=o&&o.type===Ul.c.EPISODE&&o.transcript&&o.transcript.length>0;return(0,y.jsxs)(Na.r,{spec:t,children:[l&&(0,y.jsx)(n.Suspense,{fallback:null,children:(0,y.jsx)(ho,{uri:g.uri})}),(0,y.jsx)(Ll.N,{episode:g}),!g.originalEpisode&&(0,y.jsx)(kl.c,{episode:g}),(0,y.jsx)(xo.F,{episode:g}),!c&&(0,y.jsx)(El.I,{episode:g}),r&&v&&(0,y.jsx)(ro.m,{coverArt:v.coverArt||void 0,description:v.htmlDescription||"",name:v.name,publisher:v.publisher?.name,uri:v.uri}),x&&(0,y.jsx)(y.Fragment,{children:a?(0,y.jsx)(bo.n,{episode:e}):(0,y.jsx)(Il.E,{episodeUri:e.uri})}),c&&(0,y.jsx)(ao,{item:e}),(0,y.jsx)(go.K,{topics:v?.topics.items??[],logTopicNavigation:i}),(0,y.jsx)(so.A,{})]})},So=({item:e,spec:t})=>(0,Tt.n)()?(0,y.jsx)(jo,{item:e,spec:t}):(0,y.jsx)(y.Fragment,{}),wo=()=>(0,y.jsx)(y.Fragment,{});var Co=i(26948),No=i(54610),Eo=i(91068),Ro=i(33),ko=i(1196),Io=i(71076),Lo=i(5106);const Ao="gpDSOimnzH4zTJmE7UR5",To="N9Xjnxz8vGgWwbEBE5g7",Do="KzMnBC9eFK8cAfcFTg9b",Oo="y2ayfytLUMyeb3dafZmy",_o="xVOR38GuCNnraHeE56VZ",Bo="Rp8WpXLxe4HlMlQ79OLY",Fo="I2WIloMMjsBeMaIS8H3v",Uo="hzUuLPdH48AzgQun5NYQ",Po=()=>{const{mode:e,setMode:t}=(0,Lo.r)();return(0,y.jsxs)("div",{className:Oo,children:[e===Ga.YU.npv&&(0,y.jsx)(c.$,{label:U.Ru.get("web-player.now-playing-view.lyrics.show-less"),colorSet:"invertedLight",size:"small",onClick:()=>{t(Ga.YU.static)},children:U.Ru.get("web-player.now-playing-view.lyrics.show-less")}),e===Ga.YU.static&&(0,y.jsx)(c.$,{label:U.Ru.get("web-player.now-playing-view.lyrics.show-more"),colorSet:"invertedLight",size:"small",onClick:()=>{t(Ga.YU.npv)},children:U.Ru.get("web-player.now-playing-view.lyrics.show-more")})]})};var Mo=i(8410),Ho=i(72152),Vo=i(18466),zo=i(76458),qo=i(20883),Yo=i(12131),Go=i(60169),Qo=i(96859);const Zo=()=>{const{setMode:e}=(0,Lo.r)(),t=(0,n.useCallback)((()=>{e(Ga.YU.none)}),[e]);return(0,y.jsx)(ha.D,{role:"menuitem",onClick:t,children:U.Ru.get("web-player.now-playing-view.lyrics.hide-option")})},Ko=()=>(0,y.jsx)(xa.W,{children:(0,y.jsx)(Zo,{})});var Wo=i(97724);const Jo=()=>{const{spec:e,logger:t}=(0,et.r)(Vo.X,{}),i=(0,ja.t)(e.cinemaModeButtonFactory()),a=(0,Go.l)(),r=(0,Qo.F)(),l=(0,n.useRef)(null);(0,ee.X)("NPV_OPEN_CINEMA_LYRICS",l,3e3);const o=(0,qo.lZ)(),c=(0,s.NC)(nl.mzn),{isFullScreenSupported:u,toggleFullScreen:d}=(0,Wo.H)({refOrElement:document.body});return(0,y.jsxs)("div",{ref:i,className:Do,children:[o&&u&&c&&(0,y.jsx)(zo.D,{ref:l,label:U.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:async()=>{try{await d()}catch(e){}r("lyrics"),a(Vn.z.NOW_PLAYING_VIEW)},children:(0,y.jsx)(Yo.T,{})}),(0,y.jsx)(zo.D,{ref:l,label:U.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{a(Vn.z.NOW_PLAYING_VIEW),r("lyrics"),t.logInteraction(e.cinemaModeButtonFactory().hitUiReveal())},children:(0,y.jsx)(Mo.L,{size:"small"})})]})},Xo=()=>(0,y.jsx)("div",{className:Do,children:(0,y.jsx)(pa.b,{placement:"bottom-end",menu:(0,y.jsx)(Ko,{}),children:(0,y.jsx)(cl.e,{size:"small",condensed:!1,label:U.Ru.get("more")})})}),$o=()=>{const{spec:e,logger:t}=(0,et.r)(Vo.X,{}),i=(0,ja.t)(e.showLyricsButtonFactory()),{setMode:n}=(0,Lo.r)();return(0,y.jsx)("div",{ref:i,className:Do,children:(0,y.jsx)(zo.D,{label:U.Ru.get("web-player.now-playing-view.show.lyrics"),onClick:()=>{n(Ga.YU.npv),t.logInteraction(e.showLyricsButtonFactory().hitUiReveal())},children:(0,y.jsx)(Ho.r,{size:"small"})})})};var ec=i(74549),tc=i(97143);const ic=(0,Vr.mc)((({item:e})=>{const t=(0,n.useRef)(null),{mode:i}=(0,Lo.r)(),a=(0,n.useRef)(null),s=(0,n.useRef)(0),{data:r}=(0,Io.J)(),o=(0,Dt.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,ko.I)(o?.uri,o?.images);const c=(0,n.useCallback)((()=>{s.current=Date.now()}),[]),u=(0,n.useCallback)((({lineRef:e,isActiveLine:n,shouldAnimateScroll:r,activeLineIndex:l,isFirstLine:o})=>{if(i===Ga.YU.static)return;if(!t.current||!a.current)return;let c;if(e.current&&n?c=e.current?.offsetTop-a.current?.offsetTop-16:o&&l<0&&(c=0),void 0===c)return;const u=a.current?.scrollTop,d=Math.abs(u-c),p=t.current.clientHeight,m=Date.now()-s.current<2e3,g=s.current>0&&d>1*p;if(m||g)return;s.current=0;const v="visible"===document.visibilityState&&r?"smooth":"auto";a.current?.scrollTo({top:c,behavior:v})}),[i]);(0,n.useLayoutEffect)((()=>{s.current=0,a.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const p=r?.hasLyrics?r.dynamicColors?.higherContrast:null;if(!r?.hasLyrics)return null;const m=r?.hasLyrics&&!r.isTimeSynced,g={"--lyrics-color-active":p?.textBase.toCSS(tc.a.RGBA)??(m?Eo.ONy:r.colors.activeText),"--lyrics-color-inactive":p?.textSubdued.toCSS(tc.a.RGBA)??r.colors.text,"--lyrics-color-passed":p?.textBase.toCSS(tc.a.RGBA)??ec.Q.fromCSS(r.colors.activeText,.7).toCSS(tc.a.RGBA),"--lyrics-color-background":p?.backgroundBase.toCSS(tc.a.RGBA)??r.colors.background};return i===Ga.YU.cinema?null:(0,y.jsxs)(eo.w,{className:d()(Ao,Fo,{[_o]:i===Ga.YU.static,[Bo]:i===Ga.YU.none}),style:g,ref:t,children:[(0,y.jsx)(eo.X,{action:(()=>{switch(i){case Ga.YU.npv:return(0,y.jsx)(Jo,{});case Ga.YU.static:return(0,y.jsx)(Xo,{});default:return(0,y.jsx)($o,{})}})(),className:d()({[To]:i===Ga.YU.npv}),children:i===Ga.YU.static?U.Ru.get("web-player.now-playing-view.lyrics.title-preview"):U.Ru.get("web-player.lyrics.title")}),[Ga.YU.npv,Ga.YU.static].includes(i)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Po,{}),(0,y.jsxs)("div",{className:Uo,ref:a,onWheel:c,onScroll:c,children:[m&&i===Ga.YU.npv&&(0,y.jsx)(l.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:r.colors.text},children:U.Ru.get("web-player.lyrics.unsynced")}),(0,y.jsx)(Ro.x,{trackUri:e.uri,data:i===Ga.YU.static?{...r,isTimeSynced:!1}:r,format:"card",onActiveLineChange:u})]})]})]})}),{name:"NPVLyrics"});var nc=i(39688),ac=i(43405),sc=i(12711),rc=i(62798),lc=i(31518),oc=i(62108),cc=i(76540),uc=i(76434),dc=i(60790),pc=i(104),mc=i(9132),gc=i(60237);const vc="Kz3HNT1PWTHOL6wjYXb8",xc="Fip8h1J04RvF8_CRfdwc",bc="WEz9K1UHOS2wrRWQmZBo",hc="AUxek3jYdcq9XPBwL7N0",yc=({images:e,breakpoint:t,type:i,name:n,...a})=>(0,y.jsxs)("div",{className:xc,children:[(0,y.jsx)("div",{className:bc,children:(0,y.jsx)(mc.e,{images:e,breakpoint:t,type:i,name:n,...a})}),(0,y.jsx)("div",{className:d()(vc,{[hc]:i===Ul.c.ARTIST||i===Ul.c.USER}),children:(0,y.jsx)(gc.R,{onClick:()=>{},isPlaying:!1,version:gc.H.transparent,size:"small"})})]});var fc=i(4966),jc=i(3206),Sc=i(309),wc=i(46412),Cc=i(90423),Nc=i(84785),Ec=i(38138);const Rc="xwokxeEfMKnFFg0UPVC7",kc="mNgLTx6k86JO7fS8CBx5",Ic="k1ZhEUZAYffOk3UxUsYF",Lc="toF4isn16zybsTjDktbg",Ac="pXKTpGpCyvyKgwx858dg",Tc="TGaA9GNwNHNqOI1puGsG",Dc="WbAVELAe4MYolhkCc3Fi",Oc="dbxGYAFrGj4AmrkUZUF_",_c="R9vTZwai2jSPTWVMsiwJ",Bc="jgrHQqqua05ZPua5D9FG",Fc="RuZBN01h_ndf_5HWz8PD",Uc="KLD8LzZlxKsRrqV4j2EP",Pc=(0,Vr.mc)((({track:e,position:t})=>{const{spec:i,logger:a}=(0,et.r)(lc.i,{data:{position:t,uri:e.uri,reason:""}}),s=(e,t)=>()=>{const n=i.artistLinkFactory({position:t,uri:e}).hitUiNavigate({destination:e});a.logInteraction(n)},r=(0,n.useCallback)((t=>{const n=i.heartButtonFactory().hitLike({itemToBeLiked:e.uri}),s=i.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});a.logInteraction(t?n:s)}),[i,a,e.uri]),o=e.artists?e.artists.items.map(((e,t,i)=>(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(ca.h,{menu:(0,y.jsx)(uc.t,{uri:e.uri}),children:(0,y.jsx)(rt.N,{to:e.uri,onClick:s(e.uri,t),children:(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:e.profile.name})})}),t<i.length-1&&U.Ru.getSeparator()]},t))):"",{badges:c,hasBadges:u}=(0,Ec.b)({isExplicit:e.contentRating?.label===Nc.x7.Explicit,isMOGEFRestricted:e.contentRating?.label===Nc.x7.NineteenPlus}),d=(0,y.jsx)(oa.j,{dir:"auto",children:(0,y.jsxs)(l.E,{semanticColor:"textSubdued",variant:"bodySmall",className:Bc,children:[u&&(0,y.jsxs)("span",{className:Oc,children:[c.explicit&&(0,y.jsx)(Sc.U,{}),c.nineteen&&(0,y.jsx)(Cc.q,{size:16,className:_c})]}),(0,y.jsx)("span",{className:Fc,children:o})]})}),p=(0,y.jsx)(cc.b,{onClick:r,uri:e.uri,size:oc.t.sm,className:Dc});return(0,y.jsx)("div",{className:Tc,children:(0,y.jsx)(ca.h,{menu:(0,y.jsx)(dc.P,{uri:e.uri}),children:(0,y.jsx)(pc.k,{id:e.uri,media:(0,y.jsx)(yc,{type:Ul.c.TRACK,size:wc.Qe.SIZE_48,images:e.albumOfTrack?.coverArt?.sources??[],breakpoint:jc.e.SMALL,name:"",loadingMode:"lazy"}),subtitle:d,trailing:p,title:(0,y.jsx)(fc.U,{lineClamp:1,children:e.name}),size:"lg",hoverBackgroundColor:"backgroundHighlight",className:Uc,breakpoint:jc.e.SMALL})})})}),{name:"RelatedAudioTracksChild"}),Mc=(0,Vr.mc)((({data:e,item:t,position:i=0,fullBleedGap:n=0,carouselCardWidth:a=280})=>{const{spec:s,logger:r}=(0,et.r)(sc.f,{data:{identifier:"related-audio-tracks",position:i,uri:t.uri}}),l=(0,ja.t)(s),o=(0,ke.v)("In this video");if(!t.uri||"Artist"!==e?.artistUnion.__typename||0===e.artistUnion.discography?.topTracks?.items.length)return null;const c=e.artistUnion.discography.topTracks.items;return(0,y.jsx)(eo.w,{ref:l,className:Ic,style:{"--full-bleed-gap":`${n}px`,"--carousel-shelf-element-width":`${a}px`},children:(0,y.jsxs)(Na.r,{spec:s,children:[(0,y.jsx)(eo.X,{className:d()(kc),children:o}),(0,y.jsx)(rc.FN,{chevronsClassName:Rc,scrollContentClassName:d()(Ac),scrollerClassName:d()(Lc),scrollingMethod:rc.Hv.SNAP,scrollSnapAlign:"start",wheelScrollEnabled:!1,dragToScrollOptions:{isDisabled:!1},showButtons:rc.C_.ON_HOVER,scrollSnapByItems:1,onNavigationClick:()=>r.logInteraction(s.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsPreviousFactory().hitUiReveal()),edgeGradients:rc.TB.NONE,children:c.map((({track:e},t)=>(0,y.jsx)(Pc,{track:e,position:t},e.uri)))})]})})}),{name:"RelatedAudioTracks"});var Hc=i(90397),Vc=i(69519);const zc=({item:e,spec:t})=>{const i=(0,s.NC)(nl.LX5),n=(0,s.NC)(nl.RsN),{loading:a,error:r,data:l}=(0,Vc.i)(e),o=(0,s.NC)(nl.L$q),c=io(e);if(a&&e.uri&&!r)return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(mo,{}),(0,y.jsx)(mo,{}),(0,y.jsx)(mo,{})]});if(!e.uri||"Artist"!==l?.artistUnion.__typename||"Track"!==l?.trackUnion.__typename||a||r)return null;const{profile:u,stats:d,visuals:p,profile:{externalLinks:m}}=l.artistUnion,{credits:g}=l.trackUnion,v=o!==nl.vkU.CONTROL;return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(Na.r,{spec:t,children:[v&&(0,y.jsx)(ic,{item:e}),i&&(0,y.jsx)(Hc.a,{data:l,item:e}),n&&(0,y.jsx)(Mc,{data:l,item:e,position:1+Number(v)+Number(i)}),(0,y.jsx)(Co.F,{artistUri:l.artistUnion.uri,artist:u,stats:d,visuals:p,externalLinks:m.items}),g&&(0,y.jsx)(No.V,{data:g,trackUri:e.uri}),(0,y.jsx)(ac.I,{artistId:l.artistUnion.id,data:l.artistUnion.goods.concerts}),(0,y.jsx)(nc.J,{artistId:l.artistUnion.id,artistUri:l.artistUnion.uri,merch:l.trackUnion.merch.items}),c&&(0,y.jsx)(ao,{item:e})]})})},qc=({item:e,spec:t})=>(0,Tt.n)()&&e.artists[0].uri?(0,y.jsx)(zc,{item:e,spec:t}):(0,y.jsx)(y.Fragment,{});var Yc=i(63365),Gc=i(55),Qc=i(37639);const Zc=({item:e,spec:t})=>(0,tl.v)(e)&&!e.isLocal?(0,y.jsx)(qc,{item:e,spec:t}):(0,tl.v)(e)&&e.isLocal?(0,y.jsx)(wo,{}):(0,Qc.p)(e)?(0,y.jsx)(So,{item:e,spec:t}):(0,Gc.d)(e)?(0,y.jsx)(Nl,{item:e}):(0,Yc.N)(e)?(0,y.jsx)(pl,{}):null;var Kc=i(12148),Wc=i(44891),Jc=i(42435),Xc=i(44529),$c=i(93105);const eu="Ez4qKWmsDLh3iWdsnhKb",tu="ekcURLG5sTWx5S7E_Ul_",iu="_ChTSMj9kopaozdg25FG",nu=(0,n.forwardRef)((({spec:e,logger:t},i)=>{const a=(0,zi.mv)(),s=a.operatingSystem===$c.f.macOS?(0,Pi.b)("images/download-page-image-mac.png"):(0,Pi.b)("images/download-page-image.png");const{downloadUrl:r}=(0,Xc.z)(),o=(0,n.useCallback)((()=>{t.logInteraction(e.buttonDownloadFactory().hitNavigateToExternalUri({destination:r})),window.open(r,"_blank")}),[r,t,e]);return(0,y.jsxs)("div",{className:eu,ref:i,children:[(0,y.jsx)("div",{className:tu,style:{"--background-image":`url(${s})`}}),(0,y.jsxs)("div",{className:iu,children:[(0,y.jsx)(l.E,{variant:"titleMedium",semanticColor:"textBase",children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.title",{device:(0,Jc.e)(a.operatingSystem)})}),(0,y.jsx)(l.E,{variant:"bodyMedium",semanticColor:"textSubdued",children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.subtitle")}),(0,y.jsx)(c.$,{size:"medium",colorSet:"brightAccent",onClick:o,style:{alignSelf:"flex-start"},"aria-label":U.Ru.get("web-player.now-playing-view.web2desktop-funnel.button"),children:U.Ru.get("web-player.now-playing-view.web2desktop-funnel.button")})]})]})})),au="Yl2wNWzQgsRb49UB30No",su="Ko2eaQC7YRLTy1QsIY4Q";function ru(){const e=(0,Wc.K)(),{spec:t,logger:i}=(0,et.r)(Kc.l,{}),a=(0,ja.t)(t),s=(0,n.useCallback)((()=>{i.logInteraction(t.buttonSearchFactory().hitFocusInputField()),document.querySelector("[data-top-bar-search]")?.focus()}),[i,t]);return e?(0,y.jsx)(nu,{spec:t,ref:a,logger:i}):(0,y.jsxs)("div",{className:au,ref:a,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",className:su,children:U.Ru.get("queue.fine-something")}),(0,y.jsx)(c.$,{size:"small",colorSet:"brightAccent",onClick:s,children:U.Ru.get("web-player.now-playing-view.empty-state-cta")})]})}var lu=i(90263),ou=i(8335),cu=i(11440),uu=i(53115),du=i(30275),pu=i(63673),mu=i(45315),gu=i(17998);const vu="KHaAkbA62j5I7pcLsDAx",xu="Zaorh8_jZ8Vlyn3v2N3B",bu="jKvr1cqkZZXpH5z92z9b",hu="peN_VMHSmvTVUx9rneyY",yu=({context:e,item:t,index:i,isVisible:n})=>{const{spec:a,logger:s}=(0,et.r)(Yr.J,{}),{draggable:r,onDragStart:l}=(0,gu.P)(),{ref:o,inView:c}=(0,ou.Wx)({threshold:.5,initialInView:!0});return(0,y.jsx)("div",{className:d()(vu,{[xu]:n}),"data-testid":"minimized-track-visual-enhancement",children:(0,y.jsx)(ca.h,{menu:(0,y.jsx)(ul.W,{context:e,item:t}),children:(0,y.jsx)("div",{draggable:r&&(0,tl.v)(t),onDragStart:e=>{l(e,{itemUris:[t.uri],dragLabelText:(0,mu.r)(t)})},ref:o,children:(0,y.jsx)(pu.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,y.jsx)(du.e,{context:t.type===Ul.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{s.logInteraction(a.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===Ul.c.TRACK?t.album.uri:t.uri}))},adEventReason:cu.c.COVER_ART,children:(0,y.jsx)(uu.b,{className:d()(bu,{[hu]:c}),images:t.images??[],type:t.type,maxSize:56,desiredLabel:"small"})})})})})})};var fu=i(97547),ju=i(29012),Su=i(55524),wu=i(33775);const Cu="TkDZFBZ0IPbGaHDxeCci",Nu="bBG9E6mmFFC74pSkqU0o",Eu=({ad:e,backgroundColor:t,onClick:i})=>{const a=(0,wu.H)(e.clickthroughUrl),s=e.metadata?.buttonMessage||U.Ru.get("ad-formats.learnMore");return(0,y.jsx)(rt.N,{to:a,"data-testid":"ad-companion-card",onClick:i,className:Cu,children:(0,y.jsx)(Z.v,{style:{backgroundColor:t},className:Nu,onClickHint:U.Ru.get("ad-formats.learnMore"),variant:"tinted",horizontalGap:(0,Su.po)("looser"),id:e.adId,title:(0,y.jsx)(Ee.d,{variant:"bodySmallBold",children:e.metadata.advertiser||U.Ru.get("ad-formats.learnMore")}),trailing:(0,y.jsx)(n.Suspense,{fallback:(0,y.jsx)(sn.V,{}),children:e.metadata?.advertiser?(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"small",children:s}):(0,y.jsx)(sn.V,{"data-testid":"embedded-ad-cta-button-fallback",semanticColor:"textBase"})})})})};var Ru=i(49785);const ku="wibNcSZSkSmE1N7F0QbG",Iu="xIrPThBgWj2hMwWDOcVq",Lu=({onDismiss:e})=>(0,y.jsxs)("div",{className:Iu,children:[(0,y.jsx)(Ru.v,{colorSet:"overMedia",className:ku,children:(0,y.jsx)(l.E,{variant:"marginalBold",semanticColor:"textBase",children:U.Ru.get("ad-formats.advertisement")})}),(0,y.jsx)(c.$,{"aria-label":U.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:xr.M,onClick:e,size:"small"})]});var Au=i(74891),Tu=i(25688);const Du="YPTXM8u2OcJuJskm6uwv",Ou="QRqQ5S1T7WIBTZzJ6cAh",_u=({ad:e,onClick:t,onLoad:i,onError:n})=>{const a=e.display.reduce(((e,t)=>(t.url&&e.push({url:t.url,width:t.width,height:t.height}),e)),[]),s=(0,Au.h)(a??void 0,{desiredSize:384}),r=(0,Tu.m)({imageUriOrUrl:s});return(0,y.jsx)(rt.N,{to:e.clickthroughUrl,onClick:t,className:Du,"data-testid":"embedded-ad-creative-link",children:(0,y.jsx)(oi._,{loading:"eager",src:r,className:Ou,onLoad:i,onError:n})})};var Bu=i(17984);const Fu="XOqwMsxI9nljlJz4i3za",Uu=({ad:e})=>{const t=(0,F.wA)(),i=(0,n.useRef)(null),{adEventLogger:a,embeddedNPVAdEventLogger:r,embeddedAdErrorLogger:l}=(0,ju.CO)(),o=(0,n.useRef)(!1),c=(0,n.useRef)(!1),{context:u,item:d}=(0,Dt.o)((e=>e),dl.F)||{context:null,item:null},p=(0,n.useCallback)((()=>{a.log("dismissed",e),t((0,Gr.Xo)())}),[e,a,t]),m=(0,n.useCallback)((()=>{o.current||(a.log("viewed",e),r.log("start",e,{context_uri:u?.uri,track_uri:d?.uri}),o.current=!0)}),[e,a,u?.uri,r,d?.uri]),g=(0,n.useCallback)((()=>{a.log("errored",e,{event_reason:"creative load error"}),l.log("error",e,{error_message:"creative load error"}),t((0,Gr.Xo)())}),[e,a,t,l]),v=(0,n.useCallback)((()=>{a.log("clicked",e),r.log("click",e,{context_uri:u?.uri,track_uri:d?.uri}),t((0,Gr.Xo)())}),[e,a,r,u?.uri,d?.uri,t]),x=(0,s.NC)(nl.vDv),b=(0,Bu.z)(e.display[0]?.url,fu.CpN,"colorDark");return(0,n.useEffect)((()=>{const n=setTimeout((async()=>{if(i.current){const e=i.current.animate([{opacity:1,transform:"translateY(0)"},{opacity:0,transform:"translateY(-100%)"}],{duration:350,fill:"forwards",easing:"ease-out"});await e.finished,t((0,Gr.Xo)())}else t((0,Gr.Xo)())}),1e3*x);return()=>{t((0,Gr.Xo)()),c.current||(a.log("ended",e),r.log("end",e,{context_uri:u?.uri,track_uri:d?.uri}),c.current=!0),clearTimeout(n)}}),[e,a,u?.uri,t,r,d?.uri,x]),(0,y.jsxs)("div",{ref:i,className:Fu,"data-testid":"embedded-ad",children:[(0,y.jsx)(Lu,{onDismiss:p}),(0,y.jsx)(_u,{ad:e,onClick:v,onLoad:m,onError:g}),(0,y.jsx)(Eu,{ad:e,backgroundColor:b,onClick:v})]})};var Pu=i(45664),Mu=i(83325),Hu=i(55696);const Vu=(0,Vr.mc)((()=>{const e=(0,n.useContext)(at.s),t=(0,Hu.a)({tryAvoidGraphQLFetching:!1}),i=(0,s.NC)(nl.yJ8)===nl.NtL.CANVAS_PLAY_ON_HOVER;return t?.canvas&&e?(0,y.jsx)(Mu.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:i?Mu.RT.LoopOnHover:Mu.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var zu=i(63409),qu=i(27149),Yu=i(22148),Gu=i(45944),Qu=i(56526),Zu=i(64175),Ku=i(78544),Wu=i(87565),Ju=i(49873);const Xu="fIpDXK7M3W0Bn3FgLSRe",$u="T5_sYfKJ2efL3n3dFNuN",ed="bLX5l9C_iEfonbMKiFD_",td="sJHheSrjFUt_MAcNrUXQ",id="hhFdIYRyHsqlCHy7T_8A",nd="cIUedsmg_cTnTxvOYTKR",ad="aaFQbW0j0N40v_siz0kX",sd="O5NOY8Xw4NH0IhBZu8tm",rd="DFvRASpHOFAoziM4w7En",ld="zL6hQR4mukVUUQaa_7K1",od="ylBRlfNqGnzVa4kjUQGP",cd="E08D6ucrHuPJYzzGO7HG",ud="hjyiWzPtKHn_5kCe9vyg",dd="pUIBQ9cykHKYx2A2ZIPA",pd="_q9LkNJJIpxoOkOFI2Nd",md="S6W0kreMgaIXYWSEYHya",gd="hCImOEZCJwYaSy2r1Xgx",vd="GY_emVGtuRR8FWeKK9je",xd="hfdkySA4kiUldFsPj9lD",bd="eEiwEPDfVRD0HKjYM_dq",hd=({item:e,spec:t})=>{const i=(0,le.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,Qu.v)(e),r=(0,E.y)();return s?(0,y.jsx)(Gu.g,{uri:e.uri,size:r===N.E.MEDIUM?"medium":"small",className:id}):(0,tl.v)(e)&&!e.isLocal?(0,y.jsx)(cc.b,{uri:e.uri,size:r===N.E.MEDIUM?oc.t.sm:oc.t.xs,onClick:a,className:id}):(0,Qc.p)(e)?(0,y.jsx)(qu.b,{uri:e.uri,size:r===N.E.MEDIUM?oc.t.sm:oc.t.xs,onClick:a,className:id,condensed:!0}):null},yd=({context:e,item:t})=>{const{spec:i,logger:n}=(0,et.r)(Yr.J,{}),{spec:a}=(0,et.r)(zu.p6,{data:{identifier:zu.gw.DESKTOP}}),s=(0,Ju.X)(),r=(0,E.y)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Yu.w,{className:d()(rd,td),uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,Bn.gHQ)(t.uri)?U.Ru.get("context-menu.copy-episode-link"):U.Ru.get("context-menu.copy-track-link"),size:r===N.E.MEDIUM?"medium":"small"}),(0,y.jsx)(Zu.a,{context:e,item:t,className:d()(sd,$u),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),s&&(0,Wu.N)(t)?(0,y.jsx)(Na.r,{spec:i,children:(0,y.jsx)("div",{className:sd,children:(0,y.jsx)(Ku.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,y.jsx)("div",{className:sd,children:(0,y.jsx)(hd,{item:t,spec:i})})]})};var fd=i(44006),jd=i(91103),Sd=i(55416),wd=i(21902),Cd=i(35763),Nd=i(21709),Ed=i(87761);let Rd=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const kd=()=>{const e=(0,dl.L)(),t=(0,H.l)(),{videoPlayerMode:i}=(0,Nd.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,Cd.k)(),s=(0,F.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,Hu.a)({tryAvoidGraphQLFetching:!0});if(!e)return Rd.NONE;const{item:l}=e;return i===Ed.Kz.documentPip||i===Ed.Kz.pip?Rd.VIDEO_OVER_PIP_PLACEHOLDER:l?.type===Ul.c.AD&&s?.isMinimized&&"audio"!==l?.mediaType?Rd.NONE:l?.type!==Ul.c.EPISODE||"video"!==l?.mediaType&&"mixed"!==l?.mediaType?n&&a?t?Rd.VIDEO_OVER_CONNECT_PLACEHOLDER:Rd.NONE:r?Rd.CANVAS:Rd.COVER_ART:t?Rd.VIDEO_OVER_CONNECT_PLACEHOLDER:Rd.NONE};var Id=i(82718);const Ld=(0,Vr.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,dl.L)(),i=kd(),{draggable:a,onDragStart:r}=(0,gu.P)(),[l,o]=(0,n.useState)(!0),{spec:c,logger:u}=(0,et.r)(Yr.J,{}),{spec:p}=(0,et.r)(lu.E,{data:{uri:t?.item.uri??"",identifier:Ed.Kz.npv}}),{isSongVideo:m}=(0,Cd.k)(),g=i===Rd.CANVAS,v=i===Rd.COVER_ART,x=(0,F.d4)(Kr),b=((e,t)=>{const[i,a]=(0,n.useState)(!1),r=(0,n.useRef)(),l=(0,s.NC)(nl.Ym5,{loadingValue:!1}),o=(0,F.d4)(Wr),c=(0,F.d4)(Kr),u=(0,$r.$)(),d=il(t),p=(0,n.useMemo)((()=>Boolean(o&&l&&e)),[e,l,o]),m=(0,n.useCallback)((()=>{r.current&&(clearTimeout(r.current),r.current=null)}),[]);return(0,n.useEffect)((()=>{d&&(m(),a(!1))}),[d,m]),(0,n.useEffect)((()=>p&&c?(r.current=setTimeout((()=>{a(!0)}),2e3),m):(a(!1),()=>{})),[p,m,c,d]),(0,n.useMemo)((()=>Boolean(p&&c&&o&&i&&u)),[p,c,o,i,u])})(v,t?.item),h=(0,n.useRef)(null),f=(0,n.useRef)(null),j=(0,n.useRef)(null),S=!(0,Di.j)(),[w,C]=(0,n.useState)(null);if(S&&g&&h.current&&j.current&&(C(j.current),setTimeout((()=>{C(null)}),600)),h.current=v,f.current=g,j.current=t,null===t)return null;const{context:N,item:E,index:R}=t;return(0,y.jsx)("div",{className:d()(Xu),children:(0,y.jsxs)("div",{className:nd,children:[(0,y.jsxs)("div",{onClick:()=>g&&o(!l),className:d()(ld,{[ud]:g,[gd]:v,[dd]:l,[vd]:b}),children:[b&&x&&(0,y.jsx)(Uu,{ad:x}),(0,y.jsx)("div",{className:d()(od,{[pd]:g||b}),"aria-hidden":g||b,"data-testid":"track-visual-enhancement",children:(0,y.jsx)(fd.h,{context:w?.context||N,item:w?.item||E,index:R,canSwitchVisuals:!0,isMinimized:b})}),i===Rd.VIDEO_OVER_PIP_PLACEHOLDER&&(0,y.jsx)(Sd.k,{}),i===Rd.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,y.jsx)(wd.V,{}),(0,y.jsx)("div",{className:d()(cd,{[md]:!g}),"aria-hidden":"true",children:(0,y.jsx)(ca.h,{menu:(0,y.jsx)(ul.W,{context:N,item:E,canSwitchVisuals:!0}),children:(0,y.jsx)("div",{draggable:a,onDragStart:e=>{r(e,{itemUris:[E.uri],dragLabelText:(0,mu.r)(E)})},children:g&&(0,y.jsx)(Vu,{uri:E.uri})})})}),(0,y.jsx)(jd.F,{})]}),m&&(0,y.jsx)(Id.L,{className:g?bd:"",createImpressionSpec:e=>p.toggleAudioVideoButtonFactory({identifier:e?"switch_to_audio":"switch_to_video"}),onClick:e=>{u.logInteraction(p.toggleAudioVideoButtonFactory({identifier:e}).hitPlay({itemToBePlayed:E.uri}))}}),e?null:(0,y.jsxs)("div",{className:d()(ad,{[ed]:g}),children:[(0,y.jsx)(yu,{isVisible:b,context:N,item:E,index:R}),(0,y.jsx)(Fl.d,{className:d()(xd),context:N,item:E,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{u.logInteraction(c.titleFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{u.logInteraction(c.artistFactory({uri:E.uri}).hitUiNavigate({destination:e||""}))},referrer:Pu.G.NPV}),!(0,Yc.N)(E)&&(0,y.jsx)(yd,{context:N,item:E})]})]})})}),{name:"NPVHeader"});function Ad(){return(0,y.jsx)(Ld,{})}const Td=({className:e})=>{const t=(0,n.useRef)(null);(0,ee.X)("NPV_OPEN_CINEMA_MODE_BUTTON",t);const i=(0,Go.l)(),{spec:a,logger:s}=(0,et.r)(Yr.J,{}),r=(0,n.useCallback)((()=>{i(Vn.z.NOW_PLAYING_VIEW),s.logInteraction(a.expandNpvButtonFactory().hitUiReveal())}),[s,i,a]);return(0,y.jsx)(ua.Zp,{label:U.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,y.jsx)(me.H,{ref:t,iconOnly:Mo.L,size:"small",onClick:r,"aria-label":U.Ru.get("web-player.now-playing-view.cinema-mode.expand"),className:e})})};var Dd=i(9994),Od=i(62795),_d=i(18264);const Bd={context:null,item:null};var Fd=i(96932),Ud=i(35270),Pd=i(61502),Md=i(743),Hd=i(25219),Vd=i(35827),zd=i(4945),qd=i(88174);const Yd="yvZooOj0rpfRS__cAUCo",Gd="k_ndsg7yz9ZAgEmei1n3",Qd="vDev2BqBHloweL24GNHK",Zd="IkRGajTjItEFQkRMeH6v",Kd="f2UE9n5nZcbgZrGYTU3r",Wd="nw2W4ZMdICuBo08Tzxg9",Jd="wPHL366l99aluPsMU8Bl",Xd="UAg2mNxhAm_jv0zFjG8z",$d="VjVlpyxDo941sgO2Vc8g";function ep(e){return(0,tl.v)(e)||(0,zd.v)(e)||(0,Qc.p)(e)||(0,Gc.d)(e)?e.name:(0,Yc.N)(e)?"":(0,Rn.d)(e)}const tp=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,R.x)({[N.E.XSMALL]:0,[N.E.SMALL]:280,[N.E.MEDIUM]:320});return(0,y.jsx)("div",{className:Wd,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,y.jsxs)(E.o.Provider,{value:n,children:[(0,y.jsx)(Ld,{}),(0,y.jsx)(Zc,{item:e,spec:t}),!(0,Qc.p)(e)&&(0,y.jsx)(so.A,{})]})})})),ip=({context:e,item:t,spec:i})=>{const a=(0,Md.SF)();return(0,n.useEffect)((()=>{a.current&&(a.current.scrollTop=0)}),[t?.uri,a]),(0,Ud.bJ)(e,t)?(0,y.jsx)(Fd.IT,{spec:i}):(0,y.jsx)(tp,{context:e,item:t,spec:i})},np=({context:e,item:t,spec:i})=>{const n=(0,zn.S)();return al(),n===Vn.z.NOW_PLAYING_VIEW?null:(0,y.jsx)(ip,{context:e,item:t,spec:i})},ap=()=>kd()===Rd.CANVAS,sp=({item:e})=>{const t=(0,n.useRef)(null),i=(0,dl.L)(),{title:a,link:r}=(0,Pd.$)(),l=ap(),o=(0,s.NC)(nl.mzn),{spec:c,logger:u}=(0,et.r)(Yr.J,{}),p=(0,n.useCallback)((()=>{const e=c.closeButtonFactory().hitUiHide();u.logInteraction(e)}),[c,u]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus({preventScroll:!0})}),[]),(0,y.jsx)(C.a,{title:a,titleSlot:(0,y.jsx)(C.k,{title:a,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:Gd,hasNPVCloseButton:o}),link:r,actions:i&&i.context&&(0,y.jsxs)("div",{className:o?Xd:$d,children:[(0,y.jsx)(pa.b,{menu:(0,y.jsx)(ul.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,y.jsx)(cl.e,{size:"small",condensed:!1,label:U.Ru.get("more.label.context",e?ep(e):""),onClick:()=>{u.logInteraction(c.contextMenuButtonFactory().hitUiReveal())},className:Jd})}),o&&(0,y.jsx)(Td,{className:Jd})]}),panelLinkRef:t,panel:v.Z.NowPlayingView,onClose:p,item:e,className:d()({[Yd]:l})})},rp=({item:e})=>{const t=!!e&&(0,Yc.N)(e);return(0,n.useMemo)((()=>t?null:(0,y.jsx)(sp,{item:e})),[e,t])},lp=(0,Vr.mc)((({nodeRef:e})=>{const t=!(0,Tt.n)(),{context:i,item:n,index:a}=(0,Dt.o)((e=>e),dl.F)||{context:null,item:null,index:null},{spec:r,UBIFragment:l}=(0,et.r)(qr.t,{data:{uri:n?n.uri:""}}),o=ap(),c=!!n&&(0,Yc.N)(n),u=(0,ja.t)(r),p=(()=>{const{item:e,context:t}=(0,dl.L)()||Bd,{isYourDJNarrator:i,hasYourDJMetadata:n}=(0,Od.C)(),a=(0,s.NC)(nl.yon),r=(0,Bu.z)(e?.images?.[0]?.url,fu.l0o,"colorDark");return i&&n?(0,_d.p)(t?.metadata?.["narration.background.color"],Dd.lZ):a?r:void 0})(),m={"--background-base":p};let g=null;g=(0,qd.O)(i)&&null!==n?t?(0,y.jsx)(Ad,{}):c?(0,y.jsx)(ol,{item:n,context:i,index:a}):(0,y.jsx)(np,{spec:r,context:i,item:n}):(0,y.jsx)(ru,{});const v={cssStyles:{"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)","--section-padding":zr.spacer16,"--section-border-radius":zr.spacer8},headerVariant:"bodyMediumBold"};return(0,y.jsx)(Vd.P,{surface:Hd.u.NOW_PLAYING,children:(0,y.jsx)(Md.ql.Provider,{value:"now_playing_panel",children:(0,y.jsx)(oo.Tn,{...v,children:(0,y.jsx)(at._,{nodeRef:e,label:U.Ru.get("web-player.now-playing-view.label"),style:{...m,...v.cssStyles},itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,y.jsx)(l,{spec:r,children:(0,y.jsx)(w.w,{className:d()(Zd,{[Kd]:void 0!==p}),fixedHeader:(0,y.jsx)(rp,{item:n}),scrolledClassName:o?Qd:void 0,ref:u,children:g})})})})})})}),{name:"NPV"}),op="vzeIlCPBQJUaqdMZHqHE",cp="iZgGvu9g2gDlQ1ofJ7rH",up="FSZKuoSTDgGwCPXO_qel",dp="cPpNQwPTiEn9Zegl5Dwz",pp="p2Yw6bT_O5PW8yGv1R0X",mp="pK7G3_mtRcuFjbhJzm1s",gp="gVJxtuXo8lHAw8XLKHfQ",vp="BR3H6wavkReGa2xeSeaV",xp="vXYSi4u1nPutJ_ZkC6mq",bp=e=>{const t=(0,n.useRef)(null);return(0,y.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?cp:mp,enterActive:e.shouldPlayAnimation?up:gp,exit:e.shouldPlayAnimation?dp:vp,exitActive:e.shouldPlayAnimation?pp:gp},unmountOnExit:!0,mountOnEnter:!0,children:(0,y.jsx)("div",{className:op,children:(0,y.jsx)("div",{className:xp,ref:t,children:e.children})})})};var hp=i(21127),yp=i(83821),fp=i(78692),jp=i(88477),Sp=i(9835),wp=i(40119),Cp=i(59054),Np=i(24292),Ep=i(99969),Rp=i(32961),kp=i(44626);const Ip="PddBvUOS0_6f9B21fVGF",Lp=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,Ep.g)(r);const l=(0,Rp.d)(t);return(0,y.jsx)(Np.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:Ip,ref:r,onKeyDown:l,children:s})},Ap=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,y.jsx)(kp.k,{resolveItem:Tp,getItems:a,nrTracks:e.length,children:(0,y.jsx)(Lp,{nrItems:e.length,...i,children:e.map(t)})})};function Tp(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var Dp=i(82223),Op=i(59641),_p=i(21388),Bp=i(45804),Fp=i(55407),Up=i(9562),Pp=i(61981);const Mp=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:l,images:o,book:c}=e,u=(0,Dp.E)(e,t),d=(0,Pp.Y)(n.section),p=(0,y.jsx)(Bp.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),m=(0,y.jsx)(Up.n,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,y.jsx)(ca.h,{menu:(0,y.jsx)(_p.p,{uri:c.uri}),children:(0,y.jsx)(rt.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,y.jsx)(Fp.b,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:l,subtitle:m,images:o,dragLabel:l,menu:p,moreButtonLabelName:l,ariaPauseLabel:U.Ru.get("playlist.a11y.pause",l),ariaPlayLabel:U.Ru.get("playlist.a11y.play",l),...n})};var Hp=i(53207),Vp=i(82797),zp=i(20535),qp=i(47331),Yp=i(30951),Gp=i(85388),Qp=i(23831),Zp=i(1072),Kp=i(18463);const Wp=(0,n.createContext)(null),Jp=({children:e})=>{const{uri:t}=(0,Kp.H)(),{spec:i,UBIFragment:a}=(0,et.r)(Qp.i,{data:{identifier:Zp.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),l=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),o=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l})),[i,s,r,l]);return(0,y.jsx)(Wp.Provider,{value:o,children:(0,y.jsx)(a,{spec:i,children:e})})};var Xp=i(26429);const $p=()=>{const e=(0,n.useContext)(Wp);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=(0,Kp.H)(),i=(0,le.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:l}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case Yp.$.NowPlaying:n=s;break;case Yp.$.NextInQueue:n=r;break;case Yp.$.NextUp:n=l;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,l,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case Yp.$.NextInQueue:t=r;break;case Yp.$.NextUp:t=l;break;case Yp.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,l,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==Xp.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===Xp.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=l.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,l])}};var em=i(65753),tm=i(52094);const im=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,x.z)(),{request:a}=(0,n.useContext)(tm.j),{logAddToQueue:s,logSort:r}=$p();return(0,n.useCallback)((async(n,l,o)=>{const{contextUri:c,sectionId:u,itemIds:d}=o??{},p=t===Yp.$.NowPlaying,m=Gp.v===c&&!p,g=n[zp.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,em.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=m&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const b=m&&u===Yp.$.NowPlaying;let h;if(h=l===qp.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},m&&!b)t&&r(t),i.reorderQueue(x,h);else{let e;t&&(e=s(t,v)),p?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,h,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case Ul.c.TRACK:return(0,y.jsx)(Vp.e,{track:e,onDrop:i,...t});case Ul.c.EPISODE:return(0,y.jsx)(Hp.I,{episode:e,onDrop:i,...t});case Ul.c.CHAPTER:return(0,y.jsx)(Mp,{chapter:e,onDrop:i,...t});case Ul.c.AD:return(0,y.jsx)(Op.Y,{ad:e,onDrop:i,...t});case Ul.c.UNKNOWN:return null;default:return(0,Rn.k)(e),null}}));var nm=i(24848);const am=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,nm.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,y.jsx)(im,{item:e,...t,usePlayContextItem:i})})),sm=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,y.jsx)(am,{item:e,index:t},(0,Dp.E)(e,t))),[]);return(0,y.jsx)(Ap,{items:e,ariaLabel:U.Ru.get("view.recently-played"),renderRow:t,columnCount:Gp.$})};var rm=i(49943),lm=i(1148);const om=()=>{const{isLoading:e,data:t}=(0,lm.a)();return e?null:t?.items.length?(0,y.jsx)(sm,{items:t.items}):(0,y.jsx)(rm.H,{})};var cm=i(68832);const um=(e,t)=>!t?.didQueueChangeSignificantly,dm=(e,t,i)=>{um(0,i?.current)?(0,cm.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},pm=(e,t,i,n)=>{um(0,n?.current)?(0,cm.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},mm=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var gm=i(8741);function vm(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=bm(t.current,i),a=bm(e,i),s=(0,gm.I)(n,a),r=s>16||s>=Math.max(xm(e),xm(t.current));return t.current=e,r}),[e])}function xm(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function bm({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}var hm=i(88251);const ym=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(hm.P).map(Dp.E).join("")),[e,i,t]),r={didQueueChangeSignificantly:vm({current:e,nextUp:i,queued:t})};return(0,y.jsx)(cm.ZI,{flipKey:s,handleEnterUpdateDelete:mm,decisionData:r,children:a})},fm=({children:e,...t})=>(0,Di.j)()?(0,y.jsx)(y.Fragment,{children:e}):(0,y.jsx)(ym,{...t,children:e}),jm=({children:e,...t})=>(0,Di.j)()?(0,y.jsx)(y.Fragment,{children:e}):(0,y.jsx)(cm.lf,{shouldFlip:um,...t,children:e});var Sm=i(70813),wm=i(97906);const Cm=[zp.fl.TRACKS,zp.fl.LOCAL_TRACKS,zp.fl.EPISODES,zp.fl.CHAPTERS,zp.fl.ALBUMS],Nm=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const l=(0,x.z)(),o=(0,n.useCallback)((e=>{l.removeFromQueue(e)}),[l]),{usePlayContextItem:c}=(0,Sm.b)(e,a),u=(0,n.useCallback)(((e,t)=>{const i=(0,Dp.E)(e,t);return(0,y.jsx)(jm,{flipId:e.metadata?.original_uid??i,onAppear:dm,onExit:pm,translate:!0,children:(0,y.jsx)("div",{className:wm.A.listRowWrapper,children:(0,y.jsx)(im,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:Cm,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,y.jsx)(Ap,{items:t,renderRow:u,columnCount:Gp.$,ariaLabel:i,onRemoveItems:o})};var Em=i(11473);const Rm="u842BXnznGeq38O3DUTQ",km="NWVZ_rxlezZ8xTHlMg4Y",Im="Oae51evvT5DrqTupCiZ2",Lm="LFdMliaHVgrpBcqNKHU3",Am="IeeqYq0Ozrndd6STmrRk",Tm="NljerwmGshDHsI7rIvWl",Dm=({nrQueuedItems:e})=>{const t=(0,x.z)(),{logClearQueue:i}=$p(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),l=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),o=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(me.H,{size:"small",onClick:o,className:Am,condensed:!0,children:U.Ru.get("queue.clear-queue")}),(0,y.jsx)(Em.p,{itemCount:e,isOpen:a,onClose:r,onConfirm:l})]})};var Om=i(49246);const _m=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,Om.K)({ref:a});return(0,y.jsx)(jm,{flipId:`section-header-${e}`,onAppear:dm,onExit:pm,translate:!0,children:(0,y.jsxs)("div",{className:Lm,children:[(0,y.jsx)(ua.Zp,{label:t,disabled:!s,children:(0,y.jsx)(l.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:Tm,ref:a,children:t})}),i]})})};var Bm=i(81807),Fm=i(5820),Um=i(33031);const Pm=new Fm.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function Mm(e){const{currentSession:t}=(0,Ks.D)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(hm.P))).sort().map((e=>(0,Bn.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Za.rX},(0,Um.I)(Pm,s,r));var s,r;const l=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:Ul.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(hm.P)??[])),[a]);return t?.active?l:{}}var Hm=i(31354),Vm=i(62275);const zm=()=>{const e=(0,Kp.H)(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:l,hasQueuedTracks:o,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=$p(),d=Mm([a,...s,...r]),p=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(hm.P).map((({type:e})=>e))).size>1),[a,s,r]),{currentSession:m}=(0,Ks.D)(),g=(0,Qs.y)();return l?(0,y.jsx)(Bm.K,{}):(0,y.jsxs)(fm,{...e,children:[(0,y.jsx)(Hm.Z,{className:Im}),(0,y.jsxs)("div",{className:Rm,children:[a&&(0,y.jsxs)("div",{className:km,children:[(0,y.jsx)(_m,{queueSection:Yp.$.NowPlaying,title:U.Ru.get("queue.now-playing")}),(0,y.jsx)(Nm,{ariaLabel:U.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:Yp.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),!m?.active&&g&&(0,y.jsx)(Vm.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),o&&(0,y.jsxs)("div",{className:km,children:[(0,y.jsx)(_m,{queueSection:Yp.$.NextInQueue,title:U.Ru.get("queue.next-in-queue"),trailingButton:(0,y.jsx)(Dm,{nrQueuedItems:r.length})}),(0,y.jsx)(Nm,{ariaLabel:U.Ru.get("queue.next-in-queue"),uri:t,items:r,section:Yp.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),c&&(0,y.jsxs)("div",{className:km,children:[(0,y.jsx)(_m,{queueSection:Yp.$.NextUp,title:i&&!(0,Kp.K)(a)&&t?(0,y.jsxs)(y.Fragment,{children:[U.Ru.get("queue.next-from")," ",(0,y.jsx)(rt.N,{to:t,onClick:()=>{u(t)},children:i})]}):U.Ru.get("queue.next-up")},i),(0,y.jsx)(Nm,{ariaLabel:U.Ru.get("queue.next-up"),uri:t,items:s,section:Yp.$.NextUp,showTypeLabel:p})]})]})]})};var qm=i(24224),Ym=i(43453),Gm=i(82221),Qm=i(11937);const Zm="AjjTyUrCO3pZ365KtTXW",Km="pGtUoenc5OobLi8CscJ6",Wm="cArVcLcQ85q_9QSLGYGX",Jm="lDtXv1VCrs0PHHSuH5uO",Xm="ukjUoaLSzKyRcwoOQw9V",$m="yQwBNeetmAr0a0OTR8t3",eg="fzB4RXxTp0rlpNQlSuu9",tg=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,Ks.D)(),{displayName:r,images:l,username:o,uri:c}=(0,Qm.c)(e);return(0,y.jsx)(ca.h,{menu:(0,y.jsx)(Gm.B,{uri:c}),children:(0,y.jsx)(Z.v,{id:`${a}`,variant:"naked",className:Xm,title:(0,y.jsx)(Ee.d,{lineClamp:1,children:r}),media:(0,y.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,y.jsx)(Ym.e,{images:l,userIconSize:"medium",width:48,displayName:r,username:o,label:r})}),subtitle:s?.sessionOwnerId===e.id?U.Ru.get("web-player.social-connect.participant-list.host"):U.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,y.jsx)(pe.n,{size:"small",className:$m,onClick:n,"aria-label":U.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:U.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var ig=i(17407),ng=i(97235),ag=i(37066);const sg=()=>{const e=(0,Wa.d)(),t=(0,F.wA)(),i=(0,De.g)(),a=(0,ig.Z)(),{currentSession:s,kickAllParticipants:r}=(0,Ks.D)(),{setQueueView:o}=(0,qm.m)(),{logUserClick:u,logRemoveClick:d}=(0,ng.T)(),p=(0,n.useCallback)((()=>{s?.joinSessionShortLink&&a(s?.joinSessionShortLink)}),[a,s?.joinSessionShortLink]),m=(0,n.useCallback)(((e,i)=>{d(e),t((0,aa.A9)(Ga.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,d]),g=(0,n.useCallback)(((e,t)=>{const n=(0,Bn.Qjr)(t.username);u(e,n.toURI()),i(n.toURLPath(!0))}),[u,i]),v=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),x=(0,ag.T4)(e);return s&&x?(0,y.jsxs)("div",{className:Zm,children:[(0,y.jsx)(l.E,{variant:"titleSmall",semanticColor:"textBase",children:U.Ru.get("web-player.social-connect.participant-list.title")}),(0,y.jsxs)("div",{className:Km,children:[(0,y.jsx)(l.E,{variant:"bodySmall",semanticColor:"textSubdued",children:U.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,y.jsx)(pe.n,{size:"small",onClick:p,className:Wm,children:U.Ru.get("web-player.social-connect.invite-button")})]}),(0,y.jsx)("div",{className:Jm,children:s.sessionMembers.map(((t,i)=>(0,y.jsx)(tg,{index:i,sessionMember:t,showRemoveButton:(0,ag.kt)(e,(0,Bn.Qjr)(t.username).toURI()),onClickRemove:()=>m(i,t),onClickMember:()=>g(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,y.jsx)(c.$,{colorSet:"invertedLight",size:"small",onClick:v,children:U.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,y.jsx)(l.E,{variant:"marginal",semanticColor:"textSubdued",className:eg,children:U.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(qm.p.QUEUE),null)};var rg=i(16491);const lg="BZj_r1yzmmragvivUCrw",og="hpzTKCoO0rllEslIOMPo",cg="TeBVsFnI9PMHYL9ynJx9",ug="ZDR7q1cqU2yaYjemuy9Z",dg="OLB2ghxc09Kz8k_93eIu",pg=()=>{const{currentQueueView:e,setQueueView:t}=(0,Xp.m)(),i=(0,rg.y)(),{logQueuePanelTabChange:a}=$p(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==Xp.p.PARTICIPANT_LIST?(0,y.jsx)(jp.t,{currentTab:e,onTabChange:e=>{e===(0,wp.c)(Xp.p.HISTORY)?(a(Xp.p.HISTORY),t(Xp.p.HISTORY)):(a(Xp.p.QUEUE),t(Xp.p.QUEUE))},className:cg,children:(0,y.jsxs)(Sp.w,{"aria-label":"",className:ug,children:[(0,y.jsx)(wp.V,{"aria-selected":e===Xp.p.QUEUE,label:U.Ru.get("playback-control.queue"),value:Xp.p.QUEUE}),(0,y.jsx)(wp.V,{"aria-selected":e===Xp.p.HISTORY,label:U.Ru.get("view.recently-played"),value:Xp.p.HISTORY})]})}):(0,y.jsx)(me.H,{iconLeading:Ts.g,onClick:()=>t(Xp.p.QUEUE),size:"small",condensed:!0,className:dg,children:U.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:U.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,y.jsx)(at._,{label:U.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,y.jsx)(w.w,{fixedHeader:(0,y.jsx)(C.a,{className:lg,panel:v.Z.Queue,...s}),children:(0,y.jsx)("div",{className:og,children:e!==Xp.p.PARTICIPANT_LIST?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Cp.K,{value:"queue",children:e===Xp.p.QUEUE&&(0,y.jsx)(zm,{})}),(0,y.jsx)(Cp.K,{value:"history",children:e===Xp.p.HISTORY&&(0,y.jsx)(om,{})})]}):(0,y.jsx)(sg,{})})})})},mg=(0,n.memo)((function(){return(0,y.jsx)(Jp,{children:(0,y.jsx)(pg,{})})}));var gg=i(8465),vg=i(96944);const xg=(0,n.memo)((()=>{const e=(0,s.NC)(nl.ZDY),t=(0,yp.X)(),i=(0,hp._)(),l=function(){const e=(0,n.useRef)(v.Z.NowPlayingView),t=(0,g.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===v.Z.NowPlayingView,a=t===v.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),o=(0,zn.S)()===Vn.z.NOW_PLAYING_VIEW,c=(0,n.useRef)(null),u=e&&t===v.Z.Disabled;return(0,y.jsxs)(r.s,{onError:e=>{(0,gg.Jy)(e,"PanelSection"),i((0,fp.MQ)(v.Z.Disabled))},children:[(0,y.jsx)(a.A,{nodeRef:c,in:t===v.Z.NowPlayingView||u,exit:v.v.includes(t),timeout:{enter:0,exit:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,y.jsx)(vg.f,{enabled:!u,children:(0,y.jsx)(lp,{nodeRef:c})})}),t===v.Z.BuddyFeed?(0,y.jsx)(Hn,{}):null,(0,y.jsx)(bp,{isActive:t===v.Z.BuddyFeedOverlay,shouldPlayAnimation:!o&&l([v.Z.BuddyFeedOverlay]),children:(0,y.jsx)(Hn,{})}),t===v.Z.Queue?(0,y.jsx)(mg,{}):null,(0,y.jsx)(bp,{isActive:t===v.Z.QueueOverlay,shouldPlayAnimation:!o&&l([v.Z.QueueOverlay]),children:(0,y.jsx)(mg,{})}),t===v.Z.Puffin||t===v.Z.PuffinActivation?(0,y.jsx)(Ln,{}):null,(0,y.jsx)(bp,{isActive:t===v.Z.PuffinActivationOverlay||t===v.Z.PuffinOverlay,shouldPlayAnimation:!o&&l([v.Z.PuffinActivationOverlay,v.Z.PuffinOverlay]),children:(0,y.jsx)(Ln,{})}),t===v.Z.DevicePicker?(0,y.jsx)(Mr,{}):null,(0,y.jsx)(bp,{isActive:t===v.Z.DevicePickerOverlay,shouldPlayAnimation:!o&&l([v.Z.DevicePickerOverlay]),children:(0,y.jsx)(Mr,{})}),Hr?(0,y.jsxs)(y.Fragment,{children:[t===v.Z.Euterpe?(0,y.jsx)(Hr,{}):null,(0,y.jsx)(bp,{isActive:t===v.Z.Euterpe,shouldPlayAnimation:l([v.Z.Euterpe]),children:(0,y.jsx)(Hr,{})})]}):null]})}))},71076:(e,t,i)=>{i.d(t,{J:()=>n.J});var n=i(15113)},71516:(e,t,i)=>{i.d(t,{$:()=>p});var n=i(30758),a=i(62411),s=i(88019),r=i(35994),l=i(79252),o=i(66105),c=i(94224),u=i(57160),d=i(86070);const p=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),p=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,o.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:p,children:l.Ru.get("web-player.social-connect.menu-action.title")})}},81126:(e,t,i)=>{i.d(t,{o:()=>s});var n=i(29835),a=i(53507);function s(){return(0,a.N)(n.g)}},83223:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(53507),a=i(53742);function s(){return(0,n.N)(a.Z)}},88975:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(78620),a=i(53507);function s(){return(0,a.N)(n.x)}},91103:(e,t,i)=>{i.d(t,{F:()=>d});var n=i(30758),a=i(53177),s=i(64232),r=i(39736),l=i(21709),o=i(87761);const c="KrBYgWLGb5aRHjoD_prX";var u=i(86070);const d=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,l.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(t===r.Z.NowPlayingView&&e(o.nP.npv,!0),()=>{e(o.nP.npv,!1)})),[t,e]),(0,u.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:c})}),{name:"NPVVideoContainer"})},94875:(e,t,i)=>{i.d(t,{a:()=>V,k:()=>M});var n=i(30758),a=i(97500),s=i.n(a),r=i(44004),l=i(88639),o=i(94960),c=i(66973),u=i(33100),d=i(46232),p=i(45005),m=i(79252),g=i(70773),v=i(47290),x=i(62398),b=i(86871),h=i(58206),y=i(95941),f=i(19315),j=i(64232),S=i(66108),w=i(39736),C=i(17998),N=i(17145),E=i(63365),R=i(3161);const k="eTT681T6oUKXsIMiP8pT",I="gwmgu53xszgwAXxqLT0h",L="fNXmHtlrj4UVWmhQrJ_5",A="XOSSUjLDKk9RRmiX_UWa",T="KILnOHUdx4pspVEoJ7kq",D="XNFZdOLgMlx491fEWdYJ",O="icNf66tgG3uxDMbCCIaN",_="NmIQ4hxBcXT8Bd7Abwdi",B="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var U=i(86070);const P=({title:e,variant:t,semanticColor:i})=>(0,U.jsx)(y.z,{title:e,children:(0,U.jsx)(r.E,{as:"h1",dir:"auto",variant:t,semanticColor:i,children:e||""})},e||""),M=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:l,hasNPVCloseButton:o})=>{const{spec:c,logger:u}=(0,R.r)(d.J,{}),m=(0,p.o_h)(e),g=m?.toURI(),b=!(!g||!t),y=b?[g]:[],f=(0,x.H)(g),S=(0,j.XB)().split("_").join(" "),{draggable:w,onDragStart:N}=(0,C.P)({itemUris:y,dragLabelText:t??""});return(0,U.jsx)(v.h,{menu:f,children:(0,U.jsx)("div",{className:s()(k,l,{[F]:o}),children:e&&t?(0,U.jsx)(h.N,{ref:n,"aria-label":`${S} link`,draggable:w&&b,onDragStart:b?N:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:I,onClick:()=>{u.logInteraction(c.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})}):(0,U.jsx)(P,{title:t,variant:a,semanticColor:r})})})},H=S.$S.PANEL_CLOSE_CLICK,V=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:d,panelLinkRef:p,preventDefaultClose:v=!1,onBack:x,item:h,titleVariant:y="bodyMediumBold",titleSemanticColor:S="textBase"})=>{const C=(0,j._Y)(),R=(0,j.Ev)(H),k=(0,u.NC)(N.mzn),I=(0,j.XB)()===w.Z.NowPlayingView&&k,F=(0,f.h)(),P=(0,n.useDeferredValue)(I),V=(0,n.useCallback)((()=>{r?.(),v||C(H)}),[r,v,C]),z=null!==h&&(0,E.N)(h);return(0,U.jsx)(n.Suspense,{fallback:null,children:(0,U.jsxs)("div",{className:s()(L,d,{[T]:I}),children:[x&&(0,U.jsx)("span",{className:s()(O,_),children:(0,U.jsx)(b.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:x,icon:l.g})})}),P&&(0,U.jsx)(g.a,{icon:o.t,size:"sm",onClick:V,ariaLabel:m.Ru.get("web-player.now-playing-view.hide"),className:B}),i||(0,U.jsx)(M,{title:t,panelLinkRef:p,item:h,link:e,variant:y,semanticColor:S}),(0,U.jsxs)("span",{className:s()(O,A),children:[a,!z&&!I&&!F&&(0,U.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,U.jsx)(b.Zp,{label:m.Ru.get("close"),children:(0,U.jsx)(g.a,{ariaLabel:m.Ru.get("close"),className:D,size:"sm",onClick:V,icon:c.M,disabled:!R})})})]})]})})}},97235:(e,t,i)=>{i.d(t,{T:()=>l});var n=i(30758),a=i(88804),s=i(3161),r=i(86070);const l=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,s.r)(a.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,r.jsx)(i,{spec:e,...t})),[i,e])}}}}]);
//# sourceMappingURL=dwp-panel-section.js.map