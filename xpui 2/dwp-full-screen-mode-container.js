"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1955],{20883:(e,t,o)=>{o.d(t,{sY:()=>g,Nh:()=>f,bo:()=>k,r3:()=>v,EX:()=>y,lZ:()=>b});var a=o(33100),i=o(5820);o(33031);const n=new i.l("queryFullscreenMode","query","5d8427bc0f6f2f6b96521121faf162094c2a3f14f0511b5ca0628c6a5028a3ea",null);var s=o(17145),r=o(92505),c=o(63365),l=o(55),u=o(37639),d=o(12689),p=o(4945),m=o(88689),h=o(43943);const b=()=>{const e=(0,a.NC)(s.WYm,{loadingValue:!1});return(0,r.o)(m.A3)||e};function y(e){return(0,d.v)(e)?{uri:e.uri,name:e.name,creatorName:e.artists[0]?.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,u.p)(e)?{uri:e.uri,name:e.name,creatorName:e.show.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,l.d)(e)?{uri:e.uri,name:e.name,creatorName:e.book.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,c.N)(e)?{uri:e.uri,name:e.title??"",creatorName:e.advertiser??"",coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,p.v)(e)||void 0===e?void 0:(0,h.d)(e)}function v(e){const t=y(e);return(0,d.v)(e)||(0,u.p)(e)||(0,l.d)(e)||(0,c.N)(e)?{...t,duration:e.duration.milliseconds,mediaType:(o=e.mediaType,"video"===o||"mixed"===o?"video":"audio")}:(0,p.v)(e)||void 0===e?void 0:(0,h.d)(e);var o}function f(e){const t=e?.context.metadata?.context_description,o=e?.context.uri||void 0,a=e?.positionAsOfTimestamp??void 0,i=e?.timestamp,n=e?.isPaused,s=e?.restrictions.canPause,r=e?.restrictions.canResume;return{contextName:t,contextUri:o,position:a,timestamp:i,isPaused:n,canPause:s,canResume:r}}async function g(e,t){return e(n,{artistUri:t}).then((e=>{if("Artist"===e?.data?.artistUnion.__typename){const t=e.data.artistUnion.headerImage;if("ImageV2"===t?.data?.__typename)return t?.data.sources[0]?.url}})).catch((()=>{}))}function k(e,t,o){if(e&&o&&o.hasLyrics)return{status:t?"loading":"success",content:{provider:o.provider,syncType:o.syncType,lines:o.lyrics.map((e=>({timestamp:Number(e.start),text:e.text})))}}}},21899:(e,t,o)=>{o.d(t,{f:()=>p});var a=o(30758),i=o(97500),n=o.n(i),s=o(43409),r=o(86871);const c="KAZD28usA1vPz5GVpm63",l="RK45o6dbvO1mb0wQtSwq",u="EHxL6K_6WWDlTCZP6x5w";var d=o(86070);const p=(0,a.forwardRef)(((e,t)=>{const o=e.isActive??!1,a=n()(c,{[l]:o||e.isActiveNoIndicator,[u]:o},e.className);return(0,d.jsx)(r.Zp,{label:e.label,children:(0,d.jsx)(s.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:a,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":o.toString(),"aria-pressed":o,"data-restore-focus-key":e.restoreFocusKey})})}))},23605:(e,t,o)=>{o.d(t,{$:()=>n});var a=o(85387);const i="/lyrics",n=()=>{const e=(0,a.zy)(),t=e.pathname.startsWith(i);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:i}}},34047:(e,t,o)=>{o.d(t,{M:()=>a.M,V:()=>a.V});var a=o(79105)},34303:(e,t,o)=>{o.d(t,{x:()=>a.x});var a=o(7605)},34308:(e,t,o)=>{o.d(t,{FullscreenModeContainer:()=>ke});var a=o(30758),i=o(62411),n=o(21506);const s="1.0.0",r="default";class c{constructor(e){this._path=[{name:"desktop-fullscreen",...e.data}],e?.parentAbsoluteLocation&&(this._parentAbsoluteLocation=e.parentAbsoluteLocation)}npbControlsFactory(){return new c.NpbControlsEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}npbExtrasFactory(){return new c.NpbExtrasEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}npbWidgetFactory(){return new c.NpbWidgetEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[s,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const e=this._parentAbsoluteLocation?.locations;return{locations:[...e||[],this._getCurrentLocation()]}}}!function(e){e.NpbControlsEventFactory=class{constructor({path:e,parentAbsoluteLocation:t,data:o}){this._path=e.concat({name:"npb_controls"}),t&&(this._parentAbsoluteLocation=t)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[s,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const e=this._parentAbsoluteLocation?.locations;return{locations:[...e||[],this._getCurrentLocation()]}}}}(c||(c={})),function(e){e.NpbExtrasEventFactory=class{constructor({path:e,parentAbsoluteLocation:t,data:o}){this._path=e.concat({name:"npb_extras"}),t&&(this._parentAbsoluteLocation=t)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[s,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const e=this._parentAbsoluteLocation?.locations;return{locations:[...e||[],this._getCurrentLocation()]}}}}(c||(c={})),function(e){e.NpbWidgetEventFactory=class{constructor({path:e,parentAbsoluteLocation:t,data:o}){this._path=e.concat({name:"npb_widget"}),t&&(this._parentAbsoluteLocation=t)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[s,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const e=this._parentAbsoluteLocation?.locations;return{locations:[...e||[],this._getCurrentLocation()]}}}}(c||(c={}));var l=o(84010),u=o(66105),d=o(50863),p=o(97500),m=o.n(p),h=o(7391),b=o(63409),y=o(31369),v=o(79252),f=o(99329);const g="ylcmjHXKpwmez5_bBVgt",k="kChcaF3yz3SoL5dZPwEr",C="tr1hDrJgoPSbMXlXU_sl",x="mbUrqWP55sK6zhspiR72",L="SVGHXIQcH9HYU7uGITw5",_="N5cWYDvyLrfnyMZuqQHo",A="gIobRDHAxkAvUaF4_OOL",P="FTi9QEhetf4Q4__5sb4S",F="Gw7E7MkWci1ttQhb4EK0",S="Lgyj1e9c3lrdgVGlMIyV";var w=o(86070);const I=(0,a.memo)((function({iconSize:e="small",onClick:t}){return(0,w.jsx)("button",{className:F,onClick:()=>{t?.(),(0,f.SP)()},"aria-label":v.Ru.get("npv.exit-full-screen"),title:v.Ru.get("npv.exit-full-screen"),children:(0,w.jsx)(y.b,{size:e})})}));var N=o(77029),T=o(21899);const E=()=>(0,w.jsx)(N.q,{iconSize:24}),j=({onClick:e,enabled:t})=>{const o=(0,a.useCallback)((()=>{e?.(!t)}),[e,t]);return(0,w.jsx)(T.f,{className:S,isActive:t,onToggle:o,label:v.Ru.get("web-player.lyrics.title"),testId:"fullscreen-mode-overlay-lyrics-button",icon:E})},B=(0,a.memo)(j);var R=o(62108),M=o(27149),V=o(76540),U=o(37639),z=o(12689);const O=({item:e,onClick:t})=>(0,z.v)(e)?(0,w.jsx)(V.b,{uri:e.uri,size:R.t.sm,onClick:t}):(0,U.p)(e)?(0,w.jsx)(M.b,{uri:e.uri,size:R.t.sm,onClick:t,condensed:!0}):null;var D=o(34303),W=o(69463),H=o(45105),K=o(34047),Q=o(26691),q=o(25234),X=o(25517),Z=o(18769),J=o(62935),Y=o(25945),G=o(19686),$=o(15845),ee=o(43943);const te=({isVisible:e,onClick:t,item:o,isLyricsAvailable:i,isLyricsEnabled:n,onLyricsButtonClick:s})=>{const r=(0,H.p)(),c=(0,G.f)(),u=(0,b.p6)({parentAbsoluteLocation:c||void 0,data:{identifier:l.gw.FULLSCREEN}}),d=(0,l.kD)({parentAbsoluteLocation:c||void 0,data:{identifier:l.gw.FULLSCREEN}}),p=(0,h.h9)({parentAbsoluteLocation:c||void 0,data:{identifier:l.gw.FULLSCREEN}}),y=(0,$.s)(),[v]=(0,J.S)(1e3,(e=>e.item?.uri===o?.uri)),f=(0,a.useCallback)((e=>{if(o)if(e){const e=u.likeButtonFactory({uri:o.uri}).hitLike({itemToBeLiked:o.uri});y.logInteraction(e)}else{const e=u.likeButtonFactory({uri:o.uri}).hitRemoveLike({itemNoLongerLiked:o.uri});y.logInteraction(e)}}),[o,u,y]),F=(0,a.useCallback)((e=>{if(!o)return;const t=d.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:o.uri,playbackSpeed:e});y.logInteraction(t)}),[o,y,d]),S=(0,a.useCallback)((e=>{if(e){const e=d.shuffleButtonFactory().hitShuffleEnable();y.logInteraction(e)}else{const e=d.shuffleButtonFactory().hitShuffleDisable();y.logInteraction(e)}}),[y,d]),N=(0,a.useCallback)((e=>{const t=d.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e});y.logInteraction(t)}),[y,d]),T=(0,a.useCallback)(((e,t)=>{switch(t){case"drag":return y.logInteraction(d.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return y.logInteraction(d.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,ee.k)(t)}}),[y,d]),E=(0,a.useCallback)((e=>{const t=d.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e});y.logInteraction(t)}),[y,d]),j=(0,a.useCallback)((e=>{if(o)if("pause"===e){const e=d.playPauseButtonFactory().hitPause({itemToBePaused:o.uri});y.logInteraction(e)}else if("resume"===e){const e=d.playPauseButtonFactory().hitResume({itemToBeResumed:o.uri});y.logInteraction(e)}}),[o,y,d]),R=(0,a.useCallback)((e=>{const t=d.repeatButtonFactory().hitRepeatEnable(),o=d.repeatButtonFactory().hitRepeatOneEnable(),a=d.repeatButtonFactory().hitRepeatDisable();switch(e){case Y.p.REPEAT_CONTEXT:y.logInteraction(t);break;case Y.p.REPEAT_NONE:y.logInteraction(a);break;case Y.p.REPEAT_TRACK:y.logInteraction(o);break;default:throw(0,ee.k)(e)}}),[y,d]),M=(0,a.useCallback)((()=>{if(!o)return;const e=d.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:o.uri,positionMs:v,totalContentMs:o.duration.milliseconds||0});y.logInteraction(e)}),[o,y,d,v]),V=(0,a.useCallback)((()=>{if(!o)return;const e=d.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:o.uri,positionMs:v,totalContentMs:o.duration.milliseconds||0});y.logInteraction(e)}),[o,y,d,v]),U=(0,a.useCallback)((e=>{const t=p.volumeBarFactory().hitSetVolume({newVolumePercentage:e});y.logInteraction(t)}),[y,p]),z=(0,a.useCallback)((e=>{const t=p.volumeBarFactory().dragSetVolume({newVolumePercentage:e});y.logInteraction(t)}),[y,p]),te=(0,a.useCallback)((e=>{if("muted"===e){const e=p.volumeMuteButtonFactory().hitMutePlayback();y.logInteraction(e)}else if("not_muted"===e){const e=p.volumeMuteButtonFactory().hitUnmutePlayback();y.logInteraction(e)}}),[y,p]),oe=(0,a.useCallback)((()=>{const e=p.fullscreenButtonFactory().hitUiHide();y.logInteraction(e)}),[y,p]);return(0,w.jsx)(Z.s,{active:e,focusTrapOptions:{initialFocus:!1},children:(0,w.jsx)("div",{className:m()(g,{[k]:e}),onClick:t,children:(0,w.jsxs)("div",{className:C,"data-testid":"fullscreen-mode-controls",children:[(0,w.jsx)(D.x,{isPreview:!1,isFullscreenMode:!0,onChange:T}),(0,w.jsxs)("div",{className:x,children:[(0,w.jsx)("div",{className:m()(L,_),children:o&&(0,w.jsx)(O,{item:o,onClick:f})}),(0,w.jsxs)("div",{className:m()(L,A),children:[r&&(0,w.jsx)(W.w0,{iconSize:24,onClick:F}),!r&&(0,w.jsx)(q.w,{renderEnabled:()=>(0,w.jsx)(Q.a,{size:"medium"}),renderDisabled:()=>(0,w.jsx)(W.uP,{iconSize:"medium",onClick:S})}),r&&(0,w.jsx)(W.hC,{onClick:N}),(0,w.jsx)(W.dQ,{onClick:M}),(0,w.jsx)(W.xJ,{iconSize:"large",onClick:j}),(0,w.jsx)(W.$K,{onClick:V}),r&&(0,w.jsx)(W.v3,{onClick:E}),!r&&(0,w.jsx)(W.s_,{onClick:R})]}),(0,w.jsxs)("div",{className:m()(L,P),children:[(0,w.jsx)(X.C,{iconSize:"medium",renderInline:!0,noBackground:!0}),!r&&i&&(0,w.jsx)(B,{enabled:n,onClick:s}),(0,w.jsx)(K.M,{onVolumeBarClick:U,onVolumeBarDrag:z,onToggleMuteClick:te}),(0,w.jsx)(I,{iconSize:"medium",onClick:oe})]})]})]})})})};var oe=o(20883),ae=o(52094);var ie=o(46860);var ne=o(40638);var se=o(23605),re=o(71076),ce=o(45127),le=o(21709),ue=o(87761),de=o(92915),pe=o(17984),me=o(65882),he=o(92505),be=o(88689),ye=o(16859),ve=o(13478);const fe=a.lazy((async()=>{const{ArtistNpv:e}=await o.e(2001).then(o.bind(o,29933));return{default:e}})),ge=a.memo((function(){const{isActive:e}=(0,se.$)(),[t,o]=(0,a.useState)(e),s=(0,me.z)(),r=(0,de.W)(),d=(0,he.o)((e=>e),((e,t)=>(0,ve.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),p=d?.item??void 0,m=d?.nextItems??[],h=d?.playbackId??void 0,b=(0,z.v)(p)?p.artists[0]?.uri:void 0,y=p?.images,v=(e=>{const{request:t}=(0,a.useContext)(ae.j),[o,i]=(0,a.useState)(void 0);return(0,a.useEffect)((()=>{let o=!0;return e&&(0,oe.sY)(t,e).then((e=>{o&&i(e)})),()=>{o=!1}}),[e,t]),o})(b);let g=(0,pe.z)(y?.[0]?.url);(()=>{const e=(0,i.wA)();(0,ie.P)((t=>{t||e((0,u.rF)())})),(0,a.useEffect)((()=>{const e=e=>{"Escape"===e.key&&(0,f.SP)()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[e])})();const k=(0,$.s)(),C=new c({data:{identifier:"full-screen",uri:p?.uri||""}});const x=(0,l.kD)({parentAbsoluteLocation:C.getAbsoluteLocation(),data:{identifier:l.gw.FULLSCREEN}}),{position:L,contextName:_,contextUri:A,isPaused:P,canResume:F,canPause:S,timestamp:I}=(0,oe.Nh)(d),{isOverlayVisible:N,showOverlay:T,hideOverlay:E}=(()=>{const[e,t]=(0,a.useState)(!1),o=(0,a.useRef)(null),i=(0,ne.YQ)((()=>{null!==o.current&&clearTimeout(o.current),o.current=setTimeout((()=>{t(!1)}),2500),t(!0)}),100,{leading:!0,trailing:!1});return(0,a.useEffect)((()=>()=>{null!==o.current&&clearTimeout(o.current)}),[]),{isOverlayVisible:e,showOverlay:i,hideOverlay:(0,a.useCallback)((()=>{t(!1),null!==o.current&&clearTimeout(o.current)}),[])}})(),j=(0,oe.r3)(p),B=(0,oe.EX)(m.length>0?m[0]:void 0),R=(0,be.A3)(d),M=(0,a.useCallback)((e=>{if(e.target===e.currentTarget)if(r({type:"click",intent:P?"play":"pause"}),P&&F){const e=x.playPauseButtonFactory().hitResume({itemToBeResumed:p?.uri||""});k.logInteraction(e),s.resume({featureIdentifier:"fullscreen"})}else if(!P&&S){const e=x.playPauseButtonFactory().hitPause({itemToBePaused:p?.uri||""});k.logInteraction(e),s.pause({featureIdentifier:"fullscreen"})}}),[S,F,P,p?.uri,k,x,r,s]),V=(0,a.useCallback)((e=>{o(e)}),[o]),{data:U,loading:O}=(0,re.J)(),D=!!U?.hasLyrics,W=U?.hasLyrics?U.providerLyricsId:void 0;g=D?U.colors.background:g;const H=(0,a.useMemo)((()=>(0,oe.bo)(t,O,U)),[t,O,U]),K=(0,ce.vh)(),Q=(0,a.useCallback)(((e,t,o)=>K.send((0,n.W)({lyrics_format:"fullscreen",track_uri:e,provider:t,provider_lyrics_id:W,sync_type:o,playback_id:h}))),[h,W,K]);return(0,w.jsx)(a.Suspense,{fallback:null,children:(0,w.jsx)("div",{onPointerMove:T,onPointerLeave:E,onFocus:T,"data-testid":"fullscreen-mode-container",children:(0,w.jsx)(ye.r,{spec:C,children:(0,w.jsx)(fe,{currentTrack:j,position:L??0,timestamp:I??0,nextTrack:B,backgroundColor:g,backgroundImageUrl:v,contextName:_,contextUri:A,playbackIsPaused:P,contextMetadataVisible:!R||N,trackMetadataVisible:!R||N,lyrics:H,onLyricsReport:Q,controlsVisible:!1,progressBarVisible:!R||N,CustomProgressBar:void 0,CustomPlaybackControls:(0,w.jsx)(te,{isVisible:N,onClick:M,item:p,isLyricsAvailable:D,isLyricsEnabled:t,onLyricsButtonClick:V})})})})})})),ke=a.memo((function({videoRef:e}){const t=(0,a.useContext)(d.s),o=(0,oe.lZ)(),{setVideoPlayerUIFlag:n}=(0,le.d)(),s=(0,i.wA)(),r=(0,i.d4)((e=>e.ui.fullscreenMode.isOpen));return(0,a.useEffect)((()=>{if(!o)return n(ue.nP.fullscreen,!1),s((0,u.DH)()),void(0,f.SP)();const e=(0,f.ge)();!r&&e&&(n(ue.nP.fullscreen,!1),s((0,u.DH)()),(0,f.SP)())}),[n,o,r,s]),(0,w.jsxs)("div",{ref:t,children:[(0,w.jsx)("div",{ref:e}),o&&r?(0,w.jsx)(ge,{}):null]})}))},45105:(e,t,o)=>{o.d(t,{p:()=>r});var a=o(92505),i=o(63365),n=o(55),s=o(37639);function r(){const e=(0,a.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,s.p)(e)||(0,n.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,i.N)(e)&&e.isPodcastAd}},69463:(e,t,o)=>{o.d(t,{$K:()=>l.$,dQ:()=>c.d,hC:()=>n.h,s_:()=>i.s,uP:()=>r.u,v3:()=>s.v,w0:()=>u.w,xJ:()=>a.x});var a=o(59327),i=o(64351),n=o(24897),s=o(69515),r=o(9644),c=o(8555),l=o(62727),u=o(40275)},71076:(e,t,o)=>{o.d(t,{J:()=>a.J});var a=o(15113)}}]);
//# sourceMappingURL=dwp-full-screen-mode-container.js.map