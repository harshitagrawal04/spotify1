"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[347],{37509:(e,s,n)=>{n.d(s,{HomeSubfeedWithRedirect:()=>q});var t=n(30758),o=n(97500),i=n.n(o),a=n(33100),r=n(4293),c=n(79252),h=n(84684),l=n(30618),d=n(97005),m=n(81442),p=n(91261),g=n(34448),u=n(11835),f=n(55077),x=n(48237),j=n(62411),C=n(88019),y=n(94097),A=n(49812),S=n(20580),_=n(7423),R=n(17145),b=n(49531),N=n(16859),w=n(3161),k=n(63710),v=n(90186),M=n(86070);const I=(0,t.memo)((({cardCount:e})=>(0,M.jsx)("section",{children:(0,M.jsx)("div",{className:i()(v.A.home,v.A.homepage),children:(0,M.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,M.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})})})}))),P=({sectionURIs:e})=>{const s=(0,a.NC)(R.MX4),n=(0,a.NC)(R.wWq),{data:o,error:h,loading:d,extensions:p}=(0,A.$o)({uris:e,timeZone:(0,S.Ff)(),sp_t:(0,b.v8)("sp_t")??"",sectionItemsLimit:n??10},{gcTime:S.gO,staleTime:S.jl}),g=(0,m.getRequestIdForImpressions)(p),{spec:u}=(0,w.r)(r.Y,{data:{identifier:"home/pinned",uri:"spotify:home:pinned",reason:g??""}}),f=(0,j.d4)((e=>e.session.user)),P=(0,t.useCallback)((()=>{const s=new URL("https://open.spotify.com/home");s.searchParams.set("facet","pinned-by"),s.searchParams.set("hpuris",e.map((e=>e.replace("spotify:section:",""))).join(",")),s.searchParams.set("hpname",f?.display_name??f?.id??""),(0,k.l)(s.toString()),(0,x.M8)(c.Ru.get("feedback.link-copied"))}),[e,f?.display_name,f?.id]);return d?(0,M.jsx)(I,{cardCount:10}):null!==h||"HomeSectionCollection"!==o?.homeSections.__typename?(0,M.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):(0,M.jsx)(N.r,{spec:u,children:(0,M.jsxs)("section",{"data-testid":"home-pin-page",className:i()(v.A.home,s?v.A.homepageWithCarousels:v.A.homepage),children:[(0,M.jsx)("div",{className:i()(v.A.homePinButton,"contentSpacing"),children:(0,M.jsx)(C.$,{iconLeading:y.C,onClick:P,size:"small",children:"Share your home"})}),(0,M.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:o.homeSections.sections.map(((e,s)=>"HomeSection"!==e.__typename?null:(0,M.jsx)(_.Q,{section:e,index:s,greeting:null},`${s}-${e.uri}`)))})]})})};var $=n(263),L=n(99425),H=n(16712),D=n(61702);const T=(0,t.memo)((({cardCount:e})=>(0,M.jsxs)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:[(0,M.jsx)(h.y,{withTitle:!1}),(0,M.jsx)(g.f,{showAll:!0,cardCount:e,withTitle:!1})]}))),U=()=>{const e=(0,f.f)(),s=(0,a.NC)(R.MX4),n=(0,a.NC)(R.k4Y),{data:o,loading:h,error:g,extensions:x}=(0,H.f)(),j=(0,t.useRef)(null);(0,d.b)(j);const C=e.replace("-chip",""),{spec:y}=(0,w.r)(r.Y,{data:{identifier:C?`home/${C}`:"",uri:`spotify:home:${C}`,reason:(0,m.getRequestIdForImpressions)(x)??""}}),A=o?.home;if(h)return(0,M.jsx)("section",{"data-testid":"home-subfeed-page",className:i()(v.A.home,s?v.A.homepageWithCarousels:v.A.homepage),children:(0,M.jsx)(T,{cardCount:50})});if(null!==g)return(0,M.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});if("HomeResponsePayload"!==A?.__typename)return(0,M.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")});const S=A.sectionContainer.sections.items;return 0===S.length?(0,M.jsx)(l.LoadingPage,{hasError:!0,errorMessage:c.Ru.get("error.generic")}):("HomeShortsSectionData"!==S[0]?.data?.__typename&&(e=>s=>"HomeShortsSectionData"===s.data?.__typename||"spotify:section:0JQ5DAnM3wGh0gz1MXnu3N"===s.uri&&"podcasts-chip"===e||("spotify:section:0JQ5DAJvCyzyxqjq31tlEs"===s.uri||"spotify:section:0JQ5DAnM3wGh0gz1MXnucs"===s.uri)&&e===u.e)(e)(S[0])&&(A.sectionContainer.sections.items[0]={...S[0],data:{...S[0].data,__typename:"HomeShortsSectionData"}}),(0,M.jsx)(N.r,{spec:y,children:(0,M.jsx)("section",{ref:j,"data-testid":"home-subfeed-page",className:i()(v.A.home,s?v.A.homepageWithCarousels:v.A.homepage),children:(0,M.jsx)("div",{className:i()(v.A.homepageContent,"contentSpacing"),children:(0,M.jsx)(p.g,{container:A.sectionContainer,greeting:null,enableFeedBaseline:n})})})}))},q=()=>{const e=(0,f.f)(),{shelfURIs:s}=(0,$.T)(),n=(0,L.k)();if((0,a.NC)(R._Ie)){if("pinned-by"===e&&n){const e=n?.uris;return e.length?(0,M.jsx)(P,{sectionURIs:e}):(0,M.jsx)(D.$,{to:"/"})}if("pinned"===e){const e=s;return e.length?(0,M.jsx)(P,{sectionURIs:e}):(0,M.jsx)(D.$,{to:"/"})}}return e?(0,M.jsx)(U,{}):(0,M.jsx)(D.$,{to:"/"})}},99425:(e,s,n)=>{n.d(s,{k:()=>o});var t=n(85387);const o=()=>{const e=(0,t.zy)(),s=new URLSearchParams(e.search);if(!s.has("hpuris"))return null;const n=(s.get("hpuris")||"").split(",").map((e=>`spotify:section:${e}`));return{name:s.get("hpname")??"Shared",uris:n}}}}]);
//# sourceMappingURL=home-subfeed.js.map