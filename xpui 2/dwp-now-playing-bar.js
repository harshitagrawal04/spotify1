"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3322],{2806:(e,t,i)=>{i.d(t,{NowPlayingBar:()=>ba});var n=i(30758),a=i(97500),o=i.n(a),s=i(62411),r=i(94079),c=i(85047),l=i(44004),u=i(88019),d=i(79252);const m="dz_h98rH9nZCwfPdnKgr",g="rAfV2jB_HMM9Xtr0Rqvn",p="XkXPpDRWozMF6G8_GlLQ";var v=i(86070);const b=n.memo((function(e){const{handleClick:t}=e,i=d.Ru.get("pta.bottom-bar.title"),n=d.Ru.get("fta.bottom-bar.subtitle"),a=d.Ru.get("fta.sign-up-free");return(0,v.jsxs)("div",{className:m,onClick:t,"data-testid":"signup-bar",children:[(0,v.jsxs)("div",{className:g,children:[(0,v.jsx)(l.E,{as:"p",variant:"bodySmallBold",children:i}),(0,v.jsx)(l.E,{as:"p",variant:"bodyMedium",dangerouslySetInnerHTML:{__html:n}})]}),(0,v.jsx)(u.$,{colorSet:"invertedLight",onClick:t,className:p,children:a})]})}));var y=i(19315),h=i(17808),k=i(10631),C=i(74520),x=i(11895),N=i(15346),f=i(71726),j=i(3161);const I="gqYYMz8DkhaT3e44LcHQ",A="VX33mI2V_jRA7hRBI9_0",S=({remoteDeviceName:e,remoteDeviceType:t,connectionStatus:i,omitConnectionStateText:n=!1})=>{const{spec:a,logger:o}=(0,j.r)(k.s,{}),{triggerRef:s,toggleDevicePicker:r,isPickerOpen:c}=(0,x.z)(),u=(0,N.$A)(t,i),m=i===f.zP.CONNECTED?d.Ru.get("web-player.connect.bar.connected-state",{device_name:e}):d.Ru.get("web-player.connect.bar.connecting-state",{device_name:e});return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(u,{size:"small",className:A,role:"presentation",semanticColor:"essentialBase"}),(0,v.jsx)(h.Y,{component:"button",onClick:()=>{const e=a.activeDeviceButtonFactory(),{interactionId:t}=o.logInteraction(c?e.hitUiHide():e.hitUiReveal()),i=c;r(t),i||(0,C.I)("DEVICE-PICKER")},ref:s,className:I,children:(0,v.jsx)(l.E,{variant:"bodySmallBold","aria-live":"polite",semanticColor:"textBase",children:n&&i===f.zP.CONNECTED?e:m})})]})},P="nQSM_BrSHJ4Cp3XSuLOF",w=()=>(0,v.jsxs)("svg",{width:"1",height:"16",viewBox:"0 0 1 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"separator",className:P,children:[(0,v.jsx)("g",{id:"separator",clipPath:"url(#clip0_491_88335)",children:(0,v.jsx)("rect",{id:"Rectangle 111112858",width:"1",height:"16",rx:"0.5",fill:"var(--essential-base)"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"clip0_491_88335",children:(0,v.jsx)("rect",{width:"1",height:"16",fill:"white"})})})]});var T=i(22458),D=i(26729),E=i(70961),B=i(66225),R=i(13478);const L="gQoa8JTSpjSmYyABcag2",_="T3hkVxXuSbCYOD2GIeQd",O="GcHojieewpdN1c8vbtwk",F=function(){const{isPlayingRemotely:e,connectionStatus:t,remoteDeviceName:i,remoteDeviceType:n}=(0,E.v)((e=>{const t=(0,D.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,connectionStatus:t.connectionStatus,remoteDeviceName:t.remoteDevice?.name,remoteDeviceType:t.remoteDevice?.type}}),R.a),{currentSession:a}=(0,B.D)(),s=Boolean(a?.active),r=e&&i&&n;if(!r&&!s)return null;const c=t===f.zP.CONNECTED||s,l=t===f.zP.CONNECTING&&!s;return(0,v.jsxs)("div",{className:o()(L,{"encore-bright-accent-set":c,[_]:c,[O]:l}),children:[s&&(0,v.jsx)(T.K,{}),s&&r&&(0,v.jsx)(w,{}),r&&(0,v.jsx)(S,{connectionStatus:t,remoteDeviceName:i,remoteDeviceType:n,omitConnectionStateText:s})]})},U=()=>(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(F,{})});var M=i(40638),z=i(33100),V=i(7391),G=i(8410),Q=i(66105),K=i(50863),q=i(20883),H=i(21899),W=i(89421),Y=i(12131),Z=i(82101),X=i(60169),J=i(97724),$=i(17145),ee=i(99329),te=i(92505);const ie=({className:e="",disabledClassName:t="",onClick:i})=>{const a=(0,q.lZ)(),r=(0,n.useContext)(K.s),c=(0,te.o)((e=>e?.hasContext??!1)),l=(0,s.wA)(),u=(0,z.NC)($.mzn),m=(0,X.l)(),g=!c,{toggleFullScreen:p,isInFullScreen:b}=(0,J.H)({refOrElement:document.body,shouldWakeLockScreen:!0}),y=(0,n.useCallback)((()=>{const e=b?Z.z.CLOSED:Z.z.NOW_PLAYING_VIEW;p(),setTimeout((()=>{m(e)}),1)}),[b,m,p]),h=(0,n.useCallback)((()=>{r?.current&&(l((0,Q.f)()),(0,ee.X8)(r.current))}),[l,r]),k=(0,n.useCallback)((async()=>{c&&(i?.(!0),u?y():h())}),[c,i,u,y,h]),C=b?W.z:Y.T,x=b?d.Ru.get("web-player.cinema-mode.fullscreen.exit"):d.Ru.get("web-player.cinema-mode.fullscreen.enter"),N=o()(e,{[t]:g});return a?(0,v.jsx)(H.f,{onToggle:k,className:N,icon:u?C:G.L,label:u?x:d.Ru.get("npv.full-screen"),disabled:g,testId:"fullscreen-mode-button"}):null},ne=(0,n.memo)(ie);var ae=i(17293),oe=i(94677),se=i(34945);var re=i(15587),ce=i(43409),le=i(66973);const ue="xP7v0EBcbJMj1xIJxywg",de="zJU_lLLzQL6oKvMA0c5b",me=({onClose:e,onMouseEnter:t,onMouseLeave:i,onClick:n,impressionCallback:a,message:o})=>(0,v.jsxs)("div",{className:ue,onMouseEnter:t,onMouseLeave:i,ref:a,onClick:n,children:[(0,v.jsx)(l.E,{id:"nudgeBody",as:"p",variant:"bodyMedium",semanticColor:"textBase",children:o}),(0,v.jsx)(ce.H,{iconOnly:le.M,size:"small",semanticColor:"textBase",onClick:t=>{t.stopPropagation(),e?.()},"aria-label":d.Ru.get("close"),className:de})]});var ge=i(61196),pe=i(61871);const ve=(e=ge.C)=>{const t=(0,s.Pj)(),{isActive:i}=e(),n=(0,pe.h)();return document.hasFocus()&&!i&&!(({ui:e,ads:t},i)=>e.blockUserDialog.isOpen||e.connectDevicePicker.isOpen||e.deleteFolderDialog.isOpen||e.deletePlaylistDialog.isOpen||e.fullscreenMode.isOpen||e.improvedSignupPromptDialog.isOpen||e.keyboardShortcutsHelpModal.isOpen||e.leavePlaylistDialog.isOpen||e.offlineDeviceLimitReachedDialog.isOpen||e.playbackNotSupportedErrorDialog.isOpen||e.premiumDialog.isOpen||!0===t.billboard?.isOpen&&!t.billboard.isMinimized||!1===t.vto?.isHidden&&!1===t.vto?.isMinimized||i)(t.getState(),n.current.length>0)};var be=i(51979);var ye=i(83660),he=i(82429),ke=i(7954),Ce=i(40596),xe=i(65882),Ne=i(85978),fe=i(85927),je=i(88689);const Ie=e=>{const t=(0,n.useRef)(),i=(0,n.useRef)(),a=(0,n.useRef)(!1),o=(0,xe.z)(),s=(0,he.Z)(),{spec:r,logger:c}=(0,j.r)(be.w,{}),l=(0,n.useRef)(null),u=(0,n.useCallback)((()=>{c.logInteraction(r.djVoiceUnsupportedNudgeFactory().closeButtonFactory().hitUiHide())}),[r,c]),m=(0,n.useCallback)((e=>{e&&l.current!==e&&c.logImpression(r.djVoiceUnsupportedNudgeFactory().impression()),l.current=e}),[r,c]),g=(0,n.useCallback)((()=>{const e=o.getState(),t=s.getActiveDevice();return!(e=>e?.isLocal??!1)(t)&&(0,je.yc)(e,"spotify:playlist:37i9dQZF1EYkqdzj48dyYq")!==fe.i.NOT_ACTIVE&&!(e=>Boolean(e?.supportsDJNarration))(t??void 0)}),[o,s]),p=(0,n.useCallback)((()=>{g()&&e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.dj-voice-unavailable"),onClose:u,impressionCallback:m})}),[e,g,u,m]),v=(0,n.useCallback)((e=>{e.data.action===Ce.Ik.PLAY&&(a.current=!0)}),[]);(0,Ne.p)(Ce.gd.ACTION,v);const b=(0,n.useCallback)((e=>{a.current&&(0,je.uW)(e.data)===fe.i.PLAYING&&(t.current=e.data?.context.uri,p(),t.current=void 0,a.current=!1)}),[p]);(0,Ne.p)(Ce.gd.UPDATE,b);const y=(0,n.useCallback)((e=>{const t=e.data?.activeDevice;t&&!t.isLocal&&i.current!==t.connectStateId&&p(),i.current=t?.connectStateId}),[p]);(0,ke.W)(ye.P.UPDATE,y)};var Ae=i(48391);const Se=e=>{switch(e.type){case f.bq.AUDIO_DONGLE:case f.bq.AVR:case f.bq.CAST_AUDIO:case f.bq.CAST_VIDEO:case f.bq.GAME_CONSOLE:case f.bq.SPEAKER:case f.bq.STB:case f.bq.TV:return!0;default:return!1}};var Pe=i(41290),we=i(23700),Te=i(76137);const De=new Date(0).toISOString(),Ee=["shift+alt+f10"],Be=e=>{const t=(0,n.useRef)(),i=(0,n.useRef)(!1),a=(0,n.useRef)(!1),o=(0,s.Pj)(),r=(0,xe.z)(),c=(0,he.Z)(),l=(0,we.V)(),[u,m]=(0,Te.x)("connect-nudge-triggered-at",De),g=(0,n.useRef)(null),{spec:p,logger:v}=(0,j.r)(be.w,{}),b=(0,n.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().hitNoAction())}),[p,v]),y=(0,n.useCallback)((()=>{v.logInteraction(p.connectFromDevicePickerNudgeFactory().closeButtonFactory().hitUiHide())}),[p,v]),h=(0,n.useCallback)((e=>{e&&g.current!==e&&v.logImpression(p.connectFromDevicePickerNudgeFactory().impression()),g.current=e}),[p,v]);(0,Pe.f)(Ee,(async()=>{const{platform:{isDeveloperMode:e}}=o.getState();if(e){const e=new Date;e.setHours(e.getHours()-8),m(e.toISOString())}}));const k=(0,n.useCallback)((()=>{const e=r.getState(),t=c.getActiveDevice(),i=c.getDevices(),n=l.getDefaultDevice(),a=new Date(u);a.setHours(a.getHours()+8);return a<=new Date&&(e=>e?.isLocal??!1)(t)&&!(0,je.A3)(e)&&(e=>e.some((e=>e.isLocalNetwork&&!e.isDisabled&&Se(e))))(i)&&(e=>!e||!(e.terminalType===Ae.FI.HEADPHONES||e.terminalType===Ae.FI.SPEAKERS&&(e.transportType===Ae.Yg.BLUETOOTH||e.transportType===Ae.Yg.USB)))(n)}),[r,l,u,c]),C=(0,n.useCallback)((()=>{if(k()){e({nudgeType:"message-only-nudge",message:d.Ru.get("web-player.connect.nudge.listen-to-speaker"),impressionCallback:h,onClick:b,onClose:y});const t=(new Date).toISOString();m(t)}}),[e,k,m,b,y,h]),x=(0,n.useCallback)((e=>{e.data.action===Ce.Ik.PLAY?i.current=!0:e.data.action===Ce.Ik.RESUME&&(a.current=!0)}),[]);(0,Ne.p)(Ce.gd.ACTION,x);const N=(0,n.useCallback)((e=>{i.current&&(0,je.uW)(e.data)===fe.i.PLAYING?(t.current=e.data?.context.uri,C(),t.current=void 0,i.current=!1):a.current&&!1===e.data?.isPaused&&(t.current=e.data?.context.uri,C(),t.current=void 0,a.current=!1)}),[C]);(0,Ne.p)(Ce.gd.UPDATE,N)},Re=e=>{Be(e),Ie(e)},Le=()=>{const e=(0,n.useRef)(),t=(0,n.useRef)(!1),i=(0,n.useRef)(!1),a=(0,s.wA)(),o=(0,s.d4)((e=>e.ui.connectNudge.isOpen)),r=(0,s.d4)((e=>e.ui.connectDevicePicker.isOpen)),c=(0,n.useCallback)((()=>{i.current&&(clearTimeout(e.current),i.current=!1),a((0,Q.Yp)())}),[a]),l=(0,n.useCallback)((()=>{i.current=!1,t.current||c()}),[c]),u=(0,n.useCallback)((()=>{e.current=window.setTimeout(l,8e3),a((0,Q.dK)()),i.current=!0}),[a,l]),d=(0,n.useCallback)((e=>{t.current=e,e||i.current||c()}),[c]);return(0,n.useEffect)((()=>{r&&c()}),[r,c]),(0,n.useMemo)((()=>({hideNudge:c,showNudge:u,setShouldKeepShowingNudge:d,isNudgeVisible:o})),[c,u,d,o])},_e=({children:e,useNudgeTriggers:t=Re,useToggleNudgeWithTimer:i=Le,useCanShowNudge:a=ve,disabled:o=!1})=>{const{showNudge:s,hideNudge:r,setShouldKeepShowingNudge:c,isNudgeVisible:l}=i(),[u,d]=(0,n.useState)(null),m=a();(0,n.useEffect)((()=>{l&&!m&&r()}),[m,r,l]),t((e=>!(l||!m)&&(d(e),s(),!0)));const g=(0,n.useCallback)((e=>{if(!e)return(0,v.jsx)(v.Fragment,{});return(0,v.jsx)(me,{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...e,onClose:()=>{e?.onClose?.(),r()}})}),[r,c]);return(0,v.jsx)(re.W,{placement:"top",visible:Boolean(u?.message)&&l&&!o,overlay:g(u),popperOptions:{modifiers:[{name:"preventOverflow",options:{rootBoundary:"viewport",altAxis:!0,padding:24,tether:!1}}]},onHide:()=>{},fadeOut:!0,useLazyMounting:!0,children:e})};var Oe=i(84277);const Fe=()=>{const{remoteDeviceType:e,remoteDeviceIsGroup:t,connectionStatus:i}=(0,E.v)((e=>{const t=(0,D.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceIsGroup:t.remoteDevice?.isGroup,connectionStatus:t.connectionStatus}}),R.a),a=(0,oe.g)(),{canTogglePanel:o,isActive:s,togglePanel:r}=(0,se.C)(),{spec:c,logger:l}=(0,j.r)(ae.p,{}),u=(0,n.useCallback)((()=>{const{interactionId:e}=l.logInteraction(function(e,t,i){let n;return n=t===f.zP.CONNECTING?e.connectingButtonFactory():t===f.zP.CONNECTED?e.connectedButtonFactory():e.notConnectedButtonFactory(),i?n.hitUiHide():n.hitUiReveal()}(c,i,s));r(e)}),[i,r,s,c,l]),{currentDevice:m}=(0,Oe.l)(),{isLocal:g}=m,p=(0,n.useMemo)((()=>(0,N.tf)(e,t,g?a:null)),[a,g,t,e]);return(0,v.jsx)(_e,{children:(0,v.jsx)(H.f,{isActive:s,disabled:!o,onToggle:u,label:d.Ru.get("playback-control.connect-picker"),icon:p})})};var Ue=i(29457),Me=i(64232),ze=i(66108),Ve=i(39736),Ge=i(30767),Qe=i(27766);const Ke=ze.$S.PUFFIN_BUTTON_CLICK,qe=ze.$S.DEVICE_PICKER_BUTTON_CLICK,He=()=>{const{isPuffinPanelActive:e}=(0,Qe.c)(),{isActive:t,panelSend:i}=(0,Me.AI)(Ve.Z.DevicePicker,Ve.Z.DevicePickerOverlay),a=(0,Me.Ev)(Ke),{remoteDeviceType:o,remoteDeviceisGroup:s}=(0,E.v)((e=>{const t=(0,D.V)(e);return{remoteDeviceType:t.remoteDevice?.type,remoteDeviceisGroup:t.remoteDevice?.isGroup}}),R.a),r=(0,oe.g)(),c=r?.audioDevice.terminalType===Ae.FI.HEADPHONES,l=(0,Ge.K)(),u=t||e,m=l||c,{currentDevice:g}=(0,Oe.l)(),{isLocal:p}=g,b=(0,n.useMemo)((()=>l?Ue.C:(0,N.tf)(o,s,p?r:null)),[r,l,s,o,p]);return(0,v.jsx)(H.f,{isActive:u,isActiveNoIndicator:m,onToggle:()=>{const e=t;i(qe),e||(0,C.I)("DEVICE-PICKER")},label:d.Ru.get("playback-control.connect-picker"),icon:b,disabled:!a,restoreFocusKey:e?Ve.Z.Puffin:Ve.Z.DevicePicker})};var We=i(89040),Ye=i(94705);const Ze=()=>{const{isAnonymous:e}=(0,s.d4)(Ye.Ht),t=(0,We.v)();return e?null:t?(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(He,{})}):(0,v.jsx)(Fe,{})};var Xe=i(4881),Je=i(73832),$e=i(96859),et=i(77029),tt=i(45005),it=i(23605),nt=i(14413),at=i(15113);const ot=n.memo((({onClick:e,className:t,isActive:i,isEnabled:n})=>{const a=n?d.Ru.get("web-player.lyrics.title"):d.Ru.get("web-player.lyrics.noLyrics1"),o=n?e:void 0;return(0,v.jsx)(H.f,{className:t,isActive:i,onToggle:o,disabled:!n,label:a,testId:"lyrics-button",icon:et.q})})),st=n.memo((e=>{const t=Boolean((0,at.J)().data?.hasLyrics);return(0,v.jsx)(ot,{...e,isEnabled:t,isActive:!1})})),rt=n.memo((e=>{const t=(0,te.o)((e=>e?.item?.uri)),i=Boolean((0,nt.f)(t).hasLyrics);return(0,v.jsx)(ot,{...e,isEnabled:i,isActive:!1})})),ct=n.memo((e=>{const t=(0,Xe.S)(),{currentVariant:i}=(0,Je.r)(),{isActiveNotCinemaMode:n}=(0,it.$)(),{isAnonymous:a}=(0,s.d4)(Ye.Ht),o=(0,z.NC)($.khs),r=(0,te.o)((e=>{if(e?.item?.uri&&(0,tt.U_m)(e?.item?.uri)){return!Boolean(e?.item?.metadata?.["segment.index"])}return!1}));if(a||!r)return null;const c=t===Z.z.NOW_PLAYING_VIEW&&"lyrics"===i,l=n||c;return l?(0,v.jsx)(ot,{...e,isActive:l,isEnabled:!0}):o?(0,v.jsx)(st,{...e}):(0,v.jsx)(rt,{...e})}));var lt=i(36360);const ut=({onClick:e,className:t})=>{const i=(0,Xe.S)(),{currentVariant:n,previousVariant:a}=(0,Je.r)(),o=(0,$e.F)(),{toggleLyrics:s}=(0,lt.A)({onChange:e,referrer:"now_playing_bar"}),r=i===Z.z.NOW_PLAYING_VIEW;return(0,v.jsx)(ct,{onClick:r?()=>{o("lyrics"===n?a??"artwork":"lyrics")}:s,className:t})};var dt=i(94146),mt=i(5106),gt=i(57160);const pt=ze.$S.NPV_BUTTON_CLICK,vt=({onClick:e})=>{const{isActive:t,panelSend:i}=(0,Me.AI)(Ve.Z.NowPlayingView),n=(0,Me.Ev)(pt),{mode:a,setMode:o}=(0,mt.r)(),s=(0,z.NC)($.ZDY),r=(0,Xe.S)(),c=(0,X.l)(),{item:l}=(0,te.o)((e=>({item:e?.item})),((e,t)=>e.item?.uri===t.item?.uri)),u=!l||!n,m=r===Z.z.NOW_PLAYING_VIEW;if(s)return null;const g=t&&!m;return(0,v.jsx)(H.f,{isActive:g,disabled:u,onToggle:()=>{e?.(!t),m?((0,C.I)("NPV_OPEN_CINEMA_MODE_BUTTON"),c(Z.z.CLOSED),t||i(pt)):i(pt),a===gt.YU.cinema&&o(gt.YU.npv)},icon:dt.d,label:d.Ru.get("web-player.now-playing-view.label"),testId:"control-button-npv",restoreFocusKey:Ve.Z.NowPlayingView})};var bt=i(85387),yt=i(55312),ht=i(29111),kt=i(90303),Ct=i(20535),xt=i(33924),Nt=i(48540),ft=i(77342);const jt=({uri:e,to:t,children:i,onDrop:a,onNavigate:o,className:r})=>{const[c,l]=(0,n.useState)(!1),u=(0,n.useRef)(null),d=(0,xt.g)(),m=(0,s.wA)(),g=(0,Nt.f)(),p=(0,ft.g)(),b=(0,xe.z)(),y=function(e){const t=(0,tt.o_h)(e),i=(0,s.d4)(Ye.F6);switch(t?.type){case tt.NQG.PLAYLIST:case tt.NQG.PLAYLIST_V2:{let e;if((0,tt.iwx)(t)&&(e=t.username),i&&e===i)return[Ct.Ay[tt.NQG.TRACK],Ct.Ay[tt.NQG.LOCAL],Ct.Ay[tt.NQG.ALBUM]];break}case tt.NQG.COLLECTION:return[Ct.Ay[tt.NQG.TRACK],Ct.Ay[tt.NQG.ALBUM],Ct.Ay[tt.NQG.ARTIST],Ct.Ay[tt.NQG.PLAYLIST],Ct.Ay[tt.NQG.PLAYLIST_V2],Ct.Ay[tt.NQG.SHOW]];case tt.NQG.QUEUE:return[Ct.Ay[tt.NQG.TRACK],Ct.Ay[tt.NQG.LOCAL],Ct.Ay[tt.NQG.EPISODE]];default:return[]}return[]}(e),h=!!y.length;return(0,n.useEffect)((()=>(c?u.current=window.setTimeout((()=>{(0,tt.U_m)(e)||(o?.(),d(t||(0,tt.o_h)(e).toURLPath(!0)))}),1e3):!c&&u.current&&clearTimeout(u.current),()=>{u.current&&clearTimeout(u.current)})),[c,e,t,o,d]),h?(0,v.jsx)(kt.A,{types:y,onDrop:t=>{const i=(0,tt.o_h)(e),n=Array.from(t.dataTransfer.types).find((e=>y.includes(e))),o=n&&t.dataTransfer.getData(n),s=o&&o.split("\n")[0],r=(0,tt.o_h)(s);if(r&&i)switch(a?.(r.toURI()),i.type){case tt.NQG.PLAYLIST:case tt.NQG.PLAYLIST_V2:m((0,ht.io)(e,[r.toURI()]));break;case tt.NQG.COLLECTION:(0,tt._Tv)(r)||(0,tt.ecE)(r)||(0,tt.U_m)(r)?g.add({uris:[r.toURI()]}):(0,tt.tbX)(r)?p.add([r.toURI()],{before:"start"}):(0,tt.WB1)(r)&&g.add({uris:[r.toURI()]});break;case tt.NQG.QUEUE:b.addToQueue([{uri:r.toURI(),uid:null}])}},onDragEnter:()=>{l(!0)},onDragLeave:()=>{l(!1)},className:r,children:i}):(0,v.jsx)("div",{children:i})};var It=i(92915);function At({style:e,active:t,disabled:i,intent:a,label:o,labelActive:s,icon:r,iconActive:c,className:l,onClick:u}){const[d,m]=(0,n.useState)(!1),g=(0,It.W)(),p=t&&s?s:o,b=t&&c?c:r;return(0,v.jsx)(H.f,{style:e,className:l,isActive:t,disabled:i,onToggle:e=>{u?.(),d||e.target.blur(),m(!1),a&&g({type:"click",intent:a,targetUri:""})},onKeyDown:({key:e})=>{"enter"===e.toLowerCase()&&m(!0)},label:p,icon:b,testId:`control-button-${a}`})}var St=i(34506),Pt=i(21709),wt=i(87761),Tt=i(34988);const Dt=()=>{const{isAnonymous:e}=(0,s.d4)(Ye.Ht),{videoPlayerMode:t}=(0,Pt.d)();return e||t===wt.Kz.cinemaLegacy?{isVisible:!1}:{isVisible:!0,isEnabled:!0}},Et=({onClick:e})=>{const{isEnabled:t,isVisible:i}=Dt(),a=(0,bt.zy)(),o=(0,Tt.J)(),s=(0,xt.g)(),r=(0,n.useMemo)((()=>"/queue"===a.pathname||"/history"===a.pathname),[a.pathname]),c=(0,n.useCallback)((()=>{const t=o.entries?.slice(0,o.index+1)?.reverse()?.findIndex((({pathname:e})=>"/queue"!==e&&"/history"!==e));e({mode:"main",route:null}),s(-1===t?"/":t>=0?-t:-1)}),[s,o,e]),l=(0,n.useCallback)((()=>{e({mode:"main",route:"/queue"}),s("/queue",{state:{referrer:"now_playing_bar"}})}),[e,s]),u=(0,n.useCallback)((()=>{t&&(r?c():l())}),[t,r,c,l]);return i?(0,v.jsx)(jt,{uri:"spotify:queue",children:(0,v.jsx)(At,{intent:"queue",icon:yt.j,label:d.Ru.get("playback-control.queue"),onClick:u,active:r,disabled:!t})}):null},Bt=ze.$S.QUEUE_BUTTON_CLICK,Rt=({onClick:e})=>{const{isEnabled:t,isVisible:i}=Dt(),a=(0,Me.Ev)(Bt),{isActive:o}=(0,Me.AI)(Ve.Z.Queue,Ve.Z.QueueOverlay),{toggleQueue:s}=(0,St.R)(),r=(0,n.useCallback)((()=>{t&&(e({mode:"panel",aboutToShow:!o}),s())}),[t,e,o,s]);return i?(0,v.jsx)(jt,{uri:"spotify:queue",children:(0,v.jsx)(H.f,{icon:yt.j,label:d.Ru.get("playback-control.queue"),onToggle:r,isActive:o,disabled:!t||!a,testId:"control-button-queue",restoreFocusKey:Ve.Z.Queue})}):null},Lt=({onClick:e})=>(0,z.NC)($.eWj)?(0,v.jsx)(Rt,{onClick:e}):(0,v.jsx)(Et,{onClick:e});var _t=i(84178),Ot=i(87009),Ft=i(81353);const Ut=({onClick:e})=>{const{item:t}=(0,Ot.L)()??{},{isActive:i,onClick:n,showButton:a}=(0,Ft.D)({item:t,onClick:e});return t&&a?(0,v.jsx)(H.f,{isActive:i,onToggle:n,label:i?d.Ru.get("miniplayer.close"):d.Ru.get("miniplayer.open"),icon:_t.F,testId:"pip-toggle-button"}):null};var Mt=i(79105),zt=i(96932);const Vt="mwpJrmCgLlVkJVtWjlI1",Gt="Xmv2oAnTB85QE4sqbK00",Qt="ExuDUBJ7bk8vT6INnm9F",Kt=()=>{const e=(0,z.NC)($.L$q),{setVideoPlayerUIFlag:t,videoPlayerMode:i}=(0,Pt.d)(),{spec:a,logger:o,UBIFragment:s}=(0,j.r)(V.h9,{data:{identifier:i===wt.Kz.cinemaLegacy?V.gw.CINEMA:V.gw.DESKTOP}}),r=(0,M.YQ)((e=>{o.logInteraction(a.volumeBarFactory().dragSetVolume({newVolumePercentage:Math.floor(100*e)}))}),500,{leading:!1,trailing:!0}),c=(0,n.useCallback)((e=>{e&&t(wt.nP.cinemaLegacy,!1)}),[t]);return(0,v.jsx)(s,{spec:a,children:(0,v.jsxs)("div",{className:Vt,children:[(0,v.jsx)(zt.mA,{onClick:()=>{o.logInteraction(a.djJumpButtonFactory().hitRefreshContent())}}),(0,v.jsx)(vt,{onClick:e=>{e?o.logInteraction(a.npvButtonFactory().hitUiReveal()):o.logInteraction(a.npvButtonFactory().hitUiHide())}}),e===$.vkU.CONTROL&&(0,v.jsx)(ut,{className:Gt,onClick:e=>{e?o.logInteraction(a.lyricsButtonFactory().hitUiNavigate({destination:e})):o.logInteraction(a.lyricsButtonFactory().hitUiNavigateBack())}}),(0,v.jsx)(Lt,{onClick:e=>{"main"===e.mode?e.route?o.logInteraction(a.queueButtonFactory().hitUiNavigate({destination:e.route})):o.logInteraction(a.queueButtonFactory().hitUiNavigateBack()):e.aboutToShow?o.logInteraction(a.queueButtonFactory().hitUiReveal()):o.logInteraction(a.queueButtonFactory().hitUiHide())}}),(0,v.jsx)(Ze,{}),(0,v.jsx)(Mt.M,{className:Qt,onVolumeBarClick:e=>{o.logInteraction(a.volumeBarFactory().hitSetVolume({newVolumePercentage:Math.floor(100*e)}))},onToggleMuteClick:e=>{"muted"===e?o.logInteraction(a.volumeMuteButtonFactory().hitMutePlayback()):"not_muted"===e&&o.logInteraction(a.volumeMuteButtonFactory().hitUnmutePlayback())},onVolumeBarDrag:r}),(0,v.jsx)(Ut,{onClick:c}),(0,v.jsx)(ne,{className:"control-button",disabledClassName:"control-button--disabled",onClick:e=>{e&&o.logInteraction(a.fullscreenButtonFactory().hitUiReveal())}})]})})};var qt=i(63409),Ht=i(95867),Wt=i(1263);const Yt="yyrJTUPMeLS8qs1a0YJr",Zt=({logoUrl:e})=>e?(0,v.jsx)("div",{className:Yt,"data-testid":"context-ad-logo",children:(0,v.jsx)(Ht.N,{loading:"eager",imgSrc:e,width:56,height:56,type:Wt.c.AD})}):null;var Xt=i(5888),Jt=i(11440),$t=i(30275);const ei=({item:e,context:t,index:i})=>{const{logoImage:n}=(0,Xt.b)(e);return(0,v.jsx)($t.e,{item:e,context:t,index:i,"aria-label":d.Ru.get("ad-formats.advertisement"),adEventReason:Jt.c.AD_LOGO,isVisible:!1,children:(0,v.jsx)(Zt,{logoUrl:n})})};var ti=i(62108),ii=i(19792);const ni=n.memo((function({uri:e,className:t,onClick:i,size:a=ti.t.xs}){const[o,s]=(0,ii.A)(e),r=(0,It.W)(),c=(0,n.useCallback)((t=>{t.preventDefault(),r({targetUri:e,intent:o?"remove-from-library":"add-to-library",type:"click"}),i&&i(!o),s(!o)}),[r,e,o,i,s]);return(0,v.jsx)(ti.M,{className:t,size:a,onClick:c,isAdded:!!o,condensed:!0})}));var ai=i(27149),oi=i(76540),si=i(52697);const ri=({uri:e,isBook:t=!1,size:i=ti.t.xs,className:a,onClick:o})=>{const{isPreSaved:s,addPresave:r,removePresave:c}=(0,si.w)({uri:e,isBook:t}),l=(0,n.useCallback)((()=>{s?c():r(),o?.(!s)}),[s,o,c,r]);return(0,v.jsx)(ti.M,{className:a,size:i,onClick:l,isAdded:!!s,condensed:!0})};var ci=i(45944),li=i(56526),ui=i(59756),di=i(45664),mi=i(47290),gi=i(31817),pi=i(70725),vi=i(88992),bi=i(65703),yi=i(37639),hi=i(12689);function ki(e){return(0,hi.v)(e)||(0,yi.p)(e)}const Ci=ze.$S.NPV_BUTTON_CLICK,xi=()=>{const e=(0,X.l)(),t=(0,z.NC)($.mzn),i=(0,z.NC)($.wZE),a=(0,Xe.S)(),o=(0,Me._Y)();return(0,n.useCallback)((()=>{t?a===Z.z.CLOSED?i?e(Z.z.NOW_PLAYING_VIEW):o(Ci):e(Z.z.CLOSED):o(Ci)}),[i,a,t,o,e])};var Ni=i(72382),fi=i(17998),ji=i(15845);const Ii="deomraqfhIAoSB3SgXpu",Ai="ZbFkATBbLkWh2SHMXDt6",Si="IcyWfMS5VkeOhaI7OWIx",Pi="BFR9Zt3zpL8BATBMiwQB",wi="j96cpCtZAIdqxcDrYHPI",Ti="HD9s7U5E1RLSWKpXmrqx",Di=({spec:e})=>{const t=(0,ji.s)(),i=(0,Ot.L)(),{draggable:a,onDragStart:o}=(0,fi.P)(),s=(0,Xe.S)(),{isActive:r}=(0,Me.AI)(Ve.Z.NowPlayingView),c=(0,z.NC)($.mzn),l=xi(),{images:u}=(0,Ni.u)(i?.item),m=c?s===Z.z.NOW_PLAYING_VIEW:r,g=(0,n.useCallback)((()=>{l();const i=m?e.hitUiHide():e.hitUiReveal();t.logInteraction(i)}),[m,t,e,l]);if(null===i)return null;const{context:p,item:b}=i;return(0,v.jsx)(mi.h,{menu:(0,v.jsx)(pi.W,{context:p,item:b}),children:(0,v.jsx)("div",{draggable:a&&ki(b),onDragStart:e=>{o(e,{itemUris:[b.uri],dragLabelText:(0,bi.r)(b)})},children:(0,v.jsx)(vi.R,{uri:p.uri,owner:p.metadata?.context_owner,children:(0,v.jsx)("button",{type:"button","data-testid":"cover-art-button",className:Ti,"aria-label":d.Ru.get("web-player.now-playing-view.label"),onClick:g,children:(0,v.jsx)(gi.b,{images:u,type:b.type,size:56,maxSize:56,className:Pi})})})})})};var Ei=i(31369),Bi=i(72152),Ri=i(64671),Li=i(86871);const _i="GQ5_gIWzIqAfBdmQm8yJ",Oi="_9sCL61nGvQFXv2u02jXw",Fi=ze.$S.NPV_BUTTON_CLICK,Ui=({children:e,className:t,spec:i})=>{const a=(0,ji.s)(),s=(0,Me.Ev)(Fi),r=(0,Xe.S)(),{isActive:c}=(0,Me.AI)(Ve.Z.NowPlayingView),l=(0,z.NC)($.mzn),u=(0,z.NC)($.wZE),m=xi(),g=(0,n.useMemo)((()=>{if(l&&u){const e=r===Z.z.NOW_PLAYING_VIEW;return{label:e?d.Ru.get("web-player.cinema-mode.minimize"):d.Ru.get("web-player.now-playing-view.cinema-mode.expand"),Icon:e?Ei.b:G.L,isActive:e,isDisabled:!1}}return{label:c?d.Ru.get("npb.collapseCoverArt"):d.Ru.get("npb.expandCoverArt"),Icon:c?Bi.r:Ri.o,isActive:c,isDisabled:!s}}),[u,s,r,l,c]),p=(0,n.useCallback)((()=>{m();const e=i.coverartArrowFactory(),t=g.isActive?e.hitUiHide():e.hitUiReveal();a.logInteraction(t)}),[a,i,g.isActive,m]);return(0,v.jsxs)("div",{"data-testid":"CoverSlotCollapsed__container",className:o()(_i,t),children:[e,(0,v.jsx)(Li.Zp,{label:g.label,children:(0,v.jsx)("button",{className:o()(Oi),disabled:g.isDisabled,onClick:p,"aria-label":g.label,"aria-pressed":g.isActive,children:(0,v.jsx)(g.Icon,{iconSize:16})})})]})};var Mi=i(63586),zi=i(38439),Vi=i(4136);var Gi=i(78544),Qi=i(87565),Ki=i(49873),qi=i(63365),Hi=i(55),Wi=i(4945),Yi=i(16859),Zi=i(43943);const Xi=({context:e,item:t,onLike:i})=>{const n=(0,Ki.X)(),a=(0,li.v)(t);if(n&&(0,Qi.N)(t))return(0,v.jsx)(Gi.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0});if(a)return(0,v.jsx)(ci.g,{uri:t.uri,condensed:!0});if((0,hi.v)(t))return t.isLocal?null:(0,v.jsx)(oi.b,{uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,yi.p)(t))return(0,v.jsx)(ai.b,{condensed:!0,uri:t.uri,className:"control-button control-button-heart",onClick:i});if((0,Hi.d)(t)){return"trailer"===t?.metadata?.type&&"true"===t?.metadata?.is_pre_release?(0,v.jsx)(ri,{uri:t.book.uri,isBook:!0,className:"control-button control-button-heart",onClick:i}):(0,v.jsx)(ni,{uri:t.book.uri,className:"control-button control-button-heart",onClick:i})}return(0,qi.N)(t)||(0,Wi.v)(t)?null:(0,Zi.d)(t)},Ji=({state:{item:e,context:t,index:i}})=>{!function(e){const t=(0,Vi.i)(),i=(0,zi.X)(e);(0,n.useEffect)((()=>{i&&t.say(i)}),[i,t])}(e);const{videoPlayerMode:a,setVideoPlayerUIFlag:o}=(0,Pt.d)(),{spec:s,logger:r}=(0,j.r)(qt.p6,{data:{identifier:a===wt.Kz.cinemaLegacy?qt.gw.CINEMA:qt.gw.DESKTOP}}),c=(0,zi.P)(e),l=(0,z.NC)($.WAA);(0,n.useEffect)((()=>{o(wt.nP.nowPlayingBar,l)}),[l,o]);const u=a===wt.Kz.nowPlayingBar&&l,d=(0,n.useMemo)((()=>s.coverartFactory({uri:e.uri})),[e.uri,s]);return(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)("div",{"data-testid":"now-playing-widget",className:Ii,role:"contentinfo","aria-label":c,children:(0,v.jsxs)(Yi.r,{spec:s,children:[(0,qi.N)(e)?(0,v.jsx)(ei,{item:e,context:t,index:i}):(0,v.jsxs)(Ui,{className:Si,spec:d,children:[!u&&(0,v.jsx)(Di,{spec:d}),l&&(0,v.jsx)("div",{id:"VideoPlayerNpb_ReactPortal"})]}),(0,v.jsx)(ui.d,{context:t,className:wi,item:e,size:"xsmall",enableVideoButton:!0,onTitleClick:t=>{r.logInteraction(s.titleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},onSubtitleClick:t=>{r.logInteraction(s.subtitleFactory({uri:e.uri}).hitUiNavigate({destination:t||""}))},referrer:di.G.NPB}),(0,v.jsxs)("div",{className:Ai,children:[(0,v.jsx)(Mi.a,{context:t,item:e,onClick:()=>{r.logInteraction(s.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:e.uri,contextUri:t.uri}))}}),(0,v.jsx)(Xi,{item:e,onLike:t=>{r.logInteraction(t?s.likeButtonFactory({uri:e.uri}).hitLike({itemToBeLiked:e.uri}):s.likeButtonFactory({uri:e.uri}).hitRemoveLike({itemNoLongerLiked:e.uri}))},context:t})]})]})})})},$i=()=>{const e=(0,Ot.L)();return null===e?(0,v.jsx)("div",{className:o()("now-playing")}):(0,v.jsx)(Ji,{state:e})};var en=i(22682);const tn="aguQsGoZR9wZeawKGdDh",nn="ieqOSqJb6kk3bG5XDOHk",an=({paused:e,fromSeconds:t})=>{const[i,a]=(0,n.useState)(t);return(0,en.$)((t=>{a((i=>e?i:i>0?i-1:(t(),i)))}),1e3),(0,v.jsxs)("div",{className:tn,children:[d.Ru.get("ad-formats.skippable_ads.skip_countdown"),(0,v.jsx)("span",{className:nn,children:i})]})};var on=i(98207);const sn=({children:e})=>{const t=(0,te.o)((e=>e),((e,t)=>(0,R.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),i=t?.restrictions.disallowSkippingNextReasons.includes("ad_disallow"),n=t?.isPaused??!1,a=(0,on.qc)(t),o=(0,on.Tv)(t),r=(0,s.d4)((e=>a?e?.ads?.audio?.info?.skippableAdDelaySeconds:o?e?.ads?.vto?.info?.skippableAdDelaySeconds:void 0));return i&&r?(0,v.jsx)(an,{paused:!!n,fromSeconds:r}):(0,v.jsx)(v.Fragment,{children:e})};var rn=i(76236),cn=i(29012);var ln=i(81421),un=i(45127);const dn=e=>{const[t,i]=(0,n.useState)(new Map),[a,o]=(0,n.useState)(),s=(0,ln.L)(),r=(0,cn.mr)(),{currentDevice:c}=(0,Oe.l)(),l=(0,un.vh)(),u=(0,n.useCallback)((()=>{if(!e)return;const n=(({lastRecordedItem:e,setLastRecordedItem:t,recentAds:i,setRecentAds:n,playerStateItem:a,currentDevice:o})=>{let s={isMissingAdData:!1};if(a&&a.uri!==e?.uri){if(e?.type===Wt.c.AD){const t=e?.uri.split(":")[2];i.has(t)?n((e=>{const i=new Map(e);return i.delete(t),i})):s={isMissingAdData:!0,errorMessage:o.isLocal?"primary_device":"secondary_device",adId:t}}t((()=>a))}return s})({lastRecordedItem:a,setLastRecordedItem:o,recentAds:t,setRecentAds:i,playerStateItem:s?.item,currentDevice:c});if(n.isMissingAdData){const{errorMessage:e,adId:t}=n;l.send((0,rn.G)({error_type:"missing_ad_data",error_message:e,slot:"stream",ad_id:t}))}}),[s,a,t,l,c,e]),d=(0,n.useCallback)((()=>{e&&r&&i((e=>{let i=e;return t.has(r.adId)||(i=new Map(e).set(r.adId,r)),i}))}),[t,r,e]);(0,n.useEffect)((()=>{u()}),[u]),(0,n.useEffect)((()=>{d()}),[d])};var mn=i(7605),gn=i(65762),pn=i(9999),vn=i(78875),bn=i(59327),yn=i(24897),hn=i(69515),kn=i(8555),Cn=i(62727),xn=i(40275);const Nn="gItY2hnfCB4TsDJCkPiO",fn="XrZ1iHVHAPMya3jkB2sa",jn="NKUrT1GciYXAEEUtagN1",In="Qt226Z4rBQs53aedRQBQ",An=(0,n.memo)((function({item:e}){const t=vn.Q.isPodcastAd(e),i=vn.Q.isSurveyAd(e);return(0,v.jsxs)("div",{"data-testid":"ad-controls",className:fn,children:[(0,v.jsxs)("div",{className:jn,children:[t&&(0,v.jsx)(xn.w,{}),(0,v.jsx)(pn.T,{item:e,isDisabled:i}),t?(0,v.jsx)(yn.h,{}):(0,v.jsx)(kn.d,{})]}),(0,v.jsx)(bn.x,{}),(0,v.jsxs)("div",{className:In,children:[t?(0,v.jsx)(hn.v,{}):(0,v.jsx)(sn,{children:(0,v.jsx)(Cn.$,{})}),(0,v.jsx)(gn.t,{item:e,isDisabled:i})]})]})}));var Sn=i(64351),Pn=i(9644),wn=i(45105),Tn=i(84010),Dn=i(25945),En=i(16440);var Bn=i(19892),Rn=i(38514),Ln=i(9886);const _n="JbGNL7qsnWz6EP_3hGvf",On="mkROcxw9LM6F2uuwQYjN",Fn=e=>{const{className:t,...i}=e;return(0,v.jsx)("span",{className:On,children:(0,v.jsx)(Ln.x,{className:o()(t),...i})})};var Un=i(84206),Mn=i(23310),zn=i(62316),Vn=i(28861),Gn=i(14073),Qn=i(9466),Kn=i(60902);const qn=function({setSleepTimer:e,state:t}){const i=t.type===Gn.k.Off?Vn.X:Vn.X.concat(Gn.k.Off);return(0,v.jsxs)(Un.W,{children:[(0,v.jsx)(Mn.y,{children:d.Ru.get("web-player.sleep-timer.player-controls.popover.title")}),(0,v.jsx)("div",{children:i.map((i=>(0,v.jsx)(zn.D,{onClick:()=>{e(i)},"data-testid":`playback-sleep-timer-option-${i}`,role:"menuitemradio","aria-label":`${i}`,"aria-checked":t.type===i,children:t.type===i?(0,Kn.J)(i,t.endsAt,Wt.c.EPISODE):(0,Qn.p)(i,Wt.c.EPISODE)},i)))})]})};var Hn=i(74891);const Wn=e=>e-Date.now(),Yn=({endsAt:e})=>{const[t,i]=(0,n.useState)(Wn(e));return(0,n.useEffect)((()=>{i(Wn(e));const t=setInterval((()=>{i(Wn(e))}),1e3);return()=>{clearInterval(t)}}),[e]),(0,v.jsx)(l.E,{variant:"marginal",semanticColor:"textBrightAccent",children:(0,Hn.f)(t)})};var Zn=i(2388);const Xn=({onClick:e})=>{const t=(0,z.NC)($.GhO),[i,n]=(0,Zn.y)(),a=i.type!==Gn.k.Off,{endsAt:o}=i;return t?(0,v.jsx)(Rn.t,{placement:"top-start",menu:(0,v.jsx)(qn,{state:i,setSleepTimer:t=>{n(t),e?.(t)}}),children:(e,t,i)=>(0,v.jsx)(Li.Zp,{label:d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),children:(0,v.jsx)(ce.H,{ref:i,className:_n,iconLeading:a?Fn:Bn.l,size:"small",onClick:t,role:"checkbox","aria-label":d.Ru.get("web-player.sleep-timer.player-controls.button.tooltip"),"data-testid":"control-button-sleep-timer","aria-checked":a,semanticColor:a?"textBrightAccent":void 0,children:a&&o&&(0,v.jsx)(Yn,{endsAt:o})})})}):null};var Jn=i(26691),$n=i(25234);const ea=(0,n.memo)((function({isPreview:e}){const{logChangePlaybackSpeed:t,logChangeRepeatMode:i,logChangeShuffleMode:a,logSeekForward:o,logSeekBack:s,logSkipForward:r,logSkipBack:c,logPlayPause:l,logProgressChanged:u,spec:m}=(()=>{const e=(0,xe.z)(),{videoPlayerMode:t}=(0,Pt.d)(),{spec:i,logger:a}=(0,j.r)(Tn.kD,{data:{identifier:t===wt.Kz.cinemaLegacy?Tn.gw.CINEMA:Tn.gw.DESKTOP}});return{logChangePlaybackSpeed:(0,n.useCallback)((t=>{const n=e.getState();n?.item&&a.logInteraction(i.speedControlButtonFactory().hitSetPlaybackSpeed({currentlyPlayedItem:n.item.uri,playbackSpeed:t}))}),[a,e,i]),logChangeShuffleMode:(0,n.useCallback)((e=>{a.logInteraction(e?i.shuffleButtonFactory().hitShuffleEnable():i.shuffleButtonFactory().hitShuffleDisable())}),[a,i]),logChangeRepeatMode:(0,n.useCallback)((e=>{const t={[Dn.p.REPEAT_NONE]:i.repeatButtonFactory().hitRepeatDisable(),[Dn.p.REPEAT_TRACK]:i.repeatButtonFactory().hitRepeatOneEnable(),[Dn.p.REPEAT_CONTEXT]:i.repeatButtonFactory().hitRepeatEnable()};a.logInteraction(t[e])}),[a,i]),logSeekBack:(0,n.useCallback)((e=>{a.logInteraction(i.seekBackButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,i]),logSeekForward:(0,n.useCallback)((e=>{a.logInteraction(i.seekForwardButtonFactory().hitSeekByTime({msSeekedOffset:e}))}),[a,i]),logSkipBack:(0,n.useCallback)((()=>{const t=e.getState();t&&a.logInteraction(i.previousButtonFactory().hitSkipToPrevious({itemToBeSkipped:t.item?.uri||"",positionMs:(0,En.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,i]),logSkipForward:(0,n.useCallback)((()=>{const t=e.getState();t?.item&&a.logInteraction(i.nextButtonFactory().hitSkipToNext({itemToBeSkipped:t.item.uri,positionMs:(0,En.s)(t)??-1,totalContentMs:t.duration??-1}))}),[a,e,i]),logPlayPause:(0,n.useCallback)((t=>{const n=e.getState();n?.item&&("resume"===t?a.logInteraction(i?.playPauseButtonFactory().hitResume({itemToBeResumed:n.item.uri})):"pause"===t&&a.logInteraction(i?.playPauseButtonFactory().hitPause({itemToBePaused:n.item.uri})))}),[a,e,i]),logProgressChanged:(0,n.useCallback)(((e,t)=>{switch(t){case"drag":return a.logInteraction(i.progressBarFactory().dragSeekToTime({msToSeekTo:e}));case"hit":return a.logInteraction(i.progressBarFactory().hitSeekToTime({msToSeekTo:e}));default:return(0,Zi.k)(t)}}),[a,i]),spec:i}})();dn((0,z.NC)($.KYh));const g=(0,te.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),p=(0,wn.p)();return(0,v.jsx)("div",{className:Nn,"data-testid":"player-controls",dir:"ltr","aria-label":d.Ru.get("playback-control.a11y.landmark-label"),children:(0,v.jsxs)(Yi.r,{spec:m,children:[(0,qi.N)(g)?(0,v.jsx)(An,{item:g}):(0,v.jsxs)("div",{className:fn,"data-testid":"general-controls",children:[(0,v.jsxs)("div",{className:jn,children:[p?(0,v.jsx)(xn.w,{onClick:t}):(0,v.jsx)($n.w,{renderEnabled:()=>(0,v.jsx)(Jn.a,{size:"small"}),renderDisabled:()=>(0,v.jsx)(Pn.u,{onClick:a})}),p&&(0,v.jsx)(yn.h,{onClick:s}),(0,v.jsx)(kn.d,{onClick:c})]}),(0,v.jsx)(bn.x,{onClick:l}),(0,v.jsxs)("div",{className:In,children:[(0,v.jsx)(sn,{children:(0,v.jsx)(Cn.$,{onClick:r})}),p?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(hn.v,{onClick:o}),(0,v.jsx)(Xn,{})]}):(0,v.jsx)(Sn.s,{onClick:i})]})]}),(0,v.jsx)(mn.x,{isPreview:e,onChange:u})]})})}));var ta=i(72308),ia=i(743),na=i(25219),aa=i(35827);const oa="yglmI5m3fCc8baD1Kwdw",sa="udArIAqnfUQPQew2VAns",ra="MWD1i_CSJ5N9wRBDpZmX",ca="k3NVrHXkbfflNdAxpT1_",la="m8UPWsNtWbdkvBNvqgBN",ua="aepuRyT82biv_XmkH1eS",da="snFK6_ei0caqvFI6As9Q",ma="sVv2OQORCQ4kf6iKfUTF",ga="pLifNBuHRY8cZkZyEqwL",pa="K7b2iysmIbvKo8RqRbc5",va="adzMqeRxU0__wQcuju5q",ba=(0,n.memo)((()=>{const{isAnonymous:e}=(0,s.d4)(Ye.Ht),t=(0,s.wA)(),i=(0,te.o)((e=>e),((e,t)=>e?.hasContext===t?.hasContext&&e?.item?.uri===t?.item?.uri)),a=(0,y.h)(),l=(0,te.o)((e=>(0,qi.N)(e?.item??void 0))),u=(0,n.useCallback)((e=>{e.stopPropagation(),t((0,c.Ai)())}),[t]),d=()=>(0,v.jsx)(ia.ql.Provider,{value:"now_playing_bar",children:(0,v.jsxs)("div",{className:e?ra:sa,children:[(0,v.jsx)("div",{className:da,children:(0,v.jsx)($i,{})}),(0,v.jsx)("div",{className:ma,children:(0,v.jsx)(n.Suspense,{fallback:null,children:(0,v.jsx)(ea,{isPreview:e})})}),(0,v.jsx)("div",{className:ga,children:(0,v.jsx)(Kt,{})})]})});return(0,v.jsx)(aa.P,{surface:na.u.NOW_PLAYING,children:(0,v.jsx)(ta.pZ,{value:"now-playing-bar",children:(0,v.jsxs)("footer",{className:o()(oa,pa,{[va]:a}),"data-testid":"now-playing-bar","data-testadtype":"ad-type-"+(l?"ad":"none"),children:[e?(0,v.jsx)(ta.pZ,{value:"preview-bar",children:(0,v.jsx)(b,{handleClick:u})}):null,e?(0,v.jsx)(r.A,{in:i?.hasContext??!1,timeout:200,classNames:{enter:ca,enterActive:la,enterDone:ua},children:d()}):d(),(0,v.jsx)(U,{})]})})})}))},11895:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(34945);const a=()=>{const{togglePanel:e,isActive:t}=(0,n.C)();return{isPickerOpen:t,triggerRef:{current:null},toggleDevicePicker(t){e(t)}}}},21899:(e,t,i)=>{i.d(t,{f:()=>m});var n=i(30758),a=i(97500),o=i.n(a),s=i(43409),r=i(86871);const c="KAZD28usA1vPz5GVpm63",l="RK45o6dbvO1mb0wQtSwq",u="EHxL6K_6WWDlTCZP6x5w";var d=i(86070);const m=(0,n.forwardRef)(((e,t)=>{const i=e.isActive??!1,n=o()(c,{[l]:i||e.isActiveNoIndicator,[u]:i},e.className);return(0,d.jsx)(r.Zp,{label:e.label,children:(0,d.jsx)(s.H,{ref:t,style:e.style,"aria-label":e.label,size:"small",className:n,disabled:e.disabled,iconOnly:e.icon,onClick:e.onToggle,"data-testid":e.testId,"data-active":i.toString(),"aria-pressed":i,"data-restore-focus-key":e.restoreFocusKey})})}))},23605:(e,t,i)=>{i.d(t,{$:()=>o});var n=i(85387);const a="/lyrics",o=()=>{const e=(0,n.zy)(),t=e.pathname.startsWith(a);return{isActive:t,isActiveNotCinemaMode:t&&(!e.state.cinemaState||"closed"===e.state.cinemaState),routeDestination:a}}},36360:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(85387),a=i(45005),o=i(23605),s=i(21709),r=i(87761),c=i(77908);function l({referrer:e,onChange:t}){const i=(0,n.Zp)(),{isActive:l,routeDestination:u}=(0,o.$)(),{setVideoPlayerUIFlag:d}=(0,s.d)(),m=(0,c.f)(),g=()=>{l||(d(r.nP.cinemaLegacy,!1),i(u,{state:{referrer:e}}),t?.(u))},p=()=>{if(l){const e=(0,a.o_h)(m.uri)?.toURLPath(!0)??"/";i(e),t?.(null)}};return{isActive:l,showLyrics:g,hideLyrics:p,toggleLyrics:()=>{l?p():g()}}}},45105:(e,t,i)=>{i.d(t,{p:()=>r});var n=i(92505),a=i(63365),o=i(55),s=i(37639);function r(){const e=(0,n.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));return(0,s.p)(e)||(0,o.d)(e)?"audio"===e.mediaType||"mixed"===e.mediaType:!!(0,a.N)(e)&&e.isPodcastAd}},52697:(e,t,i)=>{i.d(t,{w:()=>u});var n=i(30758),a=i(36748),o=i(79252),s=i(35953),r=i(74268),c=i(19813),l=i(3161);const u=({uri:e,isBook:t})=>{const{add:i,remove:u}=(0,c.p)("prerelease"),d=(0,r.o)("prerelease",[e]).at(0),{enqueueSnackbar:m}=(0,s.d)(),{spec:g,logger:p}=(0,l.r)(a.k,{data:{uri:e}});return{isPreSaved:d,addPresave:(0,n.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),await i(e),m(t?o.Ru.get("web-player.prerelease.audiobook_feedback_presaved"):o.Ru.get("web-player.prerelease.album_feedback_presaved"))}),[i,m,t,p,g,e]),removePresave:(0,n.useCallback)((async()=>{p.logInteraction(g.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),await u(e)}),[p,u,g,e])}}},81353:(e,t,i)=>{i.d(t,{D:()=>u});var n=i(30758),a=i(7391);var o=i(21709),s=i(87761),r=i(92915),c=i(41666),l=i(3161);const u=({item:e,onClick:t})=>{const i=(0,r.W)(),{capabilities:{isEnabled:u},isOpen:d,close:m,open:g,canOpen:p}=(0,c.H)(),{videoPlayerMode:v}=(0,o.d)(),{spec:b,logger:y}=(0,l.r)(a.h9,{data:{identifier:v===s.Kz.cinemaLegacy?a.gw.CINEMA:a.gw.DESKTOP}}),h=(0,n.useCallback)((()=>{let n;u&&(d?(m(),e?.uri&&y.logInteraction(b.pipButtonFactory({uri:e.uri}).hitUiHide()),n="close-picture-in-picture"):(g(),e?.uri&&(({spec:e,logger:t,uri:i})=>{const n=window.documentPictureInPicture;if(!n)return;const a=o=>{setTimeout((()=>{const n=o.window?.innerWidth,a=o.window?.innerHeight;if(!n||!a)return;const s=e.pipButtonFactory({uri:i}).hitUiOpenWindow({widthPx:n,heightPx:a});t.logInteraction(s)}),100),n.removeEventListener("enter",a)};n.addEventListener("enter",a)})({spec:b,logger:y,uri:e.uri}),n="show-picture-in-picture"),t?.(!d,e?.uri),i({type:"click",intent:n,targetUri:e?.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[m,u,d,e?.uri,y,t,i,g,b]);return{showButton:p,isActive:d,onClick:h}}}}]);
//# sourceMappingURL=dwp-now-playing-bar.js.map