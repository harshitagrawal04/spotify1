"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3890],{17478:(a,e,t)=>{t.r(e),t.d(e,{default:()=>T});var r=t(30758),n=t(62411),i=t(85387),c=t(45005),o=t(79252),s=t(30618),d=t(76600),u=t(33924),l=t(94705),k=t(33031),f=t(65882),m=t(14910),b=t(84785),g=t(86070);const p=r.memo((function(){const a=(0,u.g)(),e=(0,i.zy)(),t=(0,m.m)(),p=(0,f.z)(),{trackId:T=""}=(0,i.g)(),{isAnonymous:y}=(0,n.d4)(l.Ht),h=(0,r.useMemo)((()=>new URLSearchParams(e.search)),[e.search]),U=h.get("context")||"",_=(0,c.Mce)(T).toURI(),I=(0,d.J)({uri:_},{gcTime:30*k.i}),x="Track"===I.data?.trackUnion.__typename&&I.data?.trackUnion?.playability.playable,O=(0,r.useCallback)(((e,t,r)=>{const n=p.getState(),i=(0,c.o_h)(t||e)?.toURLPath(!0);h.delete("context");const o=h.toString()?`&${h.toString()}`:"",s=`${i}?highlight=${_}${o}`;if(y)a(s);else{if((!n||n.isPaused)&&x){const a=Number.isInteger(r)&&void 0!==r?{skipTo:{index:r}}:void 0;p.play({uri:e},{featureIdentifier:"track",referrerIdentifier:p.getReferrer()},a)}a(s,{replace:!0})}}),[p,h,_,y,a,x]),v=(0,r.useCallback)((a=>{if("Track"!==a.__typename)return;const e="Track"===a.associationsV3?.audioAssociations?.items[0]?.trackAudio?.data.__typename?a.associationsV3.audioAssociations.items[0].trackAudio?.data:null;if(e&&e.albumOfTrack){const a=e.albumOfTrack,t=(a.tracks?.items??[]).findIndex((a=>a.track.uri===e.uri));return void O(_,e.albumOfTrack.uri,t)}const t=a.albumOfTrack,r=(t?.tracks?.items??[]).findIndex((e=>e.track.uri===a.uri));O(_,t?.uri,r)}),[O,_]),w=(0,r.useCallback)((()=>{if(!I.loading&&I.data?.trackUnion&&"Track"===I.data.trackUnion.__typename){if(I.data.trackUnion.mediaType===b.IX.Video)return void v(I.data.trackUnion);const a=(I.data.trackUnion.albumOfTrack?.tracks?.items??[]).findIndex((a=>a.track.uri===_));a>=0&&O(I.data.trackUnion.albumOfTrack?.uri||"",I.data.trackUnion.albumOfTrack?.uri||"",a)}}),[O,v,I,_]);return(0,r.useEffect)((()=>{const a=(0,c.tbX)(U);U&&a?t.getContents(U).then((a=>{const e=a.items.findIndex((a=>a?.uri===_));e<0?w():O(U,U,e)})):w()}),[U,w,O,t,_]),I.loading||I.error||"Track"!==I.data?.trackUnion?.__typename?(0,g.jsx)(s.LoadingPage,{hasError:!I.loading,errorMessage:o.Ru.get("track-page.error")}):null})),T=p},76600:(a,e,t)=>{t.d(e,{J:()=>c});var r=t(5820),n=t(33031);const i=new r.l("getTrack","query","26cd58ab86ebba80196c41c3d48a4324c619e9a9d7df26ecca22417e0c50c6a4",null),c=(a,e)=>(0,n.I)(i,a,e)}}]);
//# sourceMappingURL=xpui-routes-track.js.map