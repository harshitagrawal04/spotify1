"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{92344:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Ct});var n=a(30758);const i="music",o="2.0.0",r="default",s="12.2.0";function c(t){return new l(t)}class l{constructor(t){this._path=[{name:"desktop-friend-activity"}],t?.parentAbsoluteLocation&&(this._parentAbsoluteLocation=t.parentAbsoluteLocation)}addFriendButtonFactory(){return new l.AddFriendButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}closeButtonFactory(){return new l.CloseButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowFactory(){return new l.FriendRowEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}impression(){return{app:i,generatorVersion:s,specificationVersion:o,specificationMode:r,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}!function(t){t.AddFriendButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"add_friend_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiReveal(){return{actionName:"ui_reveal",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.CloseButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"close_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiHide(){return{actionName:"ui_hide",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(l||(l={})),function(t){t.FriendRowEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"friend_row"}),e&&(this._parentAbsoluteLocation=e)}playButtonFactory(){return new t.FriendRowEventFactory.PlayButtonEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation})}friendRowLinkFactory(e){return new t.FriendRowEventFactory.FriendRowLinkEventFactory({path:this._path,parentAbsoluteLocation:this._parentAbsoluteLocation,data:e})}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}}}(l||(l={})),function(t){!function(t){t.PlayButtonEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({name:"play_button"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitPlay({itemToBePlayed:t}){return{actionParameterNames:["item_to_be_played"],actionParameterValues:[t.toString()],actionName:"play",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitPause({itemToBePaused:t}){return{actionParameterNames:["item_to_be_paused"],actionParameterValues:[t.toString()],actionName:"pause",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}hitResume({itemToBeResumed:t}){return{actionParameterNames:["item_to_be_resumed"],actionParameterValues:[t.toString()],actionName:"resume",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={})),function(t){!function(t){t.FriendRowLinkEventFactory=class{constructor({path:t,parentAbsoluteLocation:e,data:a}){this._path=t.concat({...a,name:"friend_row_link"}),e&&(this._parentAbsoluteLocation=e)}_getCurrentLocation(){return{pathNodes:this._path,specMode:[r,...[...Array(this._path.length-1)].map((()=>""))],specVersion:[o,...[...Array(this._path.length-1)].map((()=>""))]}}getAbsoluteLocation(){const t=this._parentAbsoluteLocation?.locations;return{locations:[...t||[],this._getCurrentLocation()]}}hitUiNavigate({destination:t}){return{actionParameterNames:["destination"],actionParameterValues:[t.toString()],actionName:"ui_navigate",actionVersion:1,app:i,generatorVersion:s,interactionType:"hit",specificationMode:r,specificationVersion:o,annotatorConfigurationVersion:"",annotatorVersion:"",location:this._getCurrentLocation(),parentAbsoluteLocation:this._parentAbsoluteLocation}}}}(t.FriendRowEventFactory||(t.FriendRowEventFactory={}))}(l||(l={}));var u=a(79252),d=a(60749),h=a(44004),p=a(88019),m=a(97500),g=a.n(m),_=a(82032);const b="jGcEaPyhr1c_janM2uRF",L="OemaZktMXaRcYQ5bcfLZ",y="o5IJsOJEWBEyxtPVVVqQ",f="toPt7VOT_PiDx5Gj3SM2",x="xU4sacBisQneHoQeHMP5",A="srjSlmxMGzXnJBc32BJa",j="lju7xv10a5Y5Z8h8CcKJ",N="jr794VV4i2iUBRhfvS5i",v="KE3gK5ccLz2gL3dhJ4BW",V="pO2rsGFqUdaNhpLrif21",C="Ydxgl4Y23orfVVVI9O2k",w="VhqWrkzIrJrvdyj7ZXMd",F="T3liC_3fbMOTilR4HHKD",P="W_tr6AMQB9Chbc9bCS9w",R="yDdNxgieZmqjgHQCW3UE",S="aikUDGtqRnCX0ZwYHDUW",B="T_HXMW6n5qsbLbPTr1GS",E="tYswKV9PmtTCv62LOPIV",I="GlDNRQ2w0t4h9WBI4GgN",T="BQGSV5BvuAaJ5rmFAXLp",k="ZLbFjRdp1AMXebZH6UWM",M="jhtyHt6d9vbxK6VtCI7a",U="oCaGCB13zdReRutfBS8_",Q="MR1n58Qu0kPorQtveOCQ",G="y10vXronmQ6eYMlJrIp3";var D=a(86070);const O=({showOnlineIndicator:t})=>(0,D.jsxs)("div",{className:E,children:[(0,D.jsxs)("div",{className:I,children:[(0,D.jsx)(_.v,{size:"medium"}),t?(0,D.jsx)("div",{className:T}):null]}),(0,D.jsxs)("div",{className:k,children:[(0,D.jsx)("div",{className:g()(M,U)}),(0,D.jsx)("div",{className:M}),(0,D.jsx)("div",{className:M})]})]}),H=()=>(0,D.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:S,children:[(0,D.jsx)(h.E,{as:"p",className:B,children:u.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,D.jsx)(O,{showOnlineIndicator:!0}),(0,D.jsx)(O,{showOnlineIndicator:!0}),(0,D.jsx)(O,{}),(0,D.jsx)(h.E,{as:"p",className:B,children:u.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,D.jsx)(d.N_,{to:"/preferences",className:Q,children:(0,D.jsx)(p.$,{colorSet:"invertedLight",className:G,children:u.Ru.get("desktop.settings.settings")})})]});var Z=a(68832),W=a(45005),Y=a(43453),J=a(47290),z=a(29083),K=a(76434),X=a(39721),q=a(25710),$=a(60790),tt=a(82221),et=a(58206),at=a(35748),nt=a(98459),it=a(86871),ot=a(49321);const rt=t=>{const{timestamp:e,isNowPlaying:a}=t;return a?(0,D.jsx)(it.Zp,{label:u.Ru.get("time.now"),children:(0,D.jsx)(nt.A,{"aria-label":u.Ru.get("time.now"),size:"small"})}):(0,D.jsx)("span",{children:(0,ot.Z)(e)})};var st=a(17998),ct=a(24024),lt=a(72308),ut=a(24848),dt=a(15845),ht=a(1263);const pt=t=>Date.now()-t<9e5,mt=(t,e)=>{const a=(0,W.o_h)(t)?.type;switch(a){case W.NQG.PLAYLIST:case W.NQG.PLAYLIST_V2:return(0,D.jsx)(X.W,{uri:t});case W.NQG.EPISODE:case W.NQG.SHOW:return(0,D.jsx)(q.H,{uri:t});case W.NQG.ALBUM:return(0,D.jsx)(z.h,{uri:t,artistUri:e});case W.NQG.ARTIST:return(0,D.jsx)(K.t,{uri:t});default:return null}},gt=t=>{switch(t){case W.NQG.ALBUM:return ht.c.ALBUM;case W.NQG.ARTIST:return ht.c.ARTIST;case W.NQG.SHOW:return ht.c.SHOW;case W.NQG.EPISODE:return ht.c.EPISODE;case W.NQG.PLAYLIST:case W.NQG.PLAYLIST_V2:return ht.c.PLAYLIST;default:return}},_t=t=>{const{show:e=!0,spec:a,friend:i}=t,o=(0,n.useMemo)((()=>i.user.imageUrl?[{url:i.user.imageUrl,width:0,height:0}]:[]),[i.user.imageUrl]),r=(0,dt.s)(),s=i.track,c=s.uri,{togglePlay:l,isPlaying:d,isActive:p}=(0,ut.P)({uri:c},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),m=(0,W.o_h)(s.context.uri),_=m?.type,L=(0,n.useCallback)((()=>{l();const t=a.friendRowFactory().playButtonFactory();p?d?r.logInteraction(t.hitPause({itemToBePaused:c})):r.logInteraction(t.hitResume({itemToBeResumed:c})):r.logInteraction(t.hitPlay({itemToBePlayed:c}))}),[d,c,a,p,l,r]),y=(0,n.useCallback)(((t,e)=>{r.logInteraction(a.friendRowFactory().friendRowLinkFactory({identifier:t}).hitUiNavigate({destination:e}))}),[r,a]),{draggable:f,onDragStart:S}=(0,st.P)({itemUris:[c],dragLabelText:s.name}),{draggable:B,onDragStart:E}=(0,st.P)({itemUris:[s.artist.uri],dragLabelText:s.artist.name}),{draggable:I,onDragStart:T}=(0,st.P)({itemUris:[s.context.uri],dragLabelText:s.context.name});return e?(0,D.jsxs)("div",{className:g()(b),children:[(0,D.jsx)(J.h,{menu:mt(s.context.uri,s.artist.uri),children:(0,D.jsxs)("div",{className:x,children:[(0,D.jsx)(Y.e,{label:i.user.name,width:40,userIconSize:"small",images:o,withBadge:pt(i.timestamp)}),(0,D.jsx)(at.x,{className:A,iconClassName:j,isPlaying:d,isLocked:!1,onClick:L,playAriaLabel:d?u.Ru.get("pause"):`${u.Ru.get("play")} ${s.artist.name} ${s.name}`})]})}),(0,D.jsxs)("div",{className:g()(N),children:[(0,D.jsxs)("div",{className:v,children:[(0,D.jsx)(h.E,{as:"p",variant:"bodySmallBold",className:g()(V,"ellipsis-one-line"),children:(0,D.jsx)(lt.pZ,{value:"/buddyfeed_user_profile",children:(0,D.jsx)(J.h,{menu:(0,D.jsx)(tt.B,{uri:i.user.uri}),children:(0,D.jsx)(et.N,{title:i.user.name,to:i.user.uri,dir:"auto",onClick:()=>y("profile_link",i.user.uri),children:i.user.name})})})}),(0,D.jsx)(h.E,{as:"p",variant:"marginal",className:g()(C),children:(0,D.jsx)(rt,{timestamp:i.timestamp,isNowPlaying:pt(i.timestamp)})})]}),(0,D.jsxs)(h.E,{as:"p",variant:"marginal",className:w,children:[(0,D.jsx)(lt.pZ,{value:"/buddyfeed_track",children:(0,D.jsx)(J.h,{menu:(0,D.jsx)($.P,{uri:s.uri,contextUri:s.context.uri,albumUri:s.album.uri,artists:[s.artist]}),children:(0,D.jsx)(et.N,{title:s.name,to:c,className:"ellipsis-one-line",dir:"auto",draggable:f,onDragStart:S,onClick:()=>y("track_link",c),children:s.name})})}),(0,D.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,D.jsx)(lt.pZ,{value:"/buddyfeed_artist",children:(0,D.jsx)(J.h,{menu:s.artist?(0,D.jsx)(K.t,{uri:s.artist.uri}):null,children:(0,D.jsx)(et.N,{title:s.artist.name,to:s.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:B,onDragStart:E,onClick:()=>y("artist_link",s.artist.uri),children:s.artist.name})})})]}),(0,D.jsx)(h.E,{as:"p",variant:"marginal",className:g()("ellipsis-one-line",P),children:(0,D.jsx)(lt.pZ,{value:"/buddyfeed_context",children:(0,D.jsx)(J.h,{menu:mt(s.context.uri,s.artist.uri),children:(0,D.jsxs)(et.N,{title:s.context.name,to:s.context.uri,className:R,draggable:I,onDragStart:T,onClick:()=>y("context_link",s.context.uri),children:[(0,D.jsx)(ct.s,{type:gt(_),iconSize:16,className:F}),(0,D.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:s.context.name})]})})})})]})]},i.user.uri):null};var bt=a(62275),Lt=a(99920),yt=a(66225);function ft({friends:t,spec:e}){const{currentSession:a}=(0,yt.D)(),i=(0,Lt.y)(),[o,r]=(0,n.useState)(!0),s=!a?.active&&i&&o&&(0,D.jsx)("li",{className:y,children:(0,D.jsx)(bt.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>r(!1)})},"start-jam-button");return(0,D.jsx)(Z.ZI,{flipKey:t.map((t=>t.user.uri)).join(""),children:(0,D.jsxs)("ul",{className:L,children:[s,t.map(((t,a)=>(0,D.jsx)(Z.lf,{flipId:t.user.uri,children:(0,D.jsx)("li",{children:(0,D.jsx)(_t,{friend:t,show:a<100,spec:e},t.user.uri)})},t.user.uri)))]})})}var xt=a(5252),At=a(1895),jt=a(94875),Nt=a(39736),vt=a(743),Vt=a(3161);const Ct=({friends:t})=>{const e=(0,dt.s)(),{spec:a}=(0,Vt.r)(c,{}),i=(0,n.useRef)(null);(0,n.useEffect)((()=>{e.logImpression(a.impression())}),[e,a]);const o=0===t.length,r=(0,n.useCallback)((()=>{e.logInteraction(a.closeButtonFactory().hitUiHide())}),[e,a]);return(0,D.jsx)(vt.ql.Provider,{value:"buddy_feed",children:(0,D.jsx)(xt._,{label:u.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,D.jsx)("div",{className:f,ref:i,children:(0,D.jsx)(At.w,{fixedHeader:(0,D.jsx)(jt.a,{title:u.Ru.get("buddy-feed.friend-activity"),panel:Nt.Z.BuddyFeed,onClose:r}),children:o?(0,D.jsx)(H,{}):(0,D.jsx)(ft,{friends:t,spec:a})})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map